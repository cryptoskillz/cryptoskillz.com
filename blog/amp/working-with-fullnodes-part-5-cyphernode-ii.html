<!doctype html><html amp lang="en"><head><meta charset="utf-8"><title>Working With Fullnodes Part 5 Cyphernode II - cryptoskillz</title><meta name="description" content="ECS (e-commerce software) is an open source Bitcoin e-commerce server. It comes with a Javascript e-commerce injector a REST server and an admin control panel. "><link rel="canonical" href="https://cryptoskillz.com/blog/working-with-fullnodes-part-5-cyphernode-ii.html"><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"><link href="https://fonts.googleapis.com/css?family=Roboto:400,700" rel="stylesheet" type="text/css"><script async custom-element="amp-sidebar" src="https://cdn.ampproject.org/v0/amp-sidebar-0.1.js"></script><script async custom-element="amp-social-share" src="https://cdn.ampproject.org/v0/amp-social-share-0.1.js"></script><script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script><script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script><script async custom-element="amp-video" src="https://cdn.ampproject.org/v0/amp-video-0.1.js"></script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://cryptoskillz.com/blog/amp/working-with-fullnodes-part-5-cyphernode-ii.html"},"headline":"Working With Fullnodes Part 5 Cyphernode II","datePublished":"2019-08-19T12:32","dateModified":"2019-09-20T12:33","image":{"@type":"ImageObject","url":"https://cryptoskillz.com/blog/media/website/logo.png","height":178,"width":685},"description":"<figure class=\"post__image post__image\" ><amp-img src=\"https://cryptoskillz.com/blog/media/posts/21/1_h6R4v-LSbRG83IGCUZDN0Q.jpeg\" sizes=\"(max-width: 48em) 100vw, 768px\" srcset=\"https://cryptoskillz.com/blog/media/posts/21/responsive/1_h6R4v-LSbRG83IGCUZDN0Q-xs.jpeg 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_h6R4v-LSbRG83IGCUZDN0Q-sm.jpeg 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_h6R4v-LSbRG83IGCUZDN0Q-md.jpeg 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_h6R4v-LSbRG83IGCUZDN0Q-lg.jpeg 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_h6R4v-LSbRG83IGCUZDN0Q-xl.jpeg 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_h6R4v-LSbRG83IGCUZDN0Q-2xl.jpeg 1600w\"  alt=\"\" width=\"3456\" height=\"3456\" layout=\"responsive\"></amp-img>\n<figcaption >\n<figure class=\"ke kf kg kh ki fr x y paragraph-image\">\n<figcaption class=\"az dz kx ky hh dn x y kz la au dx\" data-selectable-paragraph=\"\">Photo by <a href=\"https://unsplash.com/@trueagency?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText\" class=\"cb bx lb lc ld le\" target=\"_blank\" rel=\"noopener noreferrer\">True Agency</a> on <a href=\"https://unsplash.com/search/photos/backend?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText\" class=\"cb bx lb lc ld le\" target=\"_blank\" rel=\"noopener noreferrer\">Unsplash</a></figcaption>\n</figure>\n</figcaption>\n</figure>\n","author":{"@type":"Person","name":"cryptoskillz"},"publisher":{"@type":"Organization","name":"cryptoskillz","logo":{"@type":"ImageObject","url":"https://cryptoskillz.com/blog/media/website/logo.png","height":178,"width":685}}}</script><style amp-custom>article,
aside,
footer,
header,
hgroup,
main,
nav,
section {
  display: block; }

*,
*:before,
*:after {
  -webkit-box-sizing: content-box;
  box-sizing: content-box;
  margin: 0;
  padding: 0; }

li {
  list-style: none; }

amp-img {
  max-width: 100%; }

button,
input,
select,
textarea {
  font: inherit; }

html {
  font-size: 1rem; }

body {
  background: #f1f1f1;
  color: #262626;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
  line-height: 1.6; }

a {
  color:  #039be5;
  text-decoration: none;
  -webkit-transition: all 0.12s linear 0s;
  -o-transition: all 0.12s linear 0s;
  transition: all 0.12s linear 0s; }

a:hover {
  color: #262626;
  text-decoration: underline;
  -webkit-text-decoration-skip: ink;
  text-decoration-skip: ink; }

a:active {
  color: #262626; }

a:focus {
  outline: 2px dotted #039be5; }

figure,
blockquote,
p,
ul,
ol,
dl,
table,
hr,
fieldset {
  margin-top: 1.6rem; }

h1,
h2,
h3,
h4,
h5,
h6 {
  color: #262626;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
  font-weight: 500;
  line-height: 1.2;
  margin-top: 2.13333rem; }

h1 {
  font-size: 1.67583rem;
  font-weight: normal; }

h2 {
  font-size: 1.4729rem; }

h3 {
  font-size: 1.29454rem; }

h4 {
  font-size: 1.13778rem; }

h5 {
  font-size: 1rem; }

h6 {
  font-size: 0.87891rem; }

h2 + p,
h3 + p,
h4 + p,
h5 + p,
h6 + p {
  margin-top: 0.8rem; }

b,
strong {
  font-weight: 600; }

blockquote {
  color: #6c7175;
  font-family: "Droid Serif", "Times", "Source Serif Pro", serif;
  font-style: italic;
  padding: 1.33333rem 0.53333rem 1.33333rem 3.2rem;
  position: relative; }
  blockquote:before {
    display: block;
    content: "\201C";
    font-size: 4.41226rem;
    position: absolute;
    left: 0;
    top: -12px;
    color: rgba(108, 113, 117, 0.5); }
  blockquote > :nth-child(1) {
    margin-top: 0; }

ul,
ol {
  margin-left: 2rem; }
  ul > li,
  ol > li {
    list-style: inherit;
    padding: 0 0 0.26667rem 0.26667rem; }

dl dt {
  color: #262626;
  font-weight: 600; }

code,
pre {
  background-color: #f1f1f1;
  font-family: monospace; }

pre {
  margin: 1.6rem 0 0;
  padding: 1.6rem;
  white-space: pre-wrap;
  word-wrap: break-word;
  overflow-x: auto; }
  pre > code {
    color: #262626;
    padding: 0; }

code {
  border-radius: 3px;
  color: #262626;
  padding: 0.26667rem 0.53333rem; }

table {
  border-collapse: collapse;
  border-spacing: 0;
  border: 1px solid #d4d4d4;
  width: 100%;
  overflow-x: auto;
  vertical-align: top;
  text-align: left;
  white-space: nowrap; }
  table th {
    font-weight: 500;
    padding: 0.53333rem 1.06667rem; }
  table tr {
    border-bottom: 1px solid #d4d4d4; }
    table tr:nth-child(2n) {
      background: #f1f1f1; }
  table td {
    padding: 0.53333rem 1.06667rem; }

figcaption {
  clear: both;
  color: rgba(108, 113, 117, 0.6);
  font-size: 0.82397rem;
  margin: 0.8rem 0 0;
  text-align: center; }

sub,
sup {
  font-size: 65%; }

hr {
  border: 0;
  height: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(255, 255, 255, 0.3); }

.btn, [type=button],
[type=submit],
button {
  background: #039be5;
  border: none;
  border-radius: 2px;
  color: #ffffff;
  cursor: pointer;
  display: inline-block;
  font-size: 0.87891rem;
  font-weight: 500;
  line-height: 1.9;
  padding: 0.53333rem 1.33333rem;
  text-align: center;
  text-decoration: none;
  -webkit-transition: all .15s ease;
  -o-transition: all .15s ease;
  transition: all .15s ease;
  width: auto; }
  .btn:hover, [type=button]:hover,
  [type=submit]:hover,
  button:hover {
    background: #262626;
    color: #ffffff; }
  .btn:focus, [type=button]:focus,
  [type=submit]:focus,
  button:focus {
    outline: none; }
  .btn-outline {
    border: 1px solid #ddd;
    background: #ffffff;
    border-radius: 3px;
    color: #262626; }

[type=button],
[type=submit],
button {
  text-transform: uppercase;
  -webkit-appearance: none;
  -moz-appearance: none; }

.navbar {
  background: #039be5;
  -webkit-box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.2);
  box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.2);
  line-height: 3;
  max-height: 4rem; }
  .navbar > div {
    -webkit-box-align: center;
    -ms-flex-align: center;
    align-items: center;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-pack: center;
    -ms-flex-pack: center;
    justify-content: center;
    text-align: left;
    max-width: 700px;
    margin: 0 auto; }
  .navbar a {
    color: #ffffff;
    text-decoration: none; }
  .navbar-sidebar-toggle {
    left: 0;
    position: relative;
    text-indent: -99999rem; }
    .navbar-sidebar-toggle:before {
      content: "";
      display: block;
      border-top: 0.375rem double #ffffff;
      border-bottom: 0.125rem solid #ffffff;
      height: 0.125rem;
      position: absolute;
      text-indent: 0;
      top: 50%;
      width: 1.3rem;
      -webkit-transform: translate(0px, -50%);
      -ms-transform: translate(0px, -50%);
      transform: translate(0px, -50%); }


.logo {
                    background-image: url('https://cryptoskillz.com/blog/media/website/logo.png');
                    background-size: auto 2rem;
                    background-repeat: no-repeat;
                    background-position: center center;
            display: inline-block;
  font-weight: 600;
  line-height: 1;
            margin: 0 auto;
            height: 2rem;
            text-indent: -9999px;
            width: 240px;vertical-align: middle;
        }
        .logo.logo-text {
            line-height: 2;
            text-align: center;
            text-indent: 0;
        }

amp-sidebar {
  background: #ffffff;
  width: 240px; }
  amp-sidebar > ul {
    margin: 0.8rem 0 0;
    padding: 0; }
    amp-sidebar > ul ul {
      border-left: 1px solid #d4d4d4;
      margin: 0.53333rem 0 0; }
    amp-sidebar > ul li {
      color: #262626;
      font-size: 0.9375rem;
      font-weight: 600;
      list-style: none;
      line-height: 1.4;
      padding: 0.42667rem 1.06667rem; }
      amp-sidebar > ul li li {
        font-weight: normal;
        padding: 0.26667rem 0 0.26667rem 1.06667rem; }
    amp-sidebar > ul a,
    amp-sidebar > ul a:visited {
      color: #262626; }

.bg-white {
  background: #ffffff; }

.wrap-page {
  max-width: 700px;
  margin: 0 auto; }

@media all and (max-width: 43.6875em) {
  .wrap-inner {
    padding: 0 6%; } }

.page-title {
  background: #ffffff;
  -webkit-box-shadow: 0 2px 3px rgba(38, 38, 38, 0.1);
  box-shadow: 0 2px 3px rgba(38, 38, 38, 0.1);
  margin-bottom: 0.8rem;
  padding: 1.6rem 6%; }
  .page-title > h1 {
    margin: 0;
    font-size: 1.29454rem; }
  .page-title > p {
    font-size: 0.87891rem;
    color: #6c7175;
    line-height: 1.3;
    margin: 0.26667rem 0 0; }
  .page-title-author {
    border-radius: 50%;
    float: left;
    height: 2.5rem;
    width: 2.5rem; }
    .page-title-author + h1 {
      margin-left: 3.5rem; }
      .page-title-author + h1 + p {
        margin-left: 3.5rem; }

.card {
  background: #ffffff;
  -webkit-box-shadow: 0 2px 3px rgba(38, 38, 38, 0.1);
  box-shadow: 0 2px 3px rgba(38, 38, 38, 0.1);
  margin-bottom: 0.8rem;
  padding-bottom: 1.06667rem; }

  .card-meta {
    border-top: 1px solid #d4d4d4;
    color: rgba(108, 113, 117, 0.6);
    font-size: 0.7242rem;
    font-weight: 500;
    margin-top: 1.06667rem;
    padding-top: 1.06667rem;
    text-transform: uppercase; }
    .card-meta a + time:before {
      content: "";
      background: #d4d4d4;
      display: inline-block;
      height: 3px;
      margin: 0 8px;
      width: 3px;
      vertical-align: middle;
      border-radius: 50%; }
  .card-text {
    font-size: 0.9375rem;
    overflow: hidden;
    padding: 0 6%; }
    .card-text h2 {
      font-size: 1.13778rem; }

.post {
  margin-bottom: 2.13333rem; }
  .post-featured-image {
    margin-top: 0;
    position: relative; }
    .post-featured-image > figcaption {
      background: rgba(0, 0, 0, 0.5);
      border-radius: 3px;
      color: #ffffff;
      position: absolute;
      bottom: 0.8rem;
      padding: 0 0.26667rem;
      right: 6%; }
  .post-header {
    margin-bottom: 2.13333rem; }
  .post-meta {
    border-bottom: 1px solid #d4d4d4;
    color: rgba(108, 113, 117, 0.6);
    font-size: 0.7242rem;
    font-weight: 500;
    margin-top: 1.06667rem;
    padding-bottom: 1.06667rem;
    text-transform: uppercase; }
    .post-meta a + time:before {
      content: "";
      background: #d4d4d4;
      display: inline-block;
      height: 3px;
      margin: 0 8px;
      width: 3px;
      vertical-align: middle;
      border-radius: 50%; }
  .post-tag {
    margin: 0; }
    .post-tag > li {
      display: inline-block;
      padding: 0; }
      .post-tag > li a {
        background: #f1f1f1;
        border-radius: 2px;
        color: #6c7175;
        font-size: 0.77248rem;
        display: inline-block;
        margin: 0 0.26667rem 0.26667rem 0;
        padding: 0.26667rem 0.53333rem; }
        .post-tag > li a:hover {
          background: #039be5;
          color: #ffffff;
          text-decoration: none; }
  .post-share {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: normal;
    -ms-flex-direction: row;
    flex-direction: row;
    -webkit-box-pack: justify;
    -ms-flex-pack: justify;
    justify-content: space-between;
    margin-top: 1.6rem;
    width: 100%; }
    .post-share amp-social-share {
      -webkit-box-flex: 1;
      -ms-flex: 1 0 auto;
      flex: 1 0 auto;
      background-size: 24px; }
  .post-scroll {
    color: #ffffff;
    background: #039be5;
    bottom: 10px;
    border-radius: 50%;
    border: none;
    -webkit-box-shadow: 0 1px 1.5px 0 rgba(38, 38, 38, 0.12), 0 1px 1px 0 rgba(38, 38, 38, 0.24);
    box-shadow: 0 1px 1.5px 0 rgba(38, 38, 38, 0.12), 0 1px 1px 0 rgba(38, 38, 38, 0.24);
    font-size: 1.13778rem;
    height: 46px;
    opacity: 0;
    outline: none;
    position: fixed;
    padding: 0;
    right: 4%;
    visibility: hidden;
    width: 46px;
    z-index: 9999; }
    .post-scroll-marker {
      height: 0px;
      position: absolute;
      top: 100px;
      width: 0px; }
        .post-pagination {
    background: #f1f1f1;
    -webkit-box-shadow: inset 0 2px 3px rgba(38, 38, 38, 0.1);
    box-shadow: inset 0 2px 3px rgba(38, 38, 38, 0.1);
    border-top: 1px solid #d4d4d4;
    padding: 1.06667rem 0; }
    .post-pagination > div {
      line-height: 1.2;
      padding: 0.53333rem 1.06667rem;
      text-align: center; }
      .post-pagination > div span {
        display: block;
        color: #6c7175;
        font-size: 0.7242rem;
        font-weight: 500;
        margin-bottom: 0.26667rem;
        text-transform: uppercase; }
    .post-pagination-prev a:before {
      content: "\2190";
      margin-right: 0.26667rem; }
    .post-pagination-next a:after {
      content: "\2192";
      margin-left: 0.26667rem; }

aside {
  margin: 1.6rem 0 0; }

.align-left {
  text-align: left; }

.align-right {
  text-align: right; }

.align-center {
  text-align: center; }

.align-justify {
  text-align: justify; }

.msg {
  border-left: 2px solid transparent;
  padding: 1.06667rem 1.06667rem; }
  .msg--highlight {
    background-color: #fff8e6;
    border-color: #e2ac4f; }
  .msg--info {
    background: rgba(45, 97, 201, 0.03);
    border-color: #039be5; }
  .msg--success {
    background: #f7fbf6;
    border-color: #5ab44b; }
  .msg--warning {
    background: #fff3f3;
    border-color: #c06367;
    color: #a94442; }

.dropcap:first-letter {
  float: left;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
  font-size: 2.16943rem;
  line-height: 0.7;
  margin-right: 0.53333rem;
  padding: 0.53333rem 0.53333rem 0.53333rem 0; }

.pagination {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: justify;
  -ms-flex-pack: justify;
  justify-content: space-between;
  margin: 0.8rem 0; }
  .pagination > a {
    padding-left: 0;
    padding-right: 0;
    width: 49%; }
  .pagination-right {
    margin-left: auto; }

.bottom {
  background: #039be5;
  color: #ffffff;
  padding: 1.06667rem 4%;
  text-align: center; }</style><style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript><script async src="https://cdn.ampproject.org/v0.js"></script><script custom-element="amp-animation" src="https://cdn.ampproject.org/v0/amp-animation-0.1.js" async></script><script custom-element="amp-position-observer" src="https://cdn.ampproject.org/v0/amp-position-observer-0.1.js" async></script></head><body class="bg-white"><nav class="navbar wrap-inner" id="top"><div><a on="tap:navbar-sidebar.toggle" class="navbar-sidebar-toggle" title="Menu">Menu</a> <a class="logo" href="https://cryptoskillz.com/blog/amp/">cryptoskillz</a></div></nav><main class="wrap-page"><article class="post"><div class="wrap-inner"><header class="post-header"><h1>Working With Fullnodes Part 5 Cyphernode II</h1><p class="post-meta"><time datetime="2019-08-19T12:32">August 19, 2019</time></p></header><figure class="post__image post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_h6R4v-LSbRG83IGCUZDN0Q.jpeg" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_h6R4v-LSbRG83IGCUZDN0Q-xs.jpeg 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_h6R4v-LSbRG83IGCUZDN0Q-sm.jpeg 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_h6R4v-LSbRG83IGCUZDN0Q-md.jpeg 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_h6R4v-LSbRG83IGCUZDN0Q-lg.jpeg 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_h6R4v-LSbRG83IGCUZDN0Q-xl.jpeg 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_h6R4v-LSbRG83IGCUZDN0Q-2xl.jpeg 1600w" alt="" width="3456" height="3456" layout="responsive"></amp-img><figcaption><figure class="ke kf kg kh ki fr x y paragraph-image"><figcaption class="az dz kx ky hh dn x y kz la au dx" data-selectable-paragraph="">Photo by <a href="https://unsplash.com/@trueagency?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer">True Agency</a> on <a href="https://unsplash.com/search/photos/backend?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer">Unsplash</a></figcaption></figure></figcaption></figure><h1 id="e317" class="lf lg bf av au el lh li lj lk ll lm ln lo lp lq lr" data-selectable-paragraph="">Introduction</h1><p id="f921" class="ls lt bf av lu b lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">This guide aims to program a website to accept Bitcoin. In the previous tutorial, we set up and configured "<a href="https://cyphernode.io/" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">cyphernode</strong></a><strong class="lu mg">" </strong>which is an excellent dockerised bitcoin and lightning full node plus other useful. Now we are going to set it up to use specifically for our requirements. Namely as a commerce backend for websites.</p><h1 id="ac4d" class="lf lg bf av au el lh li lj lk ll lm ln lo lp lq lr" data-selectable-paragraph="">Configuring cyphernode</h1><p id="b852" class="ls lt bf av lu b lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">We are going to make a number of changes to the tutorial in the previous "<a class="cb bx lb lc ld le" target="_blank" href="https://medium.com/bitcoin-e-commerce-development/part-18-cyphernode-ab682ff85659" rel="noopener noreferrer"><strong class="lu mg">article</strong></a>" which was simply showing how to get "<a href="https://cyphernode.io/" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">cyphernode</strong></a>" working in its default set up.</p><h2 id="51b2" class="mh lg bf av au el mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">Remove Lightning</h2><p id="fa43" class="ls lt bf av lu b lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">As we do not natively support it yet</p><h2 id="06f6" class="mh lg bf av au el mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">Prune the blockchain</h2><p id="af6f" class="ls lt bf av lu b lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">As we are using it to do as a commerce server and every sale will we do is moved to our cold storage via a hardware wallet (such as "<a href="https://www.ledgerwallet.com/products/12-ledger-nano-s" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">Ledger</strong></a>") or a full node (such as "<a href="https://store.casa/lightning-node/" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">casa</strong></a>") which has been built to be a store of value.</p><h2 id="9991" class="mh lg bf av au el mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">Building cyphernode</h2><p id="cf78" class="ls lt bf av lu b lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">Note, a number of these steps are a repetition of the previous "<a class="cb bx lb lc ld le" target="_blank" href="https://medium.com/bitcoin-e-commerce-development/part-18-cyphernode-ab682ff85659" rel="noopener noreferrer"><strong class="lu mg">article</strong></a>" but it is worth repeating as they change (although subtly) in a significant manner.</p><p id="7799" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Open a terminal client (we use Macs) if you use Windows use "<a href="https://www.putty.org/" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">putty</strong></a><strong class="lu mg">"</strong> or whatever terminal client you are comfortable with.</p><p id="3af2" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph=""><strong class="lu mg">Step 1: Create a directory</strong></p><pre class="ke kf kg kh ki dv ge df"><span id="e0f8" class="mh lg bf av my b dz mz na l nb" data-selectable-paragraph="">mkdir cyphernode &amp;&amp; cd cyphernode</span></pre><p id="e81f" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph=""><strong class="lu mg">Step 2: Run quick install of cyphernode</strong></p><pre class="ke kf kg kh ki dv ge df"><span id="4a7a" class="mh lg bf av my b dz mz na l nb" data-selectable-paragraph="">curl -fsSL <a href="https://raw.githubusercontent.com/SatoshiPortal/cyphernode/master/dist/setup.sh" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer">https://raw.githubusercontent.com/SatoshiPortal/cyphernode/master/dist/setup.sh</a> -o setup_cyphernode.sh &amp;&amp; chmod +x setup_cyphernode.sh &amp;&amp; ./setup_cyphernode.sh</span></pre><p id="cd78" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph=""><strong class="lu mg">Step 3: run through cyphernode set up</strong></p><p id="e0fc" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">The first thing you will see a progress window (as shown in the screenshot below) that is basically the cyphernode set up downloading everything it requires to complete the installation.</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1-2xl.png 1600w" alt="" width="1728" height="281" layout="responsive"></amp-img></figure><p id="a70b" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Next, you will see is a prompt asking you for a password add one, obviously. Remember this password as it comes in handy (a lot) later.</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_32xpgCDTEfRlPZc7kHvYeA.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_32xpgCDTEfRlPZc7kHvYeA-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_32xpgCDTEfRlPZc7kHvYeA-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_32xpgCDTEfRlPZc7kHvYeA-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_32xpgCDTEfRlPZc7kHvYeA-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_32xpgCDTEfRlPZc7kHvYeA-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_32xpgCDTEfRlPZc7kHvYeA-2xl.png 1600w" alt="" width="1405" height="126" layout="responsive"></amp-img></figure><p id="a3fe" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">After that you are presented with is the one below, press return as help is always good, right?</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/0_tvAQgJ-qh3uRdMgY.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/0_tvAQgJ-qh3uRdMgY-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/0_tvAQgJ-qh3uRdMgY-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/0_tvAQgJ-qh3uRdMgY-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/0_tvAQgJ-qh3uRdMgY-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/0_tvAQgJ-qh3uRdMgY-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/0_tvAQgJ-qh3uRdMgY-2xl.png 1600w" alt="" width="1400" height="663" layout="responsive"></amp-img></figure><p id="4a5a" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Next, it will prompt you to install extra software. We do not require either "<a href="https://en.wikipedia.org/wiki/Lightning_Network" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">Lightning</strong></a>" or "<a href="https://github.com/opentimestamps/opentimestamps-client" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">Opentimestamps client</strong></a>" yet so just press return to move onto the next stage.</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_wyFEHuAJgg3B8PY51rs1vQ.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_wyFEHuAJgg3B8PY51rs1vQ-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_wyFEHuAJgg3B8PY51rs1vQ-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_wyFEHuAJgg3B8PY51rs1vQ-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_wyFEHuAJgg3B8PY51rs1vQ-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_wyFEHuAJgg3B8PY51rs1vQ-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_wyFEHuAJgg3B8PY51rs1vQ-2xl.png 1600w" alt="" width="1127" height="169" layout="responsive"></amp-img></figure><p id="7827" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Next, we want to select Testnet as we are testing.</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_P4DgFm_MaK9MeWGbXieYXg.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_P4DgFm_MaK9MeWGbXieYXg-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_P4DgFm_MaK9MeWGbXieYXg-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_P4DgFm_MaK9MeWGbXieYXg-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_P4DgFm_MaK9MeWGbXieYXg-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_P4DgFm_MaK9MeWGbXieYXg-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_P4DgFm_MaK9MeWGbXieYXg-2xl.png 1600w" alt="" width="1216" height="154" layout="responsive"></amp-img></figure><p id="0cdd" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Next, It asks to change user which is very good advice which we are going to ignore for the sake of simplicity. Go ahead and select N</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_FS-e2QKY5ybkqVNaOkfRUg.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_FS-e2QKY5ybkqVNaOkfRUg-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_FS-e2QKY5ybkqVNaOkfRUg-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_FS-e2QKY5ybkqVNaOkfRUg-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_FS-e2QKY5ybkqVNaOkfRUg-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_FS-e2QKY5ybkqVNaOkfRUg-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_FS-e2QKY5ybkqVNaOkfRUg-2xl.png 1600w" alt="" width="1169" height="260" layout="responsive"></amp-img></figure><p id="8fb2" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Next, select "N". To be frank, we are still not 100% sure what is "<a href="https://support.blockchain.com/hc/en-us/articles/360000939843-Understanding-the-xPub-and-address-generation" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">xPub</strong></a>" is and until we do and can make an informed decision about it we are going to ignore its existence.</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_sQSemJH9liax29ac84tvIw.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_sQSemJH9liax29ac84tvIw-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_sQSemJH9liax29ac84tvIw-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_sQSemJH9liax29ac84tvIw-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_sQSemJH9liax29ac84tvIw-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_sQSemJH9liax29ac84tvIw-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_sQSemJH9liax29ac84tvIw-2xl.png 1600w" alt="" width="1154" height="233" layout="responsive"></amp-img></figure><p id="5dcb" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Next, We have to give an encryption passphrase that gatekeeper will use for authentication. Go ahead and add one.</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_9RdYsmKXAcqjfFidUyGdqQ.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_9RdYsmKXAcqjfFidUyGdqQ-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_9RdYsmKXAcqjfFidUyGdqQ-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_9RdYsmKXAcqjfFidUyGdqQ-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_9RdYsmKXAcqjfFidUyGdqQ-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_9RdYsmKXAcqjfFidUyGdqQ-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_9RdYsmKXAcqjfFidUyGdqQ-2xl.png 1600w" alt="" width="1190" height="316" layout="responsive"></amp-img></figure><p id="dc2b" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Next, select a port. 2009 is fine so just press return</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_R6iF_aXtV8vH5T_2MNfHQA.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_R6iF_aXtV8vH5T_2MNfHQA-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_R6iF_aXtV8vH5T_2MNfHQA-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_R6iF_aXtV8vH5T_2MNfHQA-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_R6iF_aXtV8vH5T_2MNfHQA-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_R6iF_aXtV8vH5T_2MNfHQA-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_R6iF_aXtV8vH5T_2MNfHQA-2xl.png 1600w" alt="" width="1197" height="32" layout="responsive"></amp-img></figure><p id="9bc8" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Next, set up the IP’s we are going to run everything over 127.0.0.1 for now so just press return.</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_Z88sXbsLw5OeGif5SvF0eQ.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_Z88sXbsLw5OeGif5SvF0eQ-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_Z88sXbsLw5OeGif5SvF0eQ-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_Z88sXbsLw5OeGif5SvF0eQ-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_Z88sXbsLw5OeGif5SvF0eQ-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_Z88sXbsLw5OeGif5SvF0eQ-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_Z88sXbsLw5OeGif5SvF0eQ-2xl.png 1600w" alt="" width="1245" height="249" layout="responsive"></amp-img></figure><p id="1824" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Next, Again press return as we are happy to route all traffic through port 80</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_VFi9nsHJY2UahMiNCbe2tQ.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_VFi9nsHJY2UahMiNCbe2tQ-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_VFi9nsHJY2UahMiNCbe2tQ-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_VFi9nsHJY2UahMiNCbe2tQ-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_VFi9nsHJY2UahMiNCbe2tQ-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_VFi9nsHJY2UahMiNCbe2tQ-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_VFi9nsHJY2UahMiNCbe2tQ-2xl.png 1600w" alt="" width="1160" height="40" layout="responsive"></amp-img></figure><p id="af86" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Next, press return as we want to https to be on the default port.</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_zb4UXqnEZrridF6QWyanMA.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_zb4UXqnEZrridF6QWyanMA-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_zb4UXqnEZrridF6QWyanMA-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_zb4UXqnEZrridF6QWyanMA-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_zb4UXqnEZrridF6QWyanMA-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_zb4UXqnEZrridF6QWyanMA-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_zb4UXqnEZrridF6QWyanMA-2xl.png 1600w" alt="" width="1223" height="34" layout="responsive"></amp-img></figure><p id="4e6f" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Now, It is telling us it will look after the full node for us yay. Press return.</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_vz1oq2X8C9yUVM8j5gLGRQ.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_vz1oq2X8C9yUVM8j5gLGRQ-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_vz1oq2X8C9yUVM8j5gLGRQ-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_vz1oq2X8C9yUVM8j5gLGRQ-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_vz1oq2X8C9yUVM8j5gLGRQ-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_vz1oq2X8C9yUVM8j5gLGRQ-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_vz1oq2X8C9yUVM8j5gLGRQ-2xl.png 1600w" alt="" width="1248" height="304" layout="responsive"></amp-img></figure><p id="7fd6" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Next, we have to add an RPC username. "admin" is always good</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_BQwX_NXe6P-d_lCZtuJHEA.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_BQwX_NXe6P-d_lCZtuJHEA-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_BQwX_NXe6P-d_lCZtuJHEA-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_BQwX_NXe6P-d_lCZtuJHEA-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_BQwX_NXe6P-d_lCZtuJHEA-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_BQwX_NXe6P-d_lCZtuJHEA-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_BQwX_NXe6P-d_lCZtuJHEA-2xl.png 1600w" alt="" width="1149" height="145" layout="responsive"></amp-img></figure><p id="8bfb" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Next, we have to add an RPC password.</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/pass.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/pass-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/pass-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/pass-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/pass-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/pass-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/pass-2xl.png 1600w" alt="" width="1075" height="50" layout="responsive"></amp-img></figure><p id="ed16" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Next, type "Y’ as we want to run the full node in "<a href="https://coinguides.org/bitcoin-blockchain-pruning/" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">prune</strong></a>" mode</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_nnXroHU5WM0GWbRnG3wutg-1.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_nnXroHU5WM0GWbRnG3wutg-1-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_nnXroHU5WM0GWbRnG3wutg-1-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_nnXroHU5WM0GWbRnG3wutg-1-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_nnXroHU5WM0GWbRnG3wutg-1-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_nnXroHU5WM0GWbRnG3wutg-1-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_nnXroHU5WM0GWbRnG3wutg-1-2xl.png 1600w" alt="" width="1153" height="230" layout="responsive"></amp-img></figure><p id="d936" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Next, we want to select 550 megabytes this is the default option so just press return.</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_HrOFqakZgRc_PVVBfrvaAg.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_HrOFqakZgRc_PVVBfrvaAg-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_HrOFqakZgRc_PVVBfrvaAg-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_HrOFqakZgRc_PVVBfrvaAg-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_HrOFqakZgRc_PVVBfrvaAg-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_HrOFqakZgRc_PVVBfrvaAg-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_HrOFqakZgRc_PVVBfrvaAg-2xl.png 1600w" alt="" width="1348" height="180" layout="responsive"></amp-img></figure><p id="fac3" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Next, you can add a UA comment here if you want (we did not)</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_ROeDTiEzmltDo1DXqc9_Kg.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_ROeDTiEzmltDo1DXqc9_Kg-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_ROeDTiEzmltDo1DXqc9_Kg-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_ROeDTiEzmltDo1DXqc9_Kg-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_ROeDTiEzmltDo1DXqc9_Kg-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_ROeDTiEzmltDo1DXqc9_Kg-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_ROeDTiEzmltDo1DXqc9_Kg-2xl.png 1600w" alt="" width="1085" height="147" layout="responsive"></amp-img></figure><p id="77db" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Next, Press return as we are presented with one option and luckily it is the option we want.</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_D2w2SM1-T-WgCVNRlp62KQ.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_D2w2SM1-T-WgCVNRlp62KQ-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_D2w2SM1-T-WgCVNRlp62KQ-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_D2w2SM1-T-WgCVNRlp62KQ-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_D2w2SM1-T-WgCVNRlp62KQ-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_D2w2SM1-T-WgCVNRlp62KQ-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_D2w2SM1-T-WgCVNRlp62KQ-2xl.png 1600w" alt="" width="1291" height="161" layout="responsive"></amp-img></figure><p id="c324" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Next, you are going to be asked for the location of where to put the files just press return 4 times as the defaults are good and you will be presented with the below</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_CF3iKmOGsHV4qko4LI-k0Q-1.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_CF3iKmOGsHV4qko4LI-k0Q-1-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_CF3iKmOGsHV4qko4LI-k0Q-1-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_CF3iKmOGsHV4qko4LI-k0Q-1-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_CF3iKmOGsHV4qko4LI-k0Q-1-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_CF3iKmOGsHV4qko4LI-k0Q-1-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_CF3iKmOGsHV4qko4LI-k0Q-1-2xl.png 1600w" alt="" width="1284" height="890" layout="responsive"></amp-img></figure><p id="dad8" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Next, We do want to expose so press "Y" followed by return.</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_sJV62NV2s2Eu3sBjlE6uoA-1.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_sJV62NV2s2Eu3sBjlE6uoA-1-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_sJV62NV2s2Eu3sBjlE6uoA-1-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_sJV62NV2s2Eu3sBjlE6uoA-1-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_sJV62NV2s2Eu3sBjlE6uoA-1-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_sJV62NV2s2Eu3sBjlE6uoA-1-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_sJV62NV2s2Eu3sBjlE6uoA-1-2xl.png 1600w" alt="" width="1157" height="42" layout="responsive"></amp-img></figure><p id="f5f2" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Again, we are happy for the full node to expose itself so press "Y" and return again</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_OS7NSnWin3KnsVHJGEFOEg-1.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_OS7NSnWin3KnsVHJGEFOEg-1-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_OS7NSnWin3KnsVHJGEFOEg-1-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_OS7NSnWin3KnsVHJGEFOEg-1-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_OS7NSnWin3KnsVHJGEFOEg-1-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_OS7NSnWin3KnsVHJGEFOEg-1-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_OS7NSnWin3KnsVHJGEFOEg-1-2xl.png 1600w" alt="" width="1207" height="202" layout="responsive"></amp-img></figure><p id="1e1c" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Next, you want to choose from docker-compose or docker swarm. We selected docker-compose and suggest you do the same.</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_4XdDfcRT71pNiqwt9YFI6Q.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_4XdDfcRT71pNiqwt9YFI6Q-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_4XdDfcRT71pNiqwt9YFI6Q-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_4XdDfcRT71pNiqwt9YFI6Q-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_4XdDfcRT71pNiqwt9YFI6Q-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_4XdDfcRT71pNiqwt9YFI6Q-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_4XdDfcRT71pNiqwt9YFI6Q-2xl.png 1600w" alt="" width="1174" height="246" layout="responsive"></amp-img></figure><p id="9e0c" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Next, type "Y" as it is always good to clean up after yourself.</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_Dse884374fQRAddULzgjcg.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_Dse884374fQRAddULzgjcg-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_Dse884374fQRAddULzgjcg-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_Dse884374fQRAddULzgjcg-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_Dse884374fQRAddULzgjcg-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_Dse884374fQRAddULzgjcg-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_Dse884374fQRAddULzgjcg-2xl.png 1600w" alt="" width="1222" height="169" layout="responsive"></amp-img></figure><p id="101c" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Finally, you will see some output (like the screenshot below) that is the installation completed.</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/2.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/2-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/2-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/2-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/2-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/2-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/2-2xl.png 1600w" alt="" width="1189" height="472" layout="responsive"></amp-img></figure><p id="8feb" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Once it is finished you will see the following</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/3.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/3-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/3-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/3-md.png 768w ,https://cryptoskillz.com/blog/media/posts/21/responsive/3-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/21/responsive/3-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/21/responsive/3-2xl.png 1600w" alt="" width="1368" height="315" layout="responsive"></amp-img></figure><p data-selectable-paragraph=""> </p><h1 id="0f5f" class="lf lg bf av au el lh li lj lk ll lm ln lo lp lq lr" data-selectable-paragraph="">Useful things to know about cyphernode</h1><p id="a3a9" class="ls lt bf av lu b lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">Now we have been playing with cyphernode for a few weeks our understanding is growing and a result it makes sense to list the most common things that slowed us down in our studying of this excellent product.</p><h2 id="8662" class="mh lg bf av au el mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">zipped files</h2><p id="518a" class="ls lt bf av lu b lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph=""><strong class="lu mg">client.7z<br></strong>Use your password you set at the being to unzip this and you will find the private keys for your wallets.</p><p id="feb3" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph=""><strong class="lu mg">config.7z<br></strong>Again, use your password to unzip this and you will find a config file that you can use to build more versions of cyphernode with this configuration.</p><p id="61ef" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph=""><strong class="lu mg">wallet directory<br></strong>There are 4 wallets referenced in the bitcoin.conf file and it is assumed (at this point) that are using some pattern to set the wallet names. Further experiment will show us what this pattern is.</p><p id="6daa" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph=""><em class="pc">watching01.dat<br></em>not sure what this wallet is for our hunch is it may be for watch only nodes. We will have to research this further.</p><p id="4c20" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph=""><em class="pc">xpubwatching01.dat<br></em>Not sure about this one either but we can infer from its name that it is to do with Xpub which we are also going to be looking into.</p><p id="6c22" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph=""><em class="pc">spending01.dat<br></em>This is the main wallet file that full node uses</p><p id="08a9" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph=""><em class="pc">ln01.dat<br></em>This is the wallet that the lightning node uses.</p><h1 id="5dfa" class="lf lg bf av au el lh li lj lk ll lm ln lo lp lq lr" data-selectable-paragraph="">ECS</h1><p id="6773" class="ls lt bf av lu b lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">It has been a while since we have actually slung some code for ECS and Bitcoin development moves at a steady clip so it is nice to get back and update it.</p><p id="123d" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Our main goals for this code update is to make ECS support the latest version of "<a href="https://bitcoin.org/en/bitcoin-core/" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">Bitcoin Core</strong></a>" which at the time of writing this is 0.18.1.</p><p id="4743" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">As we were replacing our cobbled together backend with the infinitely superior "<a href="https://cyphernode.io/" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">cyphernode</strong></a>" we thought it would be prudent to make it agnostic at this point so it would work with any backend</p><p id="3f81" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">The latest branch that deals with code in this tutorial can be found "<a href="https://github.com/cryptoskillz/ECS/tree/part19-cyphernode-integration" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">here</strong></a>"</p><p id="d9e1" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">It is worth noting that we literately changed our entire back end here and because Bitcoin has been so awesomely programmed it took about a day and required about adding 10 lines of code. Working on e-commerce for well over a decade I know how hard this would have been using traditional e-commerce/banking/fintech architecture. We are really entertaining a golden time for payments.</p><h2 id="d025" class="mh lg bf av au el mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">Database base changes</h2><p id="dae9" class="ls lt bf av lu b lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">None</p><h2 id="34a4" class="mh lg bf av au el mi mj mk ml mm mn mo mp mq mr ms" data-selectable-paragraph="">Code Changes</h2><p id="bba0" class="ls lt bf av lu b lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">Apart from the odd bug fix here and there (which you can see by looking at the "<a href="https://github.com/cryptoskillz/ECS/commits/part19-cyphernode-integration" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">commit history</strong></a>" if you really want to) all of the refactorings we did was in the "<a href="https://github.com/cryptoskillz/ECS/tree/part19-cyphernode-integration/server" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">server</strong></a>" component. So let us go ahead and break down the changes we made.</p><p id="28a0" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph=""><strong class="lu mg">"</strong><a href="https://github.com/cryptoskillz/ECS/blob/part19-cyphernode-integration/server/.env_copy" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">.env </strong></a><strong class="lu mg">"changes</strong></p><p id="71c6" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">As the concept of accounts has been "<a href="https://github.com/bitcoin-dot-org/bitcoin.org/issues/1287" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">deprecated</strong></a>" in the latest version bitcoin core we changed the env var to just hold the wallet.</p><p id="6b6b" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Note there were 4 wallets that cyphernode created and with some trial and error we found out the one we want is called ‘spending01.dat’ so we preconfigured it to this in the env vars below.</p><pre class="ke kf kg kh ki dv ge df"><span id="d9b6" class="mh lg bf av my b dz mz na l nb" data-selectable-paragraph="">EMAILSMTP = <br>EMAILUSERNAME = <br>EMAILPASSWORD = <br>WALLETPASSPHRASE = <br>WALLET = 'spending01.dat'<br>RPCUSERNAME = <br>NETWORK = 1<br>LIGHTNETWORK=2<br>RPCUSERNAME =<br>RPCPASSWORD = <br>RPCHOST = 127.0.0.1 <br>RPCPORT = 18332<br>BLOCKIOKEY = <br>BLOCKIOSECRET = <br>PORT = 3030<br>CONFIRMATIONS=1<br>STRIKEAPIKEY=<br>STRIKEENDPOINT=</span></pre><p id="21aa" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">"<a href="https://github.com/cryptoskillz/ECS/blob/part19-cyphernode-integration/server/config.js" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">config.js</strong></a>" changes</p><p id="3d89" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">We upgraded "<a href="https://www.npmjs.com/package/bitcoin-core" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">bitcoin cor</strong></a><strong class="lu mg">e</strong>" to 2.2.0 and it facilitated the name of the wallet we are using in the config parameter so we went ahead and did that. I would like an RPC call that returned the default wallet</p><pre class="ke kf kg kh ki dv ge df"><span id="e71b" class="mh lg bf av my b dz mz na l nb" data-selectable-paragraph="">const Client = require("bitcoin-core");<br>if (process.env.NETWORK == 1) {<br>  client = new Client({<br>    host: "127.0.0.1",<br>    port: 18332,<br>    wallet: process.env.WALLET,<br>    username: process.env.RPCUSERNAME,<br>    password: process.env.RPCPASSWORD<br>  });<br>}</span><span id="2a36" class="mh lg bf av my b dz pd pe pf pg ph na l nb" data-selectable-paragraph="">if (process.env.NETWORK == 2) {<br>  client = new Client({<br>    host: "127.0.0.1",<br>    port: 8332,<br>    wallet: process.env.WALLET,<br>    username: process.env.RPCUSERNAME,<br>    password: process.env.RPCPASSWORD<br>  });<br>}</span></pre><p id="f4b4" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph=""><strong class="lu mg">"</strong><a href="https://github.com/cryptoskillz/ECS/tree/part19-cyphernode-integration/server/api/helpers" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">api.js </strong></a><strong class="lu mg">"changes</strong></p><p id="e556" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">We removed the account and passphrase code. We may add the passphrase option back in the future but it will have to be switchable so it works with backends that have encrypted wallets (or not)</p><pre class="ke kf kg kh ki dv ge df"><span id="2f51" class="mh lg bf av my b dz mz na l nb" data-selectable-paragraph="">this.generateAddress = function generateAddress(uid, res) {<br>  //create a new address in theaccount account :]<br>  client.getNewAddress().then(address =&gt; {<br>    //debug<br>    //console.log(address);</span><span id="2f23" class="mh lg bf av my b dz pd pe pf pg ph na l nb" data-selectable-paragraph="">//insert it into the database<br>    db.run(<br>      `INSERT INTO sessions(address,userid,net) VALUES(?,?,?)`,<br>      [address, uid, process.env.NETWORK],<br>      function(err) {<br>        if (err) {<br>          //debug<br>          //return console.log(err.message);</span><span id="c126" class="mh lg bf av my b dz pd pe pf pg ph na l nb" data-selectable-paragraph="">//return error<br>          res.send(JSON.stringify({ error: err.message }));<br>          return;<br>        }<br>        //return the address<br>        res.send(JSON.stringify({ address: address }));<br>      }<br>    );<br>    return;<br>  });<br>};</span></pre><p id="2ed8" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">We also recorded the sweep function to use the much simpler "<a href="https://bitcoincore.org/en/doc/0.16.0/rpc/wallet/sendtoaddress/" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">sendtoaddress</strong></a><strong class="lu mg">"</strong> function that was introduced in 0.16.0.</p><pre class="ke kf kg kh ki dv ge df"><span id="138c" class="mh lg bf av my b dz mz na l nb" data-selectable-paragraph="">this.sweep = function sweep(address, res) {<br>  let sqldata = [0];<br>  let sql = `select * from ecs_coldstorageaddresses where used = ?`;</span><span id="5062" class="mh lg bf av my b dz pd pe pf pg ph na l nb" data-selectable-paragraph="">//get a cold storage address<br>  db.get(sql, sqldata, (err, result) =&gt; {<br>    if (err) {<br>      return console.error(err.message);<br>    }<br>    //save the address<br>    var coldstorageaddress = result.address;<br>    client.listUnspent(1, 9999999, [address]).then(result =&gt; {<br>      //debug<br>      console.log(result[0]);<br>      if (result.length == 0) {<br>        //debug<br>        //console.log(result);<br>        res.send(<br>          JSON.stringify({<br>            result: "nothing to sweep no unspent transactions"<br>          })<br>        );<br>        return;<br>      } else {<br>        if (result[0].confirmations &gt;= process.env.CONFIRMATIONS) {<br>          amounttosend = result[0].amount.toFixed(8);<br>          //debug<br>          console.log("ams" + amounttosend);<br>          //return;<br>          client<br>            .sendToAddress(coldstorageaddress, amounttosend)<br>            .then(result =&gt; {<br>let sqldata = ["1", address];<br>              let sql = `UPDATE sessions<br>                  SET swept = ?<br>                  WHERE address = ?`;<br>              //run sql<br>              db.run(sql, sqldata, function(err) {<br>                if (err) {<br>                }<br>                //update the address in cold storage so it is not used again.<br>                //build sql<br>                let sqldata = ["1", coldstorageaddress];<br>                let sql = `UPDATE ecs_coldstorageaddresses<br>                               SET used = ?<br>                              WHERE ecs_coldstorageaddress = ?`;<br>                //run sql<br>                db.run(sql, sqldata, function(err) {<br>                  if (err) {<br>                  }<br>                  //return status<br>                  res.send(JSON.stringify({ status: "swept" }));<br>                  return;<br>                });<br>              });<br>            });<br>        } else {<br>          //return status<br>          res.send(<br>            JSON.stringify({<br>              status: "not enough confirmations :" + result[0].confirmations<br>            })<br>          );<br>          return;<br>        }<br>      }<br>    });<br>  });<br>};</span></pre><p id="aa9b" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">"<a href="https://github.com/cryptoskillz/ECS/blob/part19-cyphernode-integration/server/api/helpers/webhook.js" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">webhook.js</strong></a>" <strong class="lu mg">changes</strong></p><p id="742d" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">Again we removed the account and passphrase code.</p><pre class="ke kf kg kh ki dv ge df"><span id="2d93" class="mh lg bf av my b dz mz na l nb" data-selectable-paragraph="">this.checkPayment = function checkPayment(token, address, res) {<br>  //get the unspent transactions for the address we are intrested in.<br>  client.listUnspent(1, 9999999, [address]).then(result =&gt; {</span><span id="55db" class="mh lg bf av my b dz pd pe pf pg ph na l nb" data-selectable-paragraph="">    if (result.length &gt; 0) {<br>      //check the confirmations (set int the env var)<br><br>      //in any live enviorment.<br>      if (result[0].confirmations &gt;= process.env.CONFIRMATIONS) {<br>        //valid<br>        res.send(JSON.stringify({ status: 1 }));<br>      } else {<br>        //not valid<br>        res.send(JSON.stringify({ status: 0 }));<br>      }<br>    } else {<br>      res.send(JSON.stringify({ status: 0 }));<br>    }<br>  });<br>};</span></pre><h1 id="3414" class="lf lg bf av au el lh li lj lk ll lm ln lo lp lq lr" data-selectable-paragraph="">Conclusion</h1><p id="b0aa" class="ls lt bf av lu b lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">That is it, it was a very easy upgrade especially seeing as we completely replaced the backend. This is the beauty of Bitcoin it gives you control of every aspect of the flow. Imagine replacing your PCI server for you ecommerce provider over a weekend requiring the permission of no one :]</p><p id="541c" class="ls lt bf av lu b lv mt lx mu lz mv mb mw md mx mf" data-selectable-paragraph="">In the next article, we will host this and replace our test store with the new code.</p><aside><ul class="post-tag"><li><a href="https://cryptoskillz.com/blog/amp/cyphernode/">cyphernode</a></li><li><a href="https://cryptoskillz.com/blog/amp/ecs/">ecs</a></li><li><a href="https://cryptoskillz.com/blog/amp/fullnode/">fullnode</a></li></ul><div class="post-share"><amp-social-share type="system" width="40" height="40" data-param-text="Working With Fullnodes Part 5 Cyphernode II"></amp-social-share><amp-social-share type="twitter" width="40" height="40" data-param-text="Working With Fullnodes Part 5 Cyphernode II" data-param-url="https://cryptoskillz.com/blog/amp/working-with-fullnodes-part-5-cyphernode-ii.html"></amp-social-share></div></aside></div></article><nav class="post-pagination wrap-inner"><div class="post-pagination-prev"><span>Previous</span> <a href="https://cryptoskillz.com/blog/amp/working-with-full-nodes-part-4-cyphernode-i.html">Working With Fullnodes Part 4 Cyphernode I</a></div><div class="post-pagination-next"><span>Next</span> <a href="https://cryptoskillz.com/blog/amp/working-with-fullnodes-part-6-cyphernode-iii.html">Working With Fullnodes Part 6 Cyphernode III</a></div></nav></main><amp-animation id="showAnim" layout="nodisplay"><script type="application/json">{
                    "duration": "200ms",
                    "fill": "both",
                    "iterations": "1",
                    "direction": "alternate",
                    "animations": [{
                        "selector": ".post-scroll",
                        "keyframes": [{
                            "opacity": "1",
                            "visibility": "visible",
                            "transform": "scale(1)"
                        }]
                    }]
                }</script></amp-animation><amp-animation id="hideAnim" layout="nodisplay"><script type="application/json">{
                    "duration": "200ms",
                    "fill": "both",
                    "iterations": "1",
                    "direction": "alternate",
                    "animations": [{
                        "selector": ".post-scroll",
                        "keyframes": [{
                            "opacity": "0",
                            "visibility": "hidden",
                            "transform": "scale(0.1)"
                        }]
                    }]
                }</script></amp-animation><div class="post-scroll-marker"><amp-position-observer on="enter:hideAnim.start; exit:showAnim.start" layout="nodisplay"></amp-position-observer></div><button class="post-scroll" on="tap:top.scrollTo(duration=200)">&#8593;</button><footer class="bottom">Powered by Publii</footer><amp-sidebar id="navbar-sidebar" layout="nodisplay"><ul><li><a href="https://cryptoskillz.com/index.html">ECS</a></li><li><a href="https://cryptoskillz.com/blox.html">BLOX</a></li><li><a href="https://cryptoskillz.com/about.html">ABOUT</a></li><li><a href="https://cryptoskillz.com/blog/ecs/">BLOG</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://cryptoskillz.com/blog/amp/ecs/" target="_self">ECS</a></li><li><a href="https://cryptoskillz.com/blog/amp/fullnode/" target="_self">FULLNODE</a></li><li><a href="https://cryptoskillz.com/blog/amp/cyphernode/" target="_self">CYPHERNODE</a></li></ul></li></ul></amp-sidebar><amp-analytics type="googleanalytics" id="analytics1"><script type="application/json">{
            "vars": {
                "account": "ca-pub-4710117865976591"
            },
            "triggers": {
                "trackPageview": {
                    "on": "visible",
                    "request": "pageview"
                }
            }
        }</script></amp-analytics></body></html>