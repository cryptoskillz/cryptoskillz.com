<!doctype html><html amp lang="en"><head><meta charset="utf-8"><title>Author: cryptoskillz - cryptoskillz</title><link rel="canonical" href="https://cryptoskillz.com/blog/authors/cryptoskillz/page/2/"><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"><link href="https://fonts.googleapis.com/css?family=Roboto:400,700" rel="stylesheet" type="text/css"><link rel="prev" href="https://cryptoskillz.com/blog/amp/authors/cryptoskillz/"><link rel="next" href="https://cryptoskillz.com/blog/amp/authors/cryptoskillz/page/3/"><script async custom-element="amp-sidebar" src="https://cdn.ampproject.org/v0/amp-sidebar-0.1.js"></script><script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script><script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script><script async custom-element="amp-video" src="https://cdn.ampproject.org/v0/amp-video-0.1.js"></script><script type="application/ld+json">{"@context":"http://schema.org","@type":"Organization","name":"cryptoskillz","url":"https://cryptoskillz.com/blog/amp/"}</script><style amp-custom>article,
aside,
footer,
header,
hgroup,
main,
nav,
section {
  display: block; }

*,
*:before,
*:after {
  -webkit-box-sizing: content-box;
  box-sizing: content-box;
  margin: 0;
  padding: 0; }

li {
  list-style: none; }

amp-img {
  max-width: 100%; }

button,
input,
select,
textarea {
  font: inherit; }

html {
  font-size: 1rem; }

body {
  background: #f1f1f1;
  color: #262626;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
  line-height: 1.6; }

a {
  color:  #039be5;
  text-decoration: none;
  -webkit-transition: all 0.12s linear 0s;
  -o-transition: all 0.12s linear 0s;
  transition: all 0.12s linear 0s; }

a:hover {
  color: #262626;
  text-decoration: underline;
  -webkit-text-decoration-skip: ink;
  text-decoration-skip: ink; }

a:active {
  color: #262626; }

a:focus {
  outline: 2px dotted #039be5; }

figure,
blockquote,
p,
ul,
ol,
dl,
table,
hr,
fieldset {
  margin-top: 1.6rem; }

h1,
h2,
h3,
h4,
h5,
h6 {
  color: #262626;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
  font-weight: 500;
  line-height: 1.2;
  margin-top: 2.13333rem; }

h1 {
  font-size: 1.67583rem;
  font-weight: normal; }

h2 {
  font-size: 1.4729rem; }

h3 {
  font-size: 1.29454rem; }

h4 {
  font-size: 1.13778rem; }

h5 {
  font-size: 1rem; }

h6 {
  font-size: 0.87891rem; }

h2 + p,
h3 + p,
h4 + p,
h5 + p,
h6 + p {
  margin-top: 0.8rem; }

b,
strong {
  font-weight: 600; }

blockquote {
  color: #6c7175;
  font-family: "Droid Serif", "Times", "Source Serif Pro", serif;
  font-style: italic;
  padding: 1.33333rem 0.53333rem 1.33333rem 3.2rem;
  position: relative; }
  blockquote:before {
    display: block;
    content: "\201C";
    font-size: 4.41226rem;
    position: absolute;
    left: 0;
    top: -12px;
    color: rgba(108, 113, 117, 0.5); }
  blockquote > :nth-child(1) {
    margin-top: 0; }

ul,
ol {
  margin-left: 2rem; }
  ul > li,
  ol > li {
    list-style: inherit;
    padding: 0 0 0.26667rem 0.26667rem; }

dl dt {
  color: #262626;
  font-weight: 600; }

code,
pre {
  background-color: #f1f1f1;
  font-family: monospace; }

pre {
  margin: 1.6rem 0 0;
  padding: 1.6rem;
  white-space: pre-wrap;
  word-wrap: break-word;
  overflow-x: auto; }
  pre > code {
    color: #262626;
    padding: 0; }

code {
  border-radius: 3px;
  color: #262626;
  padding: 0.26667rem 0.53333rem; }

table {
  border-collapse: collapse;
  border-spacing: 0;
  border: 1px solid #d4d4d4;
  width: 100%;
  overflow-x: auto;
  vertical-align: top;
  text-align: left;
  white-space: nowrap; }
  table th {
    font-weight: 500;
    padding: 0.53333rem 1.06667rem; }
  table tr {
    border-bottom: 1px solid #d4d4d4; }
    table tr:nth-child(2n) {
      background: #f1f1f1; }
  table td {
    padding: 0.53333rem 1.06667rem; }

figcaption {
  clear: both;
  color: rgba(108, 113, 117, 0.6);
  font-size: 0.82397rem;
  margin: 0.8rem 0 0;
  text-align: center; }

sub,
sup {
  font-size: 65%; }

hr {
  border: 0;
  height: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(255, 255, 255, 0.3); }

.btn, [type=button],
[type=submit],
button {
  background: #039be5;
  border: none;
  border-radius: 2px;
  color: #ffffff;
  cursor: pointer;
  display: inline-block;
  font-size: 0.87891rem;
  font-weight: 500;
  line-height: 1.9;
  padding: 0.53333rem 1.33333rem;
  text-align: center;
  text-decoration: none;
  -webkit-transition: all .15s ease;
  -o-transition: all .15s ease;
  transition: all .15s ease;
  width: auto; }
  .btn:hover, [type=button]:hover,
  [type=submit]:hover,
  button:hover {
    background: #262626;
    color: #ffffff; }
  .btn:focus, [type=button]:focus,
  [type=submit]:focus,
  button:focus {
    outline: none; }
  .btn-outline {
    border: 1px solid #ddd;
    background: #ffffff;
    border-radius: 3px;
    color: #262626; }

[type=button],
[type=submit],
button {
  text-transform: uppercase;
  -webkit-appearance: none;
  -moz-appearance: none; }

.navbar {
  background: #039be5;
  -webkit-box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.2);
  box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.2);
  line-height: 3;
  max-height: 4rem; }
  .navbar > div {
    -webkit-box-align: center;
    -ms-flex-align: center;
    align-items: center;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-pack: center;
    -ms-flex-pack: center;
    justify-content: center;
    text-align: left;
    max-width: 700px;
    margin: 0 auto; }
  .navbar a {
    color: #ffffff;
    text-decoration: none; }
  .navbar-sidebar-toggle {
    left: 0;
    position: relative;
    text-indent: -99999rem; }
    .navbar-sidebar-toggle:before {
      content: "";
      display: block;
      border-top: 0.375rem double #ffffff;
      border-bottom: 0.125rem solid #ffffff;
      height: 0.125rem;
      position: absolute;
      text-indent: 0;
      top: 50%;
      width: 1.3rem;
      -webkit-transform: translate(0px, -50%);
      -ms-transform: translate(0px, -50%);
      transform: translate(0px, -50%); }


.logo {
            display: inline-block;
  font-weight: 600;
  line-height: 1;
            margin: 0 auto;
            height: 2rem;
            text-indent: -9999px;
            width: 240px;vertical-align: middle;
        }
        .logo.logo-text {
            line-height: 2;
            text-align: center;
            text-indent: 0;
        }

amp-sidebar {
  background: #ffffff;
  width: 240px; }
  amp-sidebar > ul {
    margin: 0.8rem 0 0;
    padding: 0; }
    amp-sidebar > ul ul {
      border-left: 1px solid #d4d4d4;
      margin: 0.53333rem 0 0; }
    amp-sidebar > ul li {
      color: #262626;
      font-size: 0.9375rem;
      font-weight: 600;
      list-style: none;
      line-height: 1.4;
      padding: 0.42667rem 1.06667rem; }
      amp-sidebar > ul li li {
        font-weight: normal;
        padding: 0.26667rem 0 0.26667rem 1.06667rem; }
    amp-sidebar > ul a,
    amp-sidebar > ul a:visited {
      color: #262626; }

.bg-white {
  background: #ffffff; }

.wrap-page {
  max-width: 700px;
  margin: 0 auto; }

@media all and (max-width: 43.6875em) {
  .wrap-inner {
    padding: 0 6%; } }

.page-title {
  background: #ffffff;
  -webkit-box-shadow: 0 2px 3px rgba(38, 38, 38, 0.1);
  box-shadow: 0 2px 3px rgba(38, 38, 38, 0.1);
  margin-bottom: 0.8rem;
  padding: 1.6rem 6%; }
  .page-title > h1 {
    margin: 0;
    font-size: 1.29454rem; }
  .page-title > p {
    font-size: 0.87891rem;
    color: #6c7175;
    line-height: 1.3;
    margin: 0.26667rem 0 0; }
  .page-title-author {
    border-radius: 50%;
    float: left;
    height: 2.5rem;
    width: 2.5rem; }
    .page-title-author + h1 {
      margin-left: 3.5rem; }
      .page-title-author + h1 + p {
        margin-left: 3.5rem; }

.card {
  background: #ffffff;
  -webkit-box-shadow: 0 2px 3px rgba(38, 38, 38, 0.1);
  box-shadow: 0 2px 3px rgba(38, 38, 38, 0.1);
  margin-bottom: 0.8rem;
  padding-bottom: 1.06667rem; }

  .card-meta {
    border-top: 1px solid #d4d4d4;
    color: rgba(108, 113, 117, 0.6);
    font-size: 0.7242rem;
    font-weight: 500;
    margin-top: 1.06667rem;
    padding-top: 1.06667rem;
    text-transform: uppercase; }
    .card-meta a + time:before {
      content: "";
      background: #d4d4d4;
      display: inline-block;
      height: 3px;
      margin: 0 8px;
      width: 3px;
      vertical-align: middle;
      border-radius: 50%; }
  .card-text {
    font-size: 0.9375rem;
    overflow: hidden;
    padding: 0 6%; }
    .card-text h2 {
      font-size: 1.13778rem; }

.post {
  margin-bottom: 2.13333rem; }
  .post-featured-image {
    margin-top: 0;
    position: relative; }
    .post-featured-image > figcaption {
      background: rgba(0, 0, 0, 0.5);
      border-radius: 3px;
      color: #ffffff;
      position: absolute;
      bottom: 0.8rem;
      padding: 0 0.26667rem;
      right: 6%; }
  .post-header {
    margin-bottom: 2.13333rem; }
  .post-meta {
    border-bottom: 1px solid #d4d4d4;
    color: rgba(108, 113, 117, 0.6);
    font-size: 0.7242rem;
    font-weight: 500;
    margin-top: 1.06667rem;
    padding-bottom: 1.06667rem;
    text-transform: uppercase; }
    .post-meta a + time:before {
      content: "";
      background: #d4d4d4;
      display: inline-block;
      height: 3px;
      margin: 0 8px;
      width: 3px;
      vertical-align: middle;
      border-radius: 50%; }
  .post-tag {
    margin: 0; }
    .post-tag > li {
      display: inline-block;
      padding: 0; }
      .post-tag > li a {
        background: #f1f1f1;
        border-radius: 2px;
        color: #6c7175;
        font-size: 0.77248rem;
        display: inline-block;
        margin: 0 0.26667rem 0.26667rem 0;
        padding: 0.26667rem 0.53333rem; }
        .post-tag > li a:hover {
          background: #039be5;
          color: #ffffff;
          text-decoration: none; }
  .post-share {
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: horizontal;
    -webkit-box-direction: normal;
    -ms-flex-direction: row;
    flex-direction: row;
    -webkit-box-pack: justify;
    -ms-flex-pack: justify;
    justify-content: space-between;
    margin-top: 1.6rem;
    width: 100%; }
    .post-share amp-social-share {
      -webkit-box-flex: 1;
      -ms-flex: 1 0 auto;
      flex: 1 0 auto;
      background-size: 24px; }
  .post-scroll {
    color: #ffffff;
    background: #039be5;
    bottom: 10px;
    border-radius: 50%;
    border: none;
    -webkit-box-shadow: 0 1px 1.5px 0 rgba(38, 38, 38, 0.12), 0 1px 1px 0 rgba(38, 38, 38, 0.24);
    box-shadow: 0 1px 1.5px 0 rgba(38, 38, 38, 0.12), 0 1px 1px 0 rgba(38, 38, 38, 0.24);
    font-size: 1.13778rem;
    height: 46px;
    opacity: 0;
    outline: none;
    position: fixed;
    padding: 0;
    right: 4%;
    visibility: hidden;
    width: 46px;
    z-index: 9999; }
    .post-scroll-marker {
      height: 0px;
      position: absolute;
      top: 100px;
      width: 0px; }
        .post-pagination {
    background: #f1f1f1;
    -webkit-box-shadow: inset 0 2px 3px rgba(38, 38, 38, 0.1);
    box-shadow: inset 0 2px 3px rgba(38, 38, 38, 0.1);
    border-top: 1px solid #d4d4d4;
    padding: 1.06667rem 0; }
    .post-pagination > div {
      line-height: 1.2;
      padding: 0.53333rem 1.06667rem;
      text-align: center; }
      .post-pagination > div span {
        display: block;
        color: #6c7175;
        font-size: 0.7242rem;
        font-weight: 500;
        margin-bottom: 0.26667rem;
        text-transform: uppercase; }
    .post-pagination-prev a:before {
      content: "\2190";
      margin-right: 0.26667rem; }
    .post-pagination-next a:after {
      content: "\2192";
      margin-left: 0.26667rem; }

aside {
  margin: 1.6rem 0 0; }

.align-left {
  text-align: left; }

.align-right {
  text-align: right; }

.align-center {
  text-align: center; }

.align-justify {
  text-align: justify; }

.msg {
  border-left: 2px solid transparent;
  padding: 1.06667rem 1.06667rem; }
  .msg--highlight {
    background-color: #fff8e6;
    border-color: #e2ac4f; }
  .msg--info {
    background: rgba(45, 97, 201, 0.03);
    border-color: #039be5; }
  .msg--success {
    background: #f7fbf6;
    border-color: #5ab44b; }
  .msg--warning {
    background: #fff3f3;
    border-color: #c06367;
    color: #a94442; }

.dropcap:first-letter {
  float: left;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
  font-size: 2.16943rem;
  line-height: 0.7;
  margin-right: 0.53333rem;
  padding: 0.53333rem 0.53333rem 0.53333rem 0; }

.pagination {
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
  -webkit-box-pack: justify;
  -ms-flex-pack: justify;
  justify-content: space-between;
  margin: 0.8rem 0; }
  .pagination > a {
    padding-left: 0;
    padding-right: 0;
    width: 49%; }
  .pagination-right {
    margin-left: auto; }

.bottom {
  background: #039be5;
  color: #ffffff;
  padding: 1.06667rem 4%;
  text-align: center; }</style><style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript><script async src="https://cdn.ampproject.org/v0.js"></script><script custom-element="amp-animation" src="https://cdn.ampproject.org/v0/amp-animation-0.1.js" async></script><script custom-element="amp-position-observer" src="https://cdn.ampproject.org/v0/amp-position-observer-0.1.js" async></script></head><body><nav class="navbar wrap-inner" id="top"><div><a on="tap:navbar-sidebar.toggle" class="navbar-sidebar-toggle" title="Menu">Menu</a> <a class="logo logo-text" href="https://cryptoskillz.com/blog/amp/">cryptoskillz</a></div></nav><main class="wrap-page"><div class="page-title"><h1>cryptoskillz <sup>(31)</sup></h1></div><article class="card"><a href="https://cryptoskillz.com/blog/amp/working-with-fullnodes-part-6-cyphernode-iii.html"><amp-img src="https://cryptoskillz.com/blog/media/posts/22/0_tnWANgeBqBWRZOxF.png" alt="" srcset="https://cryptoskillz.com/blog/media/posts/22/responsive/0_tnWANgeBqBWRZOxF-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/22/responsive/0_tnWANgeBqBWRZOxF-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/22/responsive/0_tnWANgeBqBWRZOxF-md.png 768w" sizes="(max-width: 768px) 100vw, 768px" height="567" layout="responsive" width="792"></amp-img></a><div class="card-text"><h2><a href="https://cryptoskillz.com/blog/amp/working-with-fullnodes-part-6-cyphernode-iii.html">Cyphernode III setting up Lightning</a></h2><p> PreambleThis article aims to play with "Lightning" on the "cyphernode" backend as well as explorer "docker" and figure out how it all works with the proxy etc. Now, let us be upfront and clear we know nothing about "docker" we will be learning and as&hellip;</p><p class="card-meta"><time datetime="2019-08-28T12:33">August 28, 2019</time></p></div></article><article class="card"><a href="https://cryptoskillz.com/blog/amp/working-with-fullnodes-part-5-cyphernode-ii.html"><amp-img src="https://cryptoskillz.com/blog/media/posts/21/1_h6R4v-LSbRG83IGCUZDN0Q.jpeg" alt="" srcset="https://cryptoskillz.com/blog/media/posts/21/responsive/1_h6R4v-LSbRG83IGCUZDN0Q-xs.jpeg 300w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_h6R4v-LSbRG83IGCUZDN0Q-sm.jpeg 480w ,https://cryptoskillz.com/blog/media/posts/21/responsive/1_h6R4v-LSbRG83IGCUZDN0Q-md.jpeg 768w" sizes="(max-width: 768px) 100vw, 768px" height="3456" layout="responsive" width="3456"></amp-img></a><div class="card-text"><h2><a href="https://cryptoskillz.com/blog/amp/working-with-fullnodes-part-5-cyphernode-ii.html">Cyphernode II rebuilding it for ECS</a></h2><p>IntroductionThis guide aims to program a website to accept Bitcoin. In the previous tutorial, we set up and configured "cyphernode" which is an excellent dockerised bitcoin and lightning full node plus other useful. Now we are going to set it up to use specifically for our&hellip;</p><p class="card-meta"><time datetime="2019-08-19T12:32">August 19, 2019</time></p></div></article><article class="card"><a href="https://cryptoskillz.com/blog/amp/working-with-full-nodes-part-4-cyphernode-i.html"><amp-img src="https://cryptoskillz.com/blog/media/posts/20/1_8uCeMDcHVyVSlXe0y6UCtg.png" alt="" srcset="https://cryptoskillz.com/blog/media/posts/20/responsive/1_8uCeMDcHVyVSlXe0y6UCtg-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/20/responsive/1_8uCeMDcHVyVSlXe0y6UCtg-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/20/responsive/1_8uCeMDcHVyVSlXe0y6UCtg-md.png 768w" sizes="(max-width: 768px) 100vw, 768px" height="567" layout="responsive" width="792"></amp-img></a><div class="card-text"><h2><a href="https://cryptoskillz.com/blog/amp/working-with-full-nodes-part-4-cyphernode-i.html">Introduction to Cyphernode</a></h2><p>Up to this point, we have looked to handle everything ourself, you know with "self-sovereignty" and all. That said over the course of the year (or so) we have run into a number of promising projects that were aligned with our goals whilst simultaneously&hellip;</p><p class="card-meta"><time datetime="2019-08-08T12:32">August 8, 2019</time></p></div></article><article class="card"><a href="https://cryptoskillz.com/blog/amp/the-casa-node.html"><amp-img src="https://cryptoskillz.com/blog/media/posts/19/1_UervJWdfE4srKFWkx6kIoA.png" alt="" srcset="https://cryptoskillz.com/blog/media/posts/19/responsive/1_UervJWdfE4srKFWkx6kIoA-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/19/responsive/1_UervJWdfE4srKFWkx6kIoA-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/19/responsive/1_UervJWdfE4srKFWkx6kIoA-md.png 768w" sizes="(max-width: 768px) 100vw, 768px" height="1115" layout="responsive" width="1313"></amp-img></a><div class="card-text"><h2><a href="https://cryptoskillz.com/blog/amp/the-casa-node.html">The Casa Node</a></h2><p>Whilst we are in the testing mode we would like to give away BTC (via lightning) that is right, free money! If you would like free money "tweet" at us with your lightning address and we will send you some :] This guide aims&hellip;</p><p class="card-meta"><time datetime="2019-06-23T12:30">June 23, 2019</time></p></div></article><article class="card"><a href="https://cryptoskillz.com/blog/amp/integrating-3rd-party-lightning.html"><amp-img src="https://cryptoskillz.com/blog/media/posts/18/1_a22cZdqrqt3k_KXL4CcfDg-xs.jpeg" alt="" srcset="https://cryptoskillz.com/blog/media/posts/18/responsive/1_a22cZdqrqt3k_KXL4CcfDg-xs-xs.jpeg 300w ,https://cryptoskillz.com/blog/media/posts/18/responsive/1_a22cZdqrqt3k_KXL4CcfDg-xs-sm.jpeg 480w ,https://cryptoskillz.com/blog/media/posts/18/responsive/1_a22cZdqrqt3k_KXL4CcfDg-xs-md.jpeg 768w" sizes="(max-width: 768px) 100vw, 768px" height="453" layout="responsive" width="300"></amp-img></a><div class="card-text"><h2><a href="https://cryptoskillz.com/blog/amp/integrating-3rd-party-lightning.html">Integrating 3rd party Lightning</a></h2><p>IntroductionThis guide aims to program a website to accept "Bitcoin". In the previous tutorial, We added "strike" as a standalone project. This time we are going to fully integrate it into our "server" and "CDN" ("sr.js") The SQL in this release changed a lot as&hellip;</p><p class="card-meta"><time datetime="2019-01-23T12:29">January 23, 2019</time></p></div></article><article class="card"><a href="https://cryptoskillz.com/blog/amp/adding-3rd-party-lightning.html"><amp-img src="https://cryptoskillz.com/blog/media/posts/17/1_o-phpGJ9Fmh13YqxCs8y3A-xs.jpeg" alt="" srcset="https://cryptoskillz.com/blog/media/posts/17/responsive/1_o-phpGJ9Fmh13YqxCs8y3A-xs-xs.jpeg 300w ,https://cryptoskillz.com/blog/media/posts/17/responsive/1_o-phpGJ9Fmh13YqxCs8y3A-xs-sm.jpeg 480w ,https://cryptoskillz.com/blog/media/posts/17/responsive/1_o-phpGJ9Fmh13YqxCs8y3A-xs-md.jpeg 768w" sizes="(max-width: 768px) 100vw, 768px" height="450" layout="responsive" width="300"></amp-img></a><div class="card-text"><h2><a href="https://cryptoskillz.com/blog/amp/adding-3rd-party-lightning.html">Adding 3rd party Lightning</a></h2><p></p><h1 id="4570" class="lh li bf av au el lj lk ll lm ln lo lp lq lr ls lt" data-selectable-paragraph="">Introduction</h1><p id="ad64" class="lu lv bf av lw b lx ly lz ma mb mc md me mf mg mh" data-selectable-paragraph="">This guide aims to program a website to accept Bitcoin. In the previous tutorial, We removed "<a href="https://globee.com/" class="cb bx ld le lf lg" target="_blank" rel="noopener noreferrer"><strong class="lw mi">Globee</strong></a><strong class="lw mi">"</strong> so that we had 100% sovereignty over our code and by extension our money. Ironically we are going to add "<a href="https://strike.acinq.co/" class="cb bx ld le lf lg" target="_blank" rel="noopener noreferrer"><strong class="lw mi">strike</strong></a>" which is a 3rd party lightning payment provider. Just as we did in the past we will start the easy way and then remove it and replace it with our own code at a later date.</p><p id="3243" class="lu lv bf av lw b lx mj lz mk mb ml md mm mf mn mh" data-selectable-paragraph="">A quick note on the current lightning nodes. I played with "<a href="https://github.com/lightningnetwork/lnd" class="cb bx ld le lf lg" target="_blank" rel="noopener noreferrer"><strong class="lw mi">LND</strong></a><strong class="lw mi">"</strong> and "<a href="https://github.com/ElementsProject/lightning" class="cb bx ld le lf lg" target="_blank" rel="noopener noreferrer"><strong class="lw mi">c-lightning</strong></a>" for a couple of weeks and could not get them to work to a satisfactory level to fulfil our needs "<a href="https://github.com/lightningnetwork/lnd" class="cb bx ld le lf lg" target="_blank" rel="noopener noreferrer"><strong class="lw mi">LND</strong></a><strong class="lw mi">"</strong> required everything to be on the one server which meant our idea of injecting was just not practical and "<a href="https://github.com/ElementsProject/lightning" class="cb bx ld le lf lg" target="_blank" rel="noopener noreferrer"><strong class="lw mi">c-lightning</strong></a> leaned too heavily on the "<a href="https://github.com/ElementsProject/" class="cb bx ld le lf lg" target="_blank" rel="noopener noreferrer"><strong class="lw mi">elements</strong></a>" project for us to use it a standalone manner. However, this does not concern me as it is amazing software that is still in Alpha.</p><h1 id="6a9e" class="lh li bf av au el lj lk ll lm ln lo lp lq lr ls lt" data-selectable-paragraph="">The SQL</h1><p id="2dc8" class="lu lv bf av lw b lx ly lz ma mb mc md me mf mg mh" data-selectable-paragraph="">We made significant changes to the SQL (it was due) mainly to give the tables names that made sense.</p><h2 id="c623" class="mo li bf av au el mp mq mr ms mt mu mv mw mx my mz" data-selectable-paragraph="">ECS_ tables</h2><p id="a911" class="lu lv bf av lw b lx ly lz ma mb mc md me mf mg mh" data-selectable-paragraph="">A number of tables to have the ECS_ prefix this means they are core tables to ECS such as user &amp; user settings</p><pre class="kg kh ki kj kk dv gg df"><span id="be05" class="mo li bf av na b dz nb nc l nd" data-selectable-paragraph="">ecs_coldstorageaddresses<br>ecs_emailtemplates<br>ecs_user<br>ecs_user_settings</span></pre><h2 id="964f" class="mo li bf av au el mp mq mr ms mt mu mv mw mx my mz" data-selectable-paragraph="">lookup_ tables</h2><p id="ccb2" class="lu lv bf av lw b lx ly lz ma mb mc md me mf mg mh" data-selectable-paragraph="">the prefix lookup_ was introduced as a way to standardise the lookup data we will use in ECS.</p><p id="db12" class="lu lv bf av lw b lx mj lz mk mb ml md mm mf mn mh" data-selectable-paragraph=""><strong class="lw mi">lookup_payment_providers<br></strong>This table is used to hold the payment providers at the moment we have "Bitcoin Core Node" and "strike" but we may add more in the future.</p><pre class="kg kh ki kj kk dv gg df"><span id="110b" class="mo li bf av na b dz nb nc l nd" data-selectable-paragraph="">CREATE TABLE `lookup_payment_providers` (<br> `id` INTEGER PRIMARY KEY AUTOINCREMENT,<br> `providername` INTEGER,<br> `external` INTEGER DEFAULT 0<br>);</span></pre><h2 id="53db" class="mo li bf av au el mp mq mr ms mt mu mv mw mx my mz" data-selectable-paragraph="">order_ tables</h2><p id="cfb9" class="lu lv bf av lw b lx ly lz ma mb mc md me mf mg mh" data-selectable-paragraph="">The tables with the order_ prefix are tables that relate directly to the order</p><pre class="kg kh ki kj kk dv gg df"><span id="7af6" class="mo li bf av na b dz nb nc l nd" data-selectable-paragraph="">order_meta<br>order_payment_details<br>order_product<br>order_product_meta</span><span id="e010" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">The product meta holds information about the product such as size</span><span id="c3eb" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">CREATE TABLE `order_product_meta` (<br> `id` INTEGER PRIMARY KEY AUTOINCREMENT,<br> `productid` INTEGER,<br> `metaname` TEXT,<br> `metavalue` TEXT<br>);</span><span id="10d1" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">The payment details table holds which method we used to process payment as well as any charge / return objects that the provided us. </span><span id="9742" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">CREATE TABLE `order_payment_details` (<br> `id` INTEGER PRIMARY KEY AUTOINCREMENT,<br> `address` TEXT,<br> `providerid` INTEGER,<br> `paymentobject` TEXT,<br> `paymentresponseobject` TEXT<br>);</span></pre><h1 id="3ebe" class="lh li bf av au el lj lk ll lm ln lo lp lq lr ls lt" data-selectable-paragraph="">Strike</h1><p id="fdc7" class="lu lv bf av lw b lx ly lz ma mb mc md me mf mg mh" data-selectable-paragraph="">"<a href="https://strike.acinq.co/" class="cb bx ld le lf lg" target="_blank" rel="noopener noreferrer"><strong class="lw mi">Strike</strong></a>" is an excellent lightning implementation who have taken a lot of the heavy lifting away from us. Simply create an account and then get the api from the settings / API KEYS section as shown below.</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/17/1_4TPapRENaXVGKwh-7Bcaeg.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/17/responsive/1_4TPapRENaXVGKwh-7Bcaeg-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/17/responsive/1_4TPapRENaXVGKwh-7Bcaeg-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/17/responsive/1_4TPapRENaXVGKwh-7Bcaeg-md.png 768w ,https://cryptoskillz.com/blog/media/posts/17/responsive/1_4TPapRENaXVGKwh-7Bcaeg-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/17/responsive/1_4TPapRENaXVGKwh-7Bcaeg-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/17/responsive/1_4TPapRENaXVGKwh-7Bcaeg-2xl.png 1600w" alt="" width="1372" height="811" layout="responsive"></amp-img></figure><p id="d14a" class="lu lv bf av lw b lx mj lz mk mb ml md mm mf mn mh" data-selectable-paragraph="">add this api key to the .env file along with the endpoint</p><pre class="kg kh ki kj kk dv gg df"><span id="14bb" class="mo li bf av na b dz nb nc l nd" data-selectable-paragraph="">mainnet</span><span id="db30" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">STRIKEENDPOINT=<a href="https://api.strike.acinq.co/" class="cb bx ld le lf lg" target="_blank" rel="noopener noreferrer">https://api.strike.acinq.co</a><br>STRIKEAPIKEY=sk_dsdsdsdsd</span><span id="2aa6" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">testnet</span><span id="c96e" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">STRIKEENDPOINT=<a href="https://api.strike.acinq.co/" class="cb bx ld le lf lg" target="_blank" rel="noopener noreferrer">https://api.dev.strike.acinq.co</a><br>STRIKEAPIKEY=sk_dsdsdsdsd</span></pre><h1 id="dca5" class="lh li bf av au el lj lk ll lm ln lo lp lq lr ls lt" data-selectable-paragraph="">The Code</h1><p id="9b58" class="lu lv bf av lw b lx ly lz ma mb mc md me mf mg mh" data-selectable-paragraph="">In this tutorial, we have not integrated with SR.js as it was a brand new UX flow we wanted to get it working standalone first and integrate it later. You can find the code for this branch "<a href="https://github.com/cryptoskillz/ECS/tree/strike" class="cb bx ld le lf lg" target="_blank" rel="noopener noreferrer"><strong class="lw mi">here</strong></a><strong class="lw mi">"</strong></p><h2 id="8893" class="mo li bf av au el mp mq mr ms mt mu mv mw mx my mz" data-selectable-paragraph="">HTML</h2><pre class="kg kh ki kj kk dv gg df"><span id="68f3" class="mo li bf av na b dz nb nc l nd" data-selectable-paragraph="">&lt;div id="order-preload" align="center"&gt;<br>    &lt;div &gt;Generating Invoice...&lt;/div&gt;<br>    &lt;div class="lds-dual-ring"&gt;&lt;/div&gt;<br>&lt;/div&gt;<br>&lt;div class="order-qrcode" id="order-qrcode" &gt;<br>  &lt;div id="order-details"&gt;<br>    &lt;div  align="center"&gt;<br>      &lt;div class="order-pr--number" id="order-id"&gt;&lt;/div&gt;<br>      &lt;span class="order-pr--pay" id="order-amount"&gt;&lt;/span&gt;<br>      &lt;span&gt;BTC&lt;/span&gt;<br>    &lt;/div&gt;<br>    &lt;canvas id="qr" height="500%" width="500%"  align="center"&gt;&lt;/canvas&gt;<br>    &lt;div id="lightaddress" class="order-pr--value"&gt;&lt;/div&gt;<br>    &lt;div&gt;<br>      &lt;a href="" id="order-pr--wallet" class="order-pr--wallet"&gt;Open Wallet&lt;/a&gt;<br>      &lt;a href="" id="order-pr--copy" class="order-pr--copy"&gt;Copy&lt;/a&gt;<br>    &lt;/div&gt;<br>  &lt;/div&gt;<br>  &lt;div id="order-thanks" class="order-thanks"  align="center"&gt;<br>   Thanks you for your order<br>  &lt;/div&gt;<br>&lt;/div&gt;</span></pre><p id="f96c" class="lu lv bf av lw b lx mj lz mk mb ml md mm mf mn mh" data-selectable-paragraph="">The above HTML creates a checkout experience as broken down below. Firstly we create a preloader that we use whilst we connect to the server and generate a charge.</p><pre class="kg kh ki kj kk dv gg df"><span id="c3e6" class="mo li bf av na b dz nb nc l nd" data-selectable-paragraph="">&lt;div id="order-preload" align="center"&gt;<br>    &lt;div &gt;Generating Invoice...&lt;/div&gt;<br>    &lt;div class="lds-dual-ring"&gt;&lt;/div&gt;<br>&lt;/div&gt;</span></pre><p class="lu lv bf av lw b lx mj lz mk mb ml md mm mf mn mh" data-selectable-paragraph=""> </p><p id="c57e" class="lu lv bf av lw b lx mj lz mk mb ml md mm mf mn mh" data-selectable-paragraph="">Next, we have the QR code as well as the payment address so the user can make payment.</p><pre class="kg kh ki kj kk dv gg df"><span id="8186" class="mo li bf av na b dz nb nc l nd" data-selectable-paragraph="">&lt;div class="order-qrcode" id="order-qrcode" &gt;<br>  &lt;div id="order-details"&gt;<br>    &lt;div  align="center"&gt;<br>      &lt;div class="order-pr--number" id="order-id"&gt;&lt;/div&gt;<br>      &lt;span class="order-pr--pay" id="order-amount"&gt;&lt;/span&gt;<br>      &lt;span&gt;BTC&lt;/span&gt;<br>    &lt;/div&gt;<br>    &lt;canvas id="qr" height="500%" width="500%"  align="center"&gt;&lt;/canvas&gt;<br>    &lt;div id="lightaddress" class="order-pr--value"&gt;&lt;/div&gt;<br>    &lt;div&gt;<br>      &lt;a href="" id="order-pr--wallet" class="order-pr--wallet"&gt;Open Wallet&lt;/a&gt;<br>      &lt;a href="" id="order-pr--copy" class="order-pr--copy"&gt;Copy&lt;/a&gt;<br>    &lt;/div&gt;<br>  &lt;/div&gt;</span></pre><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/17/1_CmGcDewwv1ZsoKT-J-dyQ.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/17/responsive/1_CmGcDewwv1ZsoKT-J-dyQ-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/17/responsive/1_CmGcDewwv1ZsoKT-J-dyQ-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/17/responsive/1_CmGcDewwv1ZsoKT-J-dyQ-md.png 768w ,https://cryptoskillz.com/blog/media/posts/17/responsive/1_CmGcDewwv1ZsoKT-J-dyQ-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/17/responsive/1_CmGcDewwv1ZsoKT-J-dyQ-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/17/responsive/1_CmGcDewwv1ZsoKT-J-dyQ-2xl.png 1600w" alt="" width="1070" height="1253" layout="responsive"></amp-img></figure><p id="3c3a" data-selectable-paragraph="">Lastly, we have the thank you screen once payment has been made.</p><pre class="kg kh ki kj kk dv gg df"><span id="c3d6" class="mo li bf av na b dz nb nc l nd" data-selectable-paragraph="">&lt;div id="order-thanks" class="order-thanks"  align="center"&gt;<br>   Thanks you for your order<br>  &lt;/div&gt;<br>&lt;/div&gt;</span></pre><h2 class="mo li bf av au el mp mq mr ms mt mu mv mw mx my mz" data-selectable-paragraph=""><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/17/1_UQXNAlEmUfr5c8WGd6_6zQ.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/17/responsive/1_UQXNAlEmUfr5c8WGd6_6zQ-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/17/responsive/1_UQXNAlEmUfr5c8WGd6_6zQ-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/17/responsive/1_UQXNAlEmUfr5c8WGd6_6zQ-md.png 768w ,https://cryptoskillz.com/blog/media/posts/17/responsive/1_UQXNAlEmUfr5c8WGd6_6zQ-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/17/responsive/1_UQXNAlEmUfr5c8WGd6_6zQ-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/17/responsive/1_UQXNAlEmUfr5c8WGd6_6zQ-2xl.png 1600w" alt="" width="1188" height="484" layout="responsive"></amp-img></figure></h2><h2 id="bed3" class="mo li bf av au el mp mq mr ms mt mu mv mw mx my mz" data-selectable-paragraph="">JAVASCRIPT</h2><pre class="kg kh ki kj kk dv gg df"><span id="194d" class="mo li bf av na b dz nb nc l nd" data-selectable-paragraph="">&lt;script src="<a href="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js" class="cb bx ld le lf lg" target="_blank" rel="noopener noreferrer">https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js</a>"&gt;&lt;/script&gt;</span><span id="568f" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">    &lt;script&gt;<br>//hold the checkpayment interval function<br>var checkpaymentres = "";<br>var serverurl = "<a href="http://127.0.0.1:3030/" class="cb bx ld le lf lg" target="_blank" rel="noopener noreferrer">http://127.0.0.1:3030</a>";<br>var address = "";<br>var thankstext = "Thanks for your order.  You will receive nothing.";<br>var request = new XMLHttpRequest();<br>//var server =<br>request.open(<br>  "GET",<br>  serverurl + "/strike/charge?uid=3&amp;currency=btc&amp;amount=2000&amp;desc=free btc",<br>  true<br>);<br></span><span id="69d4" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">request.onload = function() {<br>  if (request.status &gt;= 200 &amp;&amp; request.status &lt; 400) {<br>    // parse the data<br>    var data = JSON.parse(request.responseText);<br>    //debug<br>    //console.log(data.payment)<br>    lightelement = document.getElementById("lightaddress");<br>    lightelement.innerHTML = data.payment.payment_request;<br>    orderid = document.getElementById("order-id");<br>    orderid.innerHTML = "Order " + data.payment.id;<br>    var total = parseFloat(data.payment.amount) * 0.00000001;<br>    orderamount = document.getElementById("order-amount");<br>    orderamount.innerHTML = "Pay " + String(total);<br>    // builds and displays the QR code<br>    new QRious({<br>      element: document.getElementById("qr"),<br>      value: data.payment.payment_request,<br>      size: 400<br>    });<br>    preload = document.getElementById("order-preload");<br>    preload.style = "display: none";<br>    qrcode = document.getElementById("order-qrcode");<br>    qrcode.style = "display: visible";<br>    qrcode = document.getElementById("order-pr--wallet");<br>    qrcode.href = "lightning:" + data.payment.payment_request;<br>    address = data.payment.payment_request;</span><span id="5434" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">//check for payment every 10 seconds<br>    checkpaymentres = setInterval(checkPayment, 10000);<br>  }<br>};<br>request.onerror = function() {<br>  // There was a connection error of some sort<br>};<br>request.send();</span><span id="6510" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">function stopPaymentCheck() {<br>  clearInterval(checkpaymentres);<br>}</span><span id="c48d" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">function checkPayment() {<br>  //debug<br>  //console.log('check payment ticker')<br>  //var url = serverurl+"/webhook/checkpayment?address="+address+"&amp;token="+token;<br>  //var url = serverurl+"webhook/checkStrikePayment?address="+address;<br>  //debug<br>  console.log("checking for payment for address:" + address);<br>  request.open(<br>    "GET",<br>    serverurl + "/webhook/checkstrikepayment?address=" + address,<br>    true<br>  );<br>  //request.open('GET',"<a href="https://ecs.cryptoskillz.com/strike/charge?uid=3&amp;currency=btc&amp;amount=2000&amp;desc=free" class="cb bx ld le lf lg" target="_blank" rel="noopener noreferrer">https://ecs.cryptoskillz.com/strike/charge?uid=3&amp;currency=btc&amp;amount=2000&amp;desc=free</a> btc", true);<br>  //call it<br>  request.onload = function() {<br>    if (request.status &gt;= 200 &amp;&amp; request.status &lt; 400) {<br>      // parse the data<br>      var data = JSON.parse(request.responseText);<br>      //debug<br>      //console.log(data.status)</span><span id="0ac7" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">if (data.status == 1) {<br>        orderthanks = document.getElementById("order-thanks");<br>        orderthanks.style = "display: visible";<br>        orderthanks.innerHTML = thankstext;</span><span id="a14f" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">orderdetails = document.getElementById("order-details");<br>        orderdetails.style = "display: none";<br>        stopPaymentCheck();<br>      }<br>    }<br>  };<br>  request.onerror = function() {<br>    // There was a connection error of some sort<br>  };<br>  request.send();<br>}</span><span id="836c" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">document.getElementById("order-pr--copy").addEventListener("click", function() {<br>  const el = document.createElement("textarea"); // Create a &lt;textarea&gt; element<br>  el.value = address; // Set its value to the string that you want copied<br>  el.setAttribute("readonly", ""); // Make it readonly to be tamper-proof<br>  el.style.position = "absolute";<br>  el.style.left = "-9999px"; // Move outside the screen to make it invisible<br>  document.body.appendChild(el);<br>  el.select(); // Select the &lt;textarea&gt; content<br>  document.execCommand("copy"); // Copy - only works as a result of a user action (e.g. click events)<br>  document.body.removeChild(el);<br>});   <br>&lt;/script&gt;</span></pre><p id="f7cf" class="lu lv bf av lw b lx mj lz mk mb ml md mm mf mn mh" data-selectable-paragraph="">Let us take a look at this code and see what exactly is happening. The first thing we are doing is loading a QR class</p><pre class="kg kh ki kj kk dv gg df"><span id="d59f" class="mo li bf av na b dz nb nc l nd" data-selectable-paragraph="">&lt;script src="<a href="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js" class="cb bx ld le lf lg" target="_blank" rel="noopener noreferrer">https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js</a>"&gt;&lt;/script&gt;</span></pre><p id="1cad" class="lu lv bf av lw b lx mj lz mk mb ml md mm mf mn mh" data-selectable-paragraph="">Next, we are setting up some variables:</p><p id="3c5a" class="lu lv bf av lw b lx mj lz mk mb ml md mm mf mn mh" data-selectable-paragraph=""><strong class="lw mi">checkpaymentres</strong>: this is used to set the time check when we are looking for a payment.<br><strong class="lw mi">serverurl</strong>: the URL of ECS server<br><strong class="lw mi">address</strong>: the address returned from Strike for payment purposes<br><strong class="lw mi">thankstest</strong>: the text to store display once an order is complete</p><pre class="kg kh ki kj kk dv gg df"><span id="936b" class="mo li bf av na b dz nb nc l nd" data-selectable-paragraph="">//hold the checkpayment interval function<br>var checkpaymentres = "";<br>var serverurl = "<a href="http://127.0.0.1:3030/" class="cb bx ld le lf lg" target="_blank" rel="noopener noreferrer">http://127.0.0.1:3030</a>";<br>var address = "";<br>var thankstext = "Thanks for your order.  You will receive nothing.";</span></pre><p id="f415" class="lu lv bf av lw b lx mj lz mk mb ml md mm mf mn mh" data-selectable-paragraph="">Next, we make an ajax call to ECS and telling it we want to generate an invoice.</p><p id="19fc" class="lu lv bf av lw b lx mj lz mk mb ml md mm mf mn mh" data-selectable-paragraph=""><strong class="lw mi">uid</strong>: the userid we are using <br><strong class="lw mi">currency</strong>: the currency we want to create the invoice in<br><strong class="lw mi">amount</strong>: the amount in Satoshis for the invoice<br><strong class="lw mi">desc</strong>: the description of the item we are selling in the invoice</p><pre class="kg kh ki kj kk dv gg df"><span id="f74a" class="mo li bf av na b dz nb nc l nd" data-selectable-paragraph="">var request = new XMLHttpRequest();<br>//var server =<br>request.open(<br>  "GET",<br>  serverurl + "/strike/charge?uid=3&amp;currency=btc&amp;amount=2000&amp;desc=free btc",<br>  true<br>);</span></pre><p id="75bc" class="lu lv bf av lw b lx mj lz mk mb ml md mm mf mn mh" data-selectable-paragraph="">next, we wait for a response from the server and if the status is valid (between 200 and 400 we process it) we take the information from the response populate the <strong class="lw mi">payment view </strong>and display it, hide the preloader view and start the <strong class="lw mi">checkPayment</strong> timer.</p><pre class="kg kh ki kj kk dv gg df"><span id="9d3f" class="mo li bf av na b dz nb nc l nd" data-selectable-paragraph="">request.onload = function() {<br>  if (request.status &gt;= 200 &amp;&amp; request.status &lt; 400) {<br>    // parse the data<br>    var data = JSON.parse(request.responseText);<br>    lightelement = document.getElementById("lightaddress");<br>    lightelement.innerHTML = data.payment.payment_request;<br>    orderid = document.getElementById("order-id");<br>    orderid.innerHTML = "Order " + data.payment.id;<br>    var total = parseFloat(data.payment.amount) * 0.00000001;<br>    orderamount = document.getElementById("order-amount");<br>    orderamount.innerHTML = "Pay " + String(total);<br>    // builds and displays the QR code<br>    new QRious({<br>      element: document.getElementById("qr"),<br>      value: data.payment.payment_request,<br>      size: 400<br>    });<br>    preload = document.getElementById("order-preload");<br>    preload.style = "display: none";<br>    qrcode = document.getElementById("order-qrcode");<br>    qrcode.style = "display: visible";<br>    qrcode = document.getElementById("order-pr--wallet");<br>    qrcode.href = "lightning:" + data.payment.payment_request;<br>    address = data.payment.payment_request;</span><span id="7978" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">//check for payment every 10 seconds<br>    checkpaymentres = setInterval(checkPayment, 10000);<br>  }<br>};<br>request.onerror = function() {<br>  // There was a connection error of some sort<br>};<br>request.send();</span></pre><p id="7238" class="lu lv bf av lw b lx mj lz mk mb ml md mm mf mn mh" data-selectable-paragraph="">Next, we have a couple of functions <strong class="lw mi">checkPayment</strong> and <strong class="lw mi">stopPayment</strong>. <strong class="lw mi">CheckPayment</strong> calls the ECS server and checks for it payment has been made by the user every 10 seconds. Once a payment has been made then it calls shows the <strong class="lw mi">thankyou view</strong>, hides the <strong class="lw mi">payment view</strong> and stops the <strong class="lw mi">checkPayment</strong> timer.</p><pre class="kg kh ki kj kk dv gg df"><span id="7cf7" class="mo li bf av na b dz nb nc l nd" data-selectable-paragraph="">function stopPaymentCheck() <br>{<br>  clearInterval(checkpaymentres);<br>}</span><span id="e13c" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">function checkPayment() <br>{<br>  request.open(<br>    "GET",<br>    serverurl + "/webhook/checkstrikepayment?address=" + address,<br>    true<br>  );<br>  //request.open('GET',"<a href="https://ecs.cryptoskillz.com/strike/charge?uid=3&amp;currency=btc&amp;amount=2000&amp;desc=free" class="cb bx ld le lf lg" target="_blank" rel="noopener noreferrer">https://ecs.cryptoskillz.com/strike/charge?uid=3&amp;currency=btc&amp;amount=2000&amp;desc=free</a> btc", true);<br>  //call it<br>  request.onload = function() {<br>    if (request.status &gt;= 200 &amp;&amp; request.status &lt; 400) {<br>      // parse the data<br>      var data = JSON.parse(request.responseText);<br>      //debug<br>      //console.log(data.status)</span><span id="5105" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">if (data.status == 1) {<br>        orderthanks = document.getElementById("order-thanks");<br>        orderthanks.style = "display: visible";<br>        orderthanks.innerHTML = thankstext;</span><span id="5f05" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">orderdetails = document.getElementById("order-details");<br>        orderdetails.style = "display: none";<br>        stopPaymentCheck();<br>      }<br>    }<br>  };<br>  request.onerror = function() {<br>    // There was a connection error of some sort<br>  };<br>  request.send();<br>}</span></pre><p id="d352" class="lu lv bf av lw b lx mj lz mk mb ml md mm mf mn mh" data-selectable-paragraph="">lastly, we have a listener that fires when the copy href has been clicked and copies the address to the clipboard</p><pre class="kg kh ki kj kk dv gg df"><span id="9855" class="mo li bf av na b dz nb nc l nd" data-selectable-paragraph="">document.getElementById("order-pr--copy").addEventListener("click", function() {<br>  const el = document.createElement("textarea"); // Create a &lt;textarea&gt; element<br>  el.value = address; // Set its value to the string that you want copied<br>  el.setAttribute("readonly", ""); // Make it readonly to be tamper-proof<br>  el.style.position = "absolute";<br>  el.style.left = "-9999px"; // Move outside the screen to make it invisible<br>  document.body.appendChild(el);<br>  el.select(); // Select the &lt;textarea&gt; content<br>  document.execCommand("copy"); // Copy - only works as a result of a user action (e.g. click events)<br>  document.body.removeChild(el);<br>});</span></pre><h2 id="1b93" class="mo li bf av au el mp mq mr ms mt mu mv mw mx my mz" data-selectable-paragraph="">SERVER</h2><p id="3c13" class="lu lv bf av lw b lx ly lz ma mb mc md me mf mg mh" data-selectable-paragraph="">We made several changes to the server to work with the refactored database changes as mentioned above. We will not list these here, will stick to the strike changes only.</p><p id="5b42" class="lu lv bf av lw b lx mj lz mk mb ml md mm mf mn mh" data-selectable-paragraph="">The first function we added was a route to create a charge. This calls the strike helper.</p><pre class="kg kh ki kj kk dv gg df"><span id="36d0" class="mo li bf av na b dz nb nc l nd" data-selectable-paragraph="">app.get("/strike/charge", (req, res) =&gt; {<br>  res = generic.setHeaders(res);<br>  //load the back office helper<br>  let strikehelper = require('./api/helpers/strike.js').strike;<br>  let strike = new strikehelper();</span><span id="6574" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">//debug<br>  strike.charge(req,res);<br>});</span></pre><p id="07f2" class="lu lv bf av lw b lx mj lz mk mb ml md mm mf mn mh" data-selectable-paragraph="">The strike helper charge function requests a charge from strike stores in our session table with the information amount, currency etc and returns the details so an invoice can be generated.</p><pre class="kg kh ki kj kk dv gg df"><span id="097e" class="mo li bf av na b dz nb nc l nd" data-selectable-paragraph="">/*</span><span id="c0b1" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">Just as we did with BTC we started off using a 3rd party API and once we had an understanding of how things work <br>we moved onto owing the entire stack.  We are doing the exact same thing with Lightning</span><span id="2432" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">We are using the rather excellent <a href="https://strike.acinq.co/" class="cb bx ld le lf lg" target="_blank" rel="noopener noreferrer">https://strike.acinq.co</a> for this purpose.</span><span id="79d1" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">*/<br>const config = require('./config');<br>//console.log(config.bitcoin.network)</span><span id="9da7" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">//load SQLlite (use any database you want or none)<br>const sqlite3 = require("sqlite3").verbose();<br>//open a database connection<br>let db = new sqlite3.Database("./db/db.db", err =&gt; {<br>  if (err) {<br>    console.error(err.message);<br>  }<br>});</span><span id="08fb" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">var request = require("request");</span><span id="9c58" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">//note why uppercase here?<br>var strike = function ()<br>{<br> this.test = function test(req,res) <br> {</span><span id="c03e" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">res.send(JSON.stringify({ status: "ok" }));<br>     <br> }</span><span id="c7fe" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">//create a charge<br> this.charge = function charge(req,res)<br> {<br>  //build the options object<br>  var options = {<br>    method: 'POST',<br>    url: process.env.STRIKEENDPOINT + '/api/v1/charges',<br>    headers: {<br>      'cache-control': 'no-cache',<br>      'Content-Type': 'application/json' },<br>    body: {<br>      amount: parseFloat(req.query.amount),<br>      description: req.query.desc,<br>      currency: req.query.currency<br>    },<br>    json: true,<br>    auth: {<br>      user: process.env.STRIKEAPIKEY,<br>      pass: '',<br>    }<br>  };</span><span id="3f11" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">//call strike<br>  request(options, function (error, response, body) {<br>    if (error) throw new Error(error);<br>     //debug<br>     //console.log(body)</span><span id="a265" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">//turn it into a BTC amount<br>     //note : in a future update we may go ahead and store everything Satoshis. <br>     //   we could also use req.query.amount here<br>     //   we may want to store order_meta and product_meta here in the future if so we will make those generic functions<br>   var amount = parseFloat(body.amount) * 0.00000001;<br>   <br>   //insert a session<br>   db.run(<br>    `INSERT INTO sessions(address,userid,net,amount,paymenttype) VALUES(?,?,?,?,?)`,<br>    [body.payment_request, req.query.uid, process.env.LIGHTNETWORK,String(amount),2],<br>    function(err) <br>    {<br>     if (err) <br>     {<br>       //return error<br>       res.send(JSON.stringify({ error: err.message }));<br>       return;<br>     }</span><span id="84b6" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">//store the order product details <br>     db.run(<br>      `INSERT INTO order_product(address,name,price,quantity) VALUES(?,?,?,?)`,<br>      [body.payment_request,req.query.desc, String(amount),1],<br>      function(err) <br>      {<br>       if (err) <br>       {<br>         //return error<br>         res.send(JSON.stringify({ error: err.message }));<br>         return;<br>       }<br>       //store the order_payment_details <br>       db.run(<br>        `INSERT INTO order_payment_details(address,providerid,paymentobject) VALUES(?,?,?)`,<br>        [body.payment_request,2, JSON.stringify(body)],<br>        function(err) <br>        {<br>         if (err) <br>         {<br>           //return error<br>           res.send(JSON.stringify({ error: err.message }));<br>           return;<br>         }<br>         //return the required details to the front end<br>         var obj = {id:body.id,amount:body.amount,payment_request:body.payment_request}<br>         res.send(JSON.stringify({ payment: obj }));<br>         //debug<br>         //console.log(body.payment_request);<br>        }<br>       );<br>      }<br>     );<br>    }<br>   );<br>     <br>  });<br> }</span><span id="73a1" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">}<br>exports.strike = strike;</span></pre><p id="86ab" class="lu lv bf av lw b lx mj lz mk mb ml md mm mf mn mh" data-selectable-paragraph="">We added 2 functions to webhook to deal with Strike. The first check payment simply looks in the database to see if a payment has been processed and if it has it returns 1 if it has not it returns 0.</p><pre class="kg kh ki kj kk dv gg df"><span id="c250" class="mo li bf av na b dz nb nc l nd" data-selectable-paragraph="">APP.JS</span><span id="9dbb" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">app.post("/webhook/checkstrikepayment", (req, res) =&gt; {<br>  res = generic.setHeaders(res);<br>  //load the back office helper<br>  let webhookhelper = require('./api/helpers/webhook.js').webhook;<br>  let webhook = new webhookhelper();</span><span id="e1e6" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">//debug<br>  webhook.checkStrikePayment(req,res);<br>});</span><span id="d0bf" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">WEBHOOK HELPER</span><span id="0903" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">this.checkStrikePayment = function checkStrikePayment(req,res)<br> {<br>  //debug<br>  //console.log(req.body.data.payment_request)<br>  //return;<br>  let data = [1,1, req.body.data.payment_request];<br>  let sql = `UPDATE sessions SET processed = ?,swept=? WHERE address = ?`;<br>  db.run(sql, data, function(err) {<br>   //console.log(result)<br>   if (err) {<br>    res.send(JSON.stringify({ status: 0 }));<br>   }<br>   //store payment object<br>   let data = [JSON.stringify(req.body.data),req.body.data.payment_request];<br>   let sql = `UPDATE order_payment_details SET paymentresponseobject = ? WHERE address = ?`;<br>   db.run(sql, data, function(err) <br>   {<br>    if (err) {<br>     res.send(JSON.stringify({ status: 0 }));<br>    }<br>    //send emails to admin<br>    generic.sendMail(<a href="mailto:2,'cryptoskillz@protonmail.com" class="cb bx ld le lf lg" target="_blank" rel="noopener noreferrer">2,'cryptoskillz@protonmail.com</a>');</span><span id="e890" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">res.send(JSON.stringify({ status: 1 }));<br>   });<br>  });</span><span id="f390" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">}</span></pre><p id="f7fe" class="lu lv bf av lw b lx mj lz mk mb ml md mm mf mn mh" data-selectable-paragraph="">The next function waits for Strike to process payment when it does it calls this URL with the information and we update our database accordingly</p><pre class="kg kh ki kj kk dv gg df"><span id="e8a0" class="mo li bf av na b dz nb nc l nd" data-selectable-paragraph="">APP.JS</span><span id="52a5" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">app.get("/webhook/strikenotification", (req, res) =&gt; {<br>  res = generic.setHeaders(res);<br>  //load the back office helper<br>  let webhookhelper = require('./api/helpers/webhook.js').webhook;<br>  let webhook = new webhookhelper();</span><span id="8463" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">//debug<br>  webhook.strikeNotification(req,res);<br>});</span><span id="fb10" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">WEBHOOK HELPER</span><span id="0517" class="mo li bf av na b dz ne nf ng nh ni nc l nd" data-selectable-paragraph="">//recieve a payment notificaiotn from strike<br> this.strikeNotification = function strikeNotification(req,res)<br> {<br>  //todo: store the payment object     <br>  if (req.query.address != '')<br>  {<br>  let data = [1,1, req.query.address];<br>    let sql = `UPDATE sessions SET processed = ?,swept=? WHERE address = ?`;<br>    db.run(sql, data, function(err) {<br>      if (err) {<br>        return console.error(err.message);<br>      }<br>      res.send(JSON.stringify({ "status": "ok" }));<br>    });<br>   }<br> }</span></pre><h1 id="34b2" class="lh li bf av au el lj lk ll lm ln lo lp lq lr ls lt" data-selectable-paragraph="">Conclusion</h1><p id="3a75" class="lu lv bf av lw b lx ly lz ma mb mc md me mf mg mh" data-selectable-paragraph="">Now we have Integrated Lightning into our stack via a 3rd party the next logical steps are</p><ol><li id="8c88" class="lu lv bf av lw b lx mj lz mk mb ml md mm mf mn mh nr ns nt" data-selectable-paragraph="">integrate into SR.js</li><li id="8335" class="lu lv bf av lw b lx nu lz nv mb nw md nx mf ny mh nr ns nt" data-selectable-paragraph="">replace strike with our lightning node</li></ol><p id="8d02" class="lu lv bf av lw b lx mj lz mk mb ml md mm mf mn mh" data-selectable-paragraph="">We will focus on point 1 in the next tutorial and point 2 some point in the future.</p><p></p><p class="card-meta"><time datetime="2018-12-27T12:27">December 27, 2018</time></p></div></article><article class="card"><a href="https://cryptoskillz.com/blog/amp/finally-removing-globee.html"><amp-img src="https://cryptoskillz.com/blog/media/posts/16/1_8-iq0_Ls5451w2BYuO-Y_w.jpeg" alt="" srcset="https://cryptoskillz.com/blog/media/posts/16/responsive/1_8-iq0_Ls5451w2BYuO-Y_w-xs.jpeg 300w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_8-iq0_Ls5451w2BYuO-Y_w-sm.jpeg 480w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_8-iq0_Ls5451w2BYuO-Y_w-md.jpeg 768w" sizes="(max-width: 768px) 100vw, 768px" height="3240" layout="responsive" width="2592"></amp-img></a><div class="card-text"><h2><a href="https://cryptoskillz.com/blog/amp/finally-removing-globee.html">Finally removing GloBee</a></h2><p></p><h1 id="7ca0" class="lf lg bf av au el lh li lj lk ll lm ln lo lp lq lr" data-selectable-paragraph="">Introduction</h1><p id="ad64" class="ls lt bf av lu b lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">This guide aims to program a website to accept Bitcoin. In the previous tutorial, We built and configured a server to hold "<a href="https://bitcoin.org/en/download" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">Bitcoin Core</strong></a>" and our "<a href="https://ecs.cryptoskillz.com/" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">Server</strong></a>". In this part, we are going to host the "<a href="https://cryptoskillz.com/srcrypto/prod/admin/" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">Admin</strong></a>", "<a href="https://cryptoskillz.com/srcrypto/prod/www/" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">WWW</strong></a>" and "<a href="https://cryptoskillz.com/srcrypto/prod/cdn/js/sr.js" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">CDN</strong></a>" and finally replace "<a href="https://globee.com/" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">GloBee</strong></a>" so that we 100% control over the software stack. In the Bitcoin world, this is known as "<a href="https://bitcoinmagazine.com/articles/economic-sovereignty-through-bitcoin-max-keiser-and-stacy-herbert/" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">sovereignty</strong></a><strong class="lu mg">"</strong>.</p><p data-selectable-paragraph=""> </p><h1 id="ad13" class="lf lg bf av au el lh li lj lk ll lm ln lo lp lq lr" data-selectable-paragraph="">The SQL</h1><p id="78cb" class="ls lt bf av lu b lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">We made a couple of changes to the SQL this time around. Firstly, the product table was changed, we removed the email field as we have a new table to hold all of the metadata.</p><pre class="ke kf kg kh ki dv ge df"><span id="f2cc" class="mh lg bf av mi b dz mj mk l ml" data-selectable-paragraph="">CREATE TABLE `product` (<br> `id` INTEGER PRIMARY KEY AUTOINCREMENT,<br> `address` TEXT,<br> `name` TEXT,<br> `price` TEXT,<br> `quantity` INTEGER<br>);</span></pre><p id="2fc8" class="ls lt bf av lu b lv mm lx mn lz mo mb mp md mq mf" data-selectable-paragraph="">We created a new table called order_meta this has been designed to hold all the order details. Seeing as we added Billing and Shipping address and we envisage there will be more fields added in the future we did not want to have to update the server and CDN everytime a new field was added. This we just add the class sr-input to the field in "<a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/blob/master/cdn/theme/cart.html" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">cart.html</strong></a>" and it will automatically be added to this table.</p><pre class="ke kf kg kh ki dv ge df"><span id="5a40" class="mh lg bf av mi b dz mj mk l ml" data-selectable-paragraph="">CREATE TABLE `order_meta` (<br> `id` INTEGER PRIMARY KEY AUTOINCREMENT,<br> `productid` INTEGER,<br> `metaname` TEXT,<br> `metavalue` TEXT<br>);</span></pre><h1 id="3656" class="lf lg bf av au el lh li lj lk ll lm ln lo lp lq lr" data-selectable-paragraph="">Code sections</h1><p id="74d1" class="ls lt bf av lu b lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">The code for this release can be found "<a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/tree/part14-replace-globee-2" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">here</strong></a>".</p><h2 id="7f06" class="mh lg bf av au el mr ms mt mu mv mw mx my mz na nb" data-selectable-paragraph=""><a href="https://cryptoskillz.com/srcrypto/prod/www/" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer">WWW</a></h2><p id="f7ef" class="ls lt bf av lu b lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">We made significant changes to this section. Firstly we purchased a "<a href="https://bootstrapious.com/p/single-product" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">theme</strong></a>" so that it now looks like a webpage rather than a just a hyperlink as it was before. There was a lot of stuff in this template we removed, cryptoskillz like things super clean. <br>*note: if you want to use this WWW as is please do purchase the template it is only $10 and it has been very well done.</p><p id="984a" class="ls lt bf av lu b lv mm lx mn lz mo mb mp md mq mf" data-selectable-paragraph="">You can check this theme out (shown below) by clicking "<a href="https://cryptoskillz.com/srcrypto/prod/www/" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">here</strong></a><strong class="lu mg">"</strong></p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/16/1_GPJxzhdUASHLCRGKBFe9Zw.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/16/responsive/1_GPJxzhdUASHLCRGKBFe9Zw-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_GPJxzhdUASHLCRGKBFe9Zw-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_GPJxzhdUASHLCRGKBFe9Zw-md.png 768w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_GPJxzhdUASHLCRGKBFe9Zw-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_GPJxzhdUASHLCRGKBFe9Zw-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_GPJxzhdUASHLCRGKBFe9Zw-2xl.png 1600w" alt="" width="2460" height="1110" layout="responsive"></amp-img></figure><p id="e6ab" class="ls lt bf av lu b lv mm lx mn lz mo mb mp md mq mf" data-selectable-paragraph="">Note* As you can see there is a size dropdown, this does not work yet this will come when we do the next update to the CDN.</p><h2 id="9259" class="mh lg bf av au el mr ms mt mu mv mw mx my mz na nb" data-selectable-paragraph=""><a href="https://cryptoskillz.com/srcrypto/prod/cdn/js/sr.js" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer">CDN</a></h2><p id="8e19" class="ls lt bf av lu b lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">The majority of the time (code wise) was spent in the "<a href="https://cryptoskillz.com/srcrypto/prod/cdn/js/sr.js" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer"><strong class="lu mg">CDN</strong></a>" section. We refactored the CSS to make sure it would not break on any site it was injected into. We also added billing and shipping inputs which can be invoked during the initialisation as shown below.</p><p id="2b9b" class="ls lt bf av lu b lv mm lx mn lz mo mb mp md mq mf" data-selectable-paragraph="">*note the start country will set the country drop down to that country.</p><pre class="ke kf kg kh ki dv ge df"><span id="cf08" class="mh lg bf av mi b dz mj mk l ml" data-selectable-paragraph="">&lt;script type="text/javascript"&gt;<br>  /*<br>    0 = server url<br>    1 = animated<br>    2 = quantity count<br>    3 = cdn url<br>    4 = uid<br>    5 = theme<br>    6 = billing address <br>    7 = shipping address<br>    8 = start country<br>  */<br><br>SR.init([<br>  "<a href="http://127.0.0.1:3000/" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer">http://127.0.0.1:3000/</a>",<br>  false,<br>  15,<br>  "<a href="http://127.0.0.1:8080/cdn/" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer">http://127.0.0.1:8080/cdn/</a>",<br>  "3",<br>  "",<br>  1,<br>  1,<br>  "GB"<br>]);   <br>&lt;/script&gt;</span></pre><p id="0a49" class="ls lt bf av lu b lv mm lx mn lz mo mb mp md mq mf" data-selectable-paragraph="">The screenshot below shows the cart with the first item being added to it.</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/16/1_rClP3DReIcxF2kvW6NVKWw.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/16/responsive/1_rClP3DReIcxF2kvW6NVKWw-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_rClP3DReIcxF2kvW6NVKWw-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_rClP3DReIcxF2kvW6NVKWw-md.png 768w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_rClP3DReIcxF2kvW6NVKWw-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_rClP3DReIcxF2kvW6NVKWw-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_rClP3DReIcxF2kvW6NVKWw-2xl.png 1600w" alt="" width="2408" height="1296" layout="responsive"></amp-img></figure><p id="6789" class="ls lt bf av lu b lv mm lx mn lz mo mb mp md mq mf" data-selectable-paragraph="">Then when you click checkout you will see the new billing address UX.</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/16/1_Pg96-tZFNQ1u5I_QQdJ2PA.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/16/responsive/1_Pg96-tZFNQ1u5I_QQdJ2PA-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_Pg96-tZFNQ1u5I_QQdJ2PA-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_Pg96-tZFNQ1u5I_QQdJ2PA-md.png 768w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_Pg96-tZFNQ1u5I_QQdJ2PA-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_Pg96-tZFNQ1u5I_QQdJ2PA-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_Pg96-tZFNQ1u5I_QQdJ2PA-2xl.png 1600w" alt="" width="2423" height="1276" layout="responsive"></amp-img></figure><p id="da50" class="ls lt bf av lu b lv mm lx mn lz mo mb mp md mq mf" data-selectable-paragraph="">If you untick the "Billing &amp; Shipping the same" you will see that the pay button changes to shipping.</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/16/1_BTL3dHiaK9HXy9UXqFkDQw.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/16/responsive/1_BTL3dHiaK9HXy9UXqFkDQw-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_BTL3dHiaK9HXy9UXqFkDQw-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_BTL3dHiaK9HXy9UXqFkDQw-md.png 768w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_BTL3dHiaK9HXy9UXqFkDQw-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_BTL3dHiaK9HXy9UXqFkDQw-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_BTL3dHiaK9HXy9UXqFkDQw-2xl.png 1600w" alt="" width="2430" height="1285" layout="responsive"></amp-img></figure><p id="90b0" class="ls lt bf av lu b lv mm lx mn lz mo mb mp md mq mf" data-selectable-paragraph="">if you click this it will show the shipping address UX and the pay button</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/16/1_nbaYNo-30iVHzLQcpnPBhA.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/16/responsive/1_nbaYNo-30iVHzLQcpnPBhA-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_nbaYNo-30iVHzLQcpnPBhA-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_nbaYNo-30iVHzLQcpnPBhA-md.png 768w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_nbaYNo-30iVHzLQcpnPBhA-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_nbaYNo-30iVHzLQcpnPBhA-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_nbaYNo-30iVHzLQcpnPBhA-2xl.png 1600w" alt="" width="2471" height="1284" layout="responsive"></amp-img></figure><p id="33e1" class="ls lt bf av lu b lv mm lx mn lz mo mb mp md mq mf" data-selectable-paragraph="">Once the pay button has been clicked you will see the standard pay screen. We fixed the bugs on the screen but did not do anything else.</p><figure class="post__image"><amp-img src="https://cryptoskillz.com/blog/media/posts/16/1_qExoFNJ5Qb1bHwB5JGh_Hg.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://cryptoskillz.com/blog/media/posts/16/responsive/1_qExoFNJ5Qb1bHwB5JGh_Hg-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_qExoFNJ5Qb1bHwB5JGh_Hg-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_qExoFNJ5Qb1bHwB5JGh_Hg-md.png 768w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_qExoFNJ5Qb1bHwB5JGh_Hg-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_qExoFNJ5Qb1bHwB5JGh_Hg-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/16/responsive/1_qExoFNJ5Qb1bHwB5JGh_Hg-2xl.png 1600w" alt="" width="2506" height="1285" layout="responsive"></amp-img></figure><p id="24cc" class="ls lt bf av lu b lv mm lx mn lz mo mb mp md mq mf" data-selectable-paragraph="">We plan to add a bunch of functionality to the CDN to make this really useful. We have decades of experience shopping cart checkout experience that we will be applying directly to this.</p><h2 id="25e4" class="mh lg bf av au el mr ms mt mu mv mw mx my mz na nb" data-selectable-paragraph=""><a href="https://ecs.cryptoskillz.com/" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer">Server</a></h2><p id="b002" class="ls lt bf av lu b lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">We made a small change to the server that allows us to store the metadata. It simply takes the request object and stores all of the data in the order_meta table.</p><pre class="ke kf kg kh ki dv ge df"><span id="da36" class="mh lg bf av mi b dz mj mk l ml" data-selectable-paragraph="">this.storeUserDetails = function storeUserDetails(req,res)<br>  {<br>    let data = [req.query.address];<br>    //console.log(data)<br>    let sql = `SELECT * FROM product where address = "`+req.query.address+`"`;<br>    //debug</span><span id="4e62" class="mh lg bf av mi b dz no np nq nr ns mk l ml" data-selectable-paragraph="">db.get(sql, [], (err, result) =&gt; {<br>      console.log(result)<br>      if (err) {<br>        console.log(err)<br>      }<br>      let data = [result.id];<br>      let sql = `delete FROM order_meta WHERE productid = ?`;<br>      db.run(sql, data, function(err) {<br>        if (err) {<br>          return console.error(err.message);<br>        }<br>        for (var metaname in req.query) <br>        {<br>            if (req.query.hasOwnProperty(metaname)) <br>            {<br>                var metavalue = req.query[metaname]<br>                metaname = metaname.replace("sr-", "");</span><span id="69f6" class="mh lg bf av mi b dz no np nq nr ns mk l ml" data-selectable-paragraph="">db.run(<br>                `INSERT INTO order_meta(productid,metaname,metavalue) VALUES(?,?,?)`,<br>                [<br>                  result.id,<br>                  metaname,<br>                  metavalue<br>                ],<br>                function(err) {<br>                  if (err) {<br>                    return console.log(err.message);<br>                  }<br>                }<br>              );<br>              //debug<br>              //console.log(metaname, metavalue);<br>            }<br>        }<br>        res.send(JSON.stringify({ status: "ok" }));<br>        });<br>    });<br>  }</span></pre><h2 id="5a8c" class="mh lg bf av au el mr ms mt mu mv mw mx my mz na nb" data-selectable-paragraph=""><a href="https://cryptoskillz.com/srcrypto/prod/admin/" class="cb bx lb lc ld le" target="_blank" rel="noopener noreferrer">Admin</a></h2><p id="72aa" class="ls lt bf av lu b lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">No changes were made to the admin this time, though we may want to display the order metadata in the admin so an update will be required in future</p><h1 id="541d" class="lf lg bf av au el lh li lj lk ll lm ln lo lp lq lr" data-selectable-paragraph="">Testing</h1><p id="48b8" class="ls lt bf av lu b lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">I will not run through all the testing again as we covered it fully in this "<a class="cb bx lb lc ld le" target="_blank" href="https://medium.com/bitcoin-e-commerce-development/part-12-backoffice-and-server-refactor-45dbc05dcebb" rel="noopener noreferrer"><strong class="lu mg">tutorial</strong></a>".</p><p data-selectable-paragraph=""> </p><h1 id="dc7b" class="lf lg bf av au el lh li lj lk ll lm ln lo lp lq lr" data-selectable-paragraph="">Conclusion</h1><p id="548b" class="ls lt bf av lu b lv lw lx ly lz ma mb mc md me mf" data-selectable-paragraph="">Now we have a fully working Bitcoin core, server and CDN to inject it easily into any site. This pretty much covers everything we set out to do. The next tutorial will deal be a usage/installation guide which will be a condensed version of all these tutorials into a single document for people who do not care how it was built and just want to install and use it.</p><p id="f923" class="ls lt bf av lu b lv mm lx mn lz mo mb mp md mq mf" data-selectable-paragraph="">Also, seeing as we have completed all the tasks we have set out to do we may not (after the next one) do any more tutorial parts and instead, use another format such as a monthly update guide with normal git push to cover everything else.</p><p id="d3f1" class="ls lt bf av lu b lv mm lx mn lz mo mb mp md mq mf" data-selectable-paragraph="">Of course, we will most likely do some accompanying tutorials when we decided to add lighting, other cryptos, elements and whatever cool tech surfaces in the future.</p><p></p><p class="card-meta"><time datetime="2018-12-04T12:25">December 4, 2018</time></p></div></article><article class="card"><a href="https://cryptoskillz.com/blog/amp/working-with-fullnodes-part-3.html"><amp-img src="https://cryptoskillz.com/blog/media/posts/15/1_nY1L26Pnm4pyiBRaVkcy3A.jpeg" alt="" srcset="https://cryptoskillz.com/blog/media/posts/15/responsive/1_nY1L26Pnm4pyiBRaVkcy3A-xs.jpeg 300w ,https://cryptoskillz.com/blog/media/posts/15/responsive/1_nY1L26Pnm4pyiBRaVkcy3A-sm.jpeg 480w ,https://cryptoskillz.com/blog/media/posts/15/responsive/1_nY1L26Pnm4pyiBRaVkcy3A-md.jpeg 768w" sizes="(max-width: 768px) 100vw, 768px" height="2494" layout="responsive" width="4000"></amp-img></a><div class="card-text"><h2><a href="https://cryptoskillz.com/blog/amp/working-with-fullnodes-part-3.html">Working with Fullnodes part 3</a></h2><p>IntroductionThis guide aims to program a website to accept Bitcoin. In the previous tutorial, we rebuilt the server component and the back office functionality. At the end of the tutorial, we said we would be replacing "Globee" which we currently use to sell our Open&hellip;</p><p class="card-meta"><time datetime="2018-11-30T12:24">November 30, 2018</time></p></div></article><article class="card"><a href="https://cryptoskillz.com/blog/amp/backoffice-and-server-refactor.html"><amp-img src="https://cryptoskillz.com/blog/media/posts/14/1_sO7jBrNOVBwbvvfbdkvetg.jpeg" alt="" srcset="https://cryptoskillz.com/blog/media/posts/14/responsive/1_sO7jBrNOVBwbvvfbdkvetg-xs.jpeg 300w ,https://cryptoskillz.com/blog/media/posts/14/responsive/1_sO7jBrNOVBwbvvfbdkvetg-sm.jpeg 480w ,https://cryptoskillz.com/blog/media/posts/14/responsive/1_sO7jBrNOVBwbvvfbdkvetg-md.jpeg 768w" sizes="(max-width: 768px) 100vw, 768px" height="4592" layout="responsive" width="3061"></amp-img></a><div class="card-text"><h2><a href="https://cryptoskillz.com/blog/amp/backoffice-and-server-refactor.html">Backoffice and server refactor</a></h2><p>IntroductionThis guide aims to program a website to accept Bitcoin. In the last tutorial ("part 11"), we re-coded the way we generated and stored or cold storage generated addresses. In this part, we are going to put in place the framework to deal with the&hellip;</p><p class="card-meta"><time datetime="2018-11-09T12:22">November 9, 2018</time></p></div></article><article class="card"><a href="https://cryptoskillz.com/blog/amp/refactor-of-cold-storage.html"><amp-img src="https://cryptoskillz.com/blog/media/posts/13/1_WONtgVhW3k0iM4sR9DZ1VA.jpeg" alt="" srcset="https://cryptoskillz.com/blog/media/posts/13/responsive/1_WONtgVhW3k0iM4sR9DZ1VA-xs.jpeg 300w ,https://cryptoskillz.com/blog/media/posts/13/responsive/1_WONtgVhW3k0iM4sR9DZ1VA-sm.jpeg 480w ,https://cryptoskillz.com/blog/media/posts/13/responsive/1_WONtgVhW3k0iM4sR9DZ1VA-md.jpeg 768w" sizes="(max-width: 768px) 100vw, 768px" height="2669" layout="responsive" width="4000"></amp-img></a><div class="card-text"><h2><a href="https://cryptoskillz.com/blog/amp/refactor-of-cold-storage.html">Refactor of cold storage</a></h2><p>This guide aims to program a website to accept Bitcoin. In the last tutorial ("part 10"), we deep dived address generation and went to quite a bit of theory this leads us to realise that our cold storage solution was entirely inadequate and hence&hellip;</p><p class="card-meta"><time datetime="2018-11-02T12:16">November 2, 2018</time></p></div></article><nav class="pagination wrap-inner"><a href="https://cryptoskillz.com/blog/amp/authors/cryptoskillz/page/3/" class="btn btn-outline">Previous</a> <a href="https://cryptoskillz.com/blog/amp/authors/cryptoskillz/" class="btn btn-outline pagination-right">Next</a></nav></main><amp-animation id="showAnim" layout="nodisplay"><script type="application/json">{
                    "duration": "200ms",
                    "fill": "both",
                    "iterations": "1",
                    "direction": "alternate",
                    "animations": [{
                        "selector": ".post-scroll",
                        "keyframes": [{
                            "opacity": "1",
                            "visibility": "visible",
                            "transform": "scale(1)"
                        }]
                    }]
                }</script></amp-animation><amp-animation id="hideAnim" layout="nodisplay"><script type="application/json">{
                    "duration": "200ms",
                    "fill": "both",
                    "iterations": "1",
                    "direction": "alternate",
                    "animations": [{
                        "selector": ".post-scroll",
                        "keyframes": [{
                            "opacity": "0",
                            "visibility": "hidden",
                            "transform": "scale(0.1)"
                        }]
                    }]
                }</script></amp-animation><div class="post-scroll-marker"><amp-position-observer on="enter:hideAnim.start; exit:showAnim.start" layout="nodisplay"></amp-position-observer></div><button class="post-scroll" on="tap:top.scrollTo(duration=200)">&#8593;</button><footer class="bottom">Powered by Publii</footer><amp-sidebar id="navbar-sidebar" layout="nodisplay"><ul><li><a href="https://cryptoskillz.com/index.html">ECS</a></li><li><a href="https://cryptoskillz.com/blox.html">BLOX</a></li><li><a href="https://cryptoskillz.com/about.html">ABOUT</a></li></ul></amp-sidebar><amp-analytics type="googleanalytics" id="analytics1"><script type="application/json">{
            "vars": {
                "account": "ca-pub-4710117865976591"
            },
            "triggers": {
                "trackPageview": {
                    "on": "visible",
                    "request": "pageview"
                }
            }
        }</script></amp-analytics></body></html>