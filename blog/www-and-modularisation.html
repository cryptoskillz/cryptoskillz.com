<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>WWW and modularisation - cryptoskillz</title><meta name="description" content="ECS (e-commerce software) is an open source Bitcoin e-commerce server. It comes with a Javascript e-commerce injector a REST server and an admin control panel. "><meta name="robots" content="index, follow"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://cryptoskillz.com/blog/www-and-modularisation.html"><link rel="amphtml" href="https://cryptoskillz.com/blog/amp/www-and-modularisation.html"><link rel="alternate" type="application/atom+xml" href="https://cryptoskillz.com/blog/feed.xml"><link rel="alternate" type="application/json" href="https://cryptoskillz.com/blog/feed.json"><meta property="og:title" content="WWW and modularisation"><meta property="og:image" content="https://cryptoskillz.com/blog/media/website/logo.png"><meta property="og:site_name" content="cryptoskillz"><meta property="og:description" content="ECS (e-commerce software) is an open source Bitcoin e-commerce server. It comes with a Javascript e-commerce injector a REST server and an admin control panel. "><meta property="og:url" content="https://cryptoskillz.com/blog/www-and-modularisation.html"><meta property="og:type" content="article"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><style>h1,h2,h3,h4,h5,h6,.btn,[type=button],[type=submit],button,.navbar .navbar__menu li,.navbar_mobile_sidebar .navbar__menu li,.feed__author,.post__tag,.post__share>a span,.post__nav-link>span,.footer{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}body,h1,.h1,blockquote,.search__input,.author__name,.author__info>p,.feed__item h2,.post__nav-link{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}</style><link rel="stylesheet" href="https://cryptoskillz.com/blog/assets/css/style.css?v=58acac63961d23abccded091eaca6989"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://cryptoskillz.com/blog/www-and-modularisation.html"},"headline":"WWW and modularisation","datePublished":"2019-09-20T11:36","dateModified":"2019-09-20T11:36","image":{"@type":"ImageObject","url":"https://cryptoskillz.com/blog/media/website/logo.png","height":178,"width":685},"description":"<figure class=\"post__image\"><img  src=\"https://cryptoskillz.com/blog/media/posts/7/1_KOjqZHotBNn9-PIMA9XTHQ.jpeg\" sizes=\"(max-width: 48em) 100vw, 768px\" srcset=\"https://cryptoskillz.com/blog/media/posts/7/responsive/1_KOjqZHotBNn9-PIMA9XTHQ-xs.jpeg 300w ,https://cryptoskillz.com/blog/media/posts/7/responsive/1_KOjqZHotBNn9-PIMA9XTHQ-sm.jpeg 480w ,https://cryptoskillz.com/blog/media/posts/7/responsive/1_KOjqZHotBNn9-PIMA9XTHQ-md.jpeg 768w ,https://cryptoskillz.com/blog/media/posts/7/responsive/1_KOjqZHotBNn9-PIMA9XTHQ-lg.jpeg 1024w ,https://cryptoskillz.com/blog/media/posts/7/responsive/1_KOjqZHotBNn9-PIMA9XTHQ-xl.jpeg 1360w ,https://cryptoskillz.com/blog/media/posts/7/responsive/1_KOjqZHotBNn9-PIMA9XTHQ-2xl.jpeg 1600w\"  alt=\"\" width=\"638\" height=\"478\"></figure>\n<p> </p>\n","author":{"@type":"Person","name":"cryptoskillz"},"publisher":{"@type":"Organization","name":"cryptoskillz","logo":{"@type":"ImageObject","url":"https://cryptoskillz.com/blog/media/website/logo.png","height":178,"width":685}}}</script><script src="https://cryptoskillz.com/blog/assets/js/ls.parent-fit.min.js?v=1c78585e2a70398fe95085061942fd37"></script><script async src="https://cryptoskillz.com/blog/assets/js/lazysizes.min.js?v=149ff45fc6c2f13e892e438a58abb77f"></script><script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
google_ad_client: "ca-pub-4710117865976591",
enable_page_level_ads: true
});</script></head><body><div class="site-container"><header class="top" id="js-header"><a class="logo" href="https://cryptoskillz.com/blog/"><img src="https://cryptoskillz.com/blog/media/website/logo.png" alt="cryptoskillz"></a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://cryptoskillz.com/index.html" target="_self">ECS</a></li><li><a href="https://cryptoskillz.com/blox.html" target="_self">BLOX</a></li><li><a href="https://cryptoskillz.com/about.html" target="_self">ABOUT</a></li><li class="has-submenu"><a href="https://cryptoskillz.com/blog/ecs/" target="_self" aria-haspopup="true">BLOG</a><ul class="navbar__submenu level-2" aria-hidden="true"><li><a href="https://cryptoskillz.com/blog/ecs/" target="_self">ECS</a></li><li><a href="https://cryptoskillz.com/blog/fullnode/" target="_self">FULLNODE</a></li><li><a href="https://cryptoskillz.com/blog/cyphernode/" target="_self">CYPHERNODE</a></li></ul></li></ul></nav></header><main><article class="post"><div class="hero"><header class="hero__content"><div class="wrapper"><div class="post__meta"><time datetime="2019-09-20T11:36">September 20, 2019</time></div><h1>WWW and modularisation</h1></div></header></div><div class="wrapper post__entry"><figure class="post__image"><img class="lazyload" data-src="https://cryptoskillz.com/blog/media/posts/7/1_KOjqZHotBNn9-PIMA9XTHQ.jpeg" data-sizes="auto" data-srcset="https://cryptoskillz.com/blog/media/posts/7/responsive/1_KOjqZHotBNn9-PIMA9XTHQ-xs.jpeg 300w ,https://cryptoskillz.com/blog/media/posts/7/responsive/1_KOjqZHotBNn9-PIMA9XTHQ-sm.jpeg 480w ,https://cryptoskillz.com/blog/media/posts/7/responsive/1_KOjqZHotBNn9-PIMA9XTHQ-md.jpeg 768w ,https://cryptoskillz.com/blog/media/posts/7/responsive/1_KOjqZHotBNn9-PIMA9XTHQ-lg.jpeg 1024w ,https://cryptoskillz.com/blog/media/posts/7/responsive/1_KOjqZHotBNn9-PIMA9XTHQ-xl.jpeg 1360w ,https://cryptoskillz.com/blog/media/posts/7/responsive/1_KOjqZHotBNn9-PIMA9XTHQ-2xl.jpeg 1600w" alt="" data-aspectratio="1.334728" width="638" height="478"></figure><p> </p><h1 id="40c8" class="ku kv bf av au el kw kx ky kz la lb lc ld le lf lg" data-selectable-paragraph="">Introduction</h1><p id="dfde" class="lh li bf av lj b lk ll lm ln lo lp lq lr ls lt lu" data-selectable-paragraph="">This guide aims to program a website to accept Bitcoin. In the previous part, we coded "<strong class="lj lz"><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/blob/www/server/sweep.js" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">sweep.js</a>"</strong> which allowed us to move payments to our cold storage.</p><p id="d59d" class="lh li bf av lj b lk ma lm mb lo mc lq md ls me lu" data-selectable-paragraph="">In this section, we are going to modularise the code (a little) and create a "<a href="http://s3-eu-west-1.amazonaws.com/srcrypto/demo/index.html" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer"><strong class="lj lz">WWW</strong></a>" page to allow us to sell something and accept "<strong class="lj lz"><a href="https://en.wikipedia.org/wiki/Bitcoin" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">Bitcoin</a>"</strong> as payment, yay.</p><p id="7977" class="lh li bf av lj b lk ma lm mb lo mc lq md ls me lu" data-selectable-paragraph="">The branch for this tutorial can be found "<strong><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/tree/www" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">here</a></strong>".</p><h1 id="bedb" class="ku kv bf av au el kw kx ky kz la lb lc ld le lf lg" data-selectable-paragraph="">The Modularisation</h1><p id="da7f" class="lh li bf av lj b lk ll lm ln lo lp lq lr ls lt lu" data-selectable-paragraph="">If you look at the code you will see it has been broken down into 3 sections.</p><h2 id="2a53" class="mf kv bf av au el mg mh mi mj mk ml mm mn mo mp mq" data-selectable-paragraph=""><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/tree/www/server" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer"><strong class="ch">Server</strong></a></h2><p id="c8de" class="lh li bf av lj b lk ll lm ln lo lp lq lr ls lt lu" data-selectable-paragraph="">Basically, all the "<strong class="lj lz"><a href="https://nodejs.org/en/" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">Node.js</a>"</strong> code we have written has been moved into the server directory. On top of this, there has been a number of changes have been made to make the code flow better.</p><p id="e5ba" class="lh li bf av lj b lk ma lm mb lo mc lq md ls me lu" data-selectable-paragraph=""><strong class="lj lz">“monitor.js”</strong> and “<strong class="lj lz">generate.js</strong>” have been combined into one file "<strong class="lj lz"><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/blob/www/server/index.js" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">index.js</a>"</strong>.</p><p id="e55f" class="lh li bf av lj b lk ma lm mb lo mc lq md ls me lu" data-selectable-paragraph="">Note the "<strong class="lj lz"><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/blob/www/server/monitor.js" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">monitor.js</a>"</strong> is still there but it has been changed to function as a back-end tool. Imagine the scenario where the user pays for something in the website ("<strong class="lj lz"><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/tree/www/www" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">WWW</a>"</strong>) they are not likely to leave the webpage open until the transaction confirms (though they may) so that is why we have the 2 ways of checking for a payment. Api/monitor (in "<strong class="lj lz"><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/blob/www/server/index.js" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">index.js</a>"</strong>) is meant for the website to check for the payment and "<strong class="lj lz"><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/blob/www/server/monitor.js" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">monitor.js</a>"</strong> has been designed to be used as a back office tool that will check for payment on a schedule and call the back office task as appropriate.</p><pre class="mr ms mt mu mv dv ge df"><span id="8944" class="mf kv bf av mw b dz mx my l mz" data-selectable-paragraph="">//pass it an address and it will check if payment has been made.  See this just like monitor js does but it is not on a timer.<br>app.get('/api/monitor', (req, res) =&gt; {<br>})</span><span id="d3bd" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">//generate an address and output it<br>app.get('/api/address', (req, res) =&gt; {<br>})</span></pre><p id="1314" class="lh li bf av lj b lk ma lm mb lo mc lq md ls me lu" data-selectable-paragraph=""><span class="lj lz">"<a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/blob/www/server/sweep.js" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer" style="font-weight: bold;">sweep.js</a>"</span> is unchanged at this point. In a later tutorial, we will add an admin and wrap this into to allow a back office administrator to sweep payments.</p><h2 id="d1d4" class="mf kv bf av au el mg mh mi mj mk ml mm mn mo mp mq" data-selectable-paragraph=""><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/tree/master/cdn" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">CDN</a></h2><p id="5c22" class="lh li bf av lj b lk ll lm ln lo lp lq lr ls lt lu" data-selectable-paragraph="">The "<strong class="lj lz"><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/tree/master/cdn" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">CDN</a>"</strong> folder contains all of the javascript that is required to generate a cart and process a payment. This has been referenced directly by "<strong class="lj lz"><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/blob/www/www/" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">WWW</a>"</strong> via "<a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/blob/www/www/index.html" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer"><strong class="lj lz">index.</strong></a><strong class="lj lz">html"</strong> however in the future we will recode this so it can be injected into any site with one line of code from a "<strong class="lj lz"><a href="https://en.wikipedia.org/wiki/Content_delivery_network" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">CDN</a>"</strong></p><p id="baf3" class="lh li bf av lj b lk ma lm mb lo mc lq md ls me lu" data-selectable-paragraph="">It has been coded in jQuery (as most people know this) but later it will be recoded as pure javascript so it deploys into websites with zero friction. You can grab this file ("<strong class="lj lz"><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/blob/www/cdn/js/sr.js" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">sr.js</a>"</strong>) and put in your local assets directory and access it this ay if you prefer.</p><p id="e37d" class="lh li bf av lj b lk ma lm mb lo mc lq md ls me lu" data-selectable-paragraph="">I will not go into detail of what each of these functions is doing as it is quite a simple piece of Javascript and fully documented. However in the future when we do the upgrades proposed above then we will break it down in detail.</p><pre class="mr ms mt mu mv dv ge df"><span id="f3cd" class="mf kv bf av mw b dz mx my l mz" data-selectable-paragraph="">jQuery(document).ready(function($) {<br>  //set the server url.<br>  var serverurl = "<a href="http://127.0.0.1:3000/" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">http://127.0.0.1:3000/</a>";<br>  //set the address<br>  var address = "";<br>  //init price var<br>  var productPrice = 0;<br>  var cartWrapper = $(".cd-cart-container");<br>  //set the cart wrapper<br>  var productCustomization = $(".cd-customization"),<br>    //set the cart<br>    cart = $(".cd-cart"),<br>    //set animating boolean<br>    animating = false;</span><span id="2fcd" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">//call the server to get a btc address<br>  $.get(serverurl + "api/address", function(data) {<br>    //get the data<br>    data = jQuery.parseJSON(data);<br>    //console.log(data.address);<br>    address = data.address;<br>    //set the address<br>    $("#bitcoinaddress").text(address);<br>    //set the href of the bitcoin address<br>    $("#bitcoinaddress").attr("href", "bitcoin:" + address);<br>    //generate the qr code<br>    $("#bitcoinqrcode").attr(<br>      "src",<br>      "<a href="https://chart.googleapis.com/chart?chs=250x250&amp;cht=qr&amp;chl=" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">https://chart.googleapis.com/chart?chs=250x250&amp;cht=qr&amp;chl=</a>" + address<br>    );<br>    //init the product<br>  });</span><span id="2ff8" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">initCustomization(productCustomization);</span><span id="d85b" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">//check we have a cart<br>  if (cartWrapper.length &gt; 0) {<br>    //store jQuery objects for later use<br>    var cartBody = cartWrapper.find(".body");<br>    var cartList = cartBody.find("ul").eq(0);<br>    var cartTotal = cartWrapper.find(".checkout").find("span");<br>    //console.log(cartTotal);<br>    var cartTrigger = cartWrapper.children(".cd-cart-trigger");<br>    var cartCount = cartTrigger.children(".count");<br>    var addToCartBtn = $(".sr-add-to-cart");<br>    var bitcoinback = cartWrapper.find(".bitcoinback");</span><span id="2ba2" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">//add product to cart<br>    addToCartBtn.on("click", function(event) {<br>      event.preventDefault();<br>      addToCart($(this));<br>    });</span><span id="3c1e" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">//open/close cart<br>    cartTrigger.on("click", function(event) {<br>      event.preventDefault();<br>      toggleCart();<br>    });</span><span id="5fe2" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">//close cart when clicking on the .cd-cart-container::before (bg layer)<br>    cartWrapper.on("click", function(event) {<br>      if ($(event.target).is($(this))) toggleCart(true);<br>    });</span><span id="5231" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">//delete an item from the cart<br>    cartList.on("click", ".delete-item", function(event) {<br>      event.preventDefault();<br>      //remove the product<br>      removeProduct($(event.target).parents(".product"));<br>    });</span><span id="7162" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">//load btc address for payment<br>    cartWrapper.on("click", ".checkout", function(event) {<br>      event.preventDefault();<br>      bitcoinback.addClass("visible");<br>      ///$('#bitcoin-address-template').show();<br>      $("#bitcoinaddresswrapper").show();<br>      //hide the cart items<br>      $("#cartlistitems").hide();<br>    });</span><span id="1bfd" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">//copy the btc address to the clipboard<br>    cartWrapper.on("click", ".bitcoinaddresscopy", function(event) {<br>      event.preventDefault();<br>      /* Get the text field */<br>      var element = document.getElementById("bitcoinaddress");<br>      var $temp = $("&lt;input&gt;");<br>      $("body").append($temp);<br>      $temp.val($(element).text()).select();<br>      document.execCommand("copy");<br>      //$temp.remove();<br>    });</span><span id="3f43" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">//back button is clicked so show items<br>    cartWrapper.on("click", "#checkoutbitocoin", function(event) {<br>      event.preventDefault();<br>      bitcoinback.removeClass("visible");<br>      $("#bitcoinaddresswrapper").hide();<br>      //$('#bitcoin-address-template').hide();<br>      $("#cartlistitems").show();<br>    });<br>  }</span><span id="acb0" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">function initCustomization(items) {<br>    items.each(function() {<br>      var actual = $(this),<br>        selectOptions = actual.find('[data-type="select"]'),<br>        addToCartBtn = actual.find(".sr-add-to-cart"),<br>        touchSettings = actual.next(".cd-customization-trigger");</span><span id="6af4" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">//detect click on ul.size/ul.color list elements<br>      selectOptions.on("click", function(event) {<br>        var selected = $(this);<br>        //open/close options list<br>        selected.toggleClass("is-open");<br>        resetCustomization(selected);</span><span id="edc0" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">if ($(event.target).is("li")) {<br>          // update selected option<br>          var activeItem = $(event.target),<br>            index = activeItem.index() + 1;</span><span id="7285" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">activeItem<br>            .addClass("active")<br>            .siblings()<br>            .removeClass("active");<br>          selected<br>            .removeClass("selected-1 selected-2 selected-3")<br>            .addClass("selected-" + index);<br>          // if color has been changed, update the visible product image<br>          selected.hasClass("sr-color") &amp;&amp; updateSlider(selected, index - 1);<br>        }<br>      });</span><span id="cca0" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">//detect click on the add-to-cart button<br>      addToCartBtn.on("click", function() {<br>        if (!animating) {<br>          //animate if not already animating<br>          animating = true;<br>          resetCustomization(addToCartBtn);</span><span id="7b73" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">addToCartBtn<br>            .addClass("is-added")<br>            .find("path")<br>            .eq(0)<br>            .animate(<br>              {<br>                //draw the check icon<br>                "stroke-dashoffset": 0<br>              },<br>              300,<br>              function() {<br>                setTimeout(function() {<br>                  //updateCart();<br>                  addToCartBtn<br>                    .removeClass("is-added")<br>                    .find("em")<br>                    .on(<br>                      "webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",<br>                      function() {<br>                        //wait for the end of the transition to reset the check icon<br>                        addToCartBtn<br>                          .find("path")<br>                          .eq(0)<br>                          .css("stroke-dashoffset", "19.79");<br>                        animating = false;<br>                      }<br>                    );</span><span id="c724" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">if ($(".no-csstransitions").length &gt; 0) {<br>                    // check if browser doesn't support css transitions<br>                    addToCartBtn<br>                      .find("path")<br>                      .eq(0)<br>                      .css("stroke-dashoffset", "19.79");<br>                    animating = false;<br>                  }<br>                }, 600);<br>              }<br>            );<br>        }<br>      });</span><span id="3e78" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">//detect click on the settings icon - touch devices only<br>      touchSettings.on("click", function(event) {<br>        event.preventDefault();<br>        resetCustomization(addToCartBtn);<br>      });<br>    });<br>  }</span><span id="4a25" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">/*<br>  This function deals with showing or hiding the cart.<br> */<br>  function toggleCart(bool) {<br>    //always hide the address regardless of the toggle state as we never want to show this unless the<br>    //checkout button has been clicked<br>    $("#bitcoinaddresswrapper").hide();<br>    //check if the cart is open or not<br>    var cartIsOpen =<br>      typeof bool === "undefined" ? cartWrapper.hasClass("cart-open") : bool;</span><span id="360c" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">if (cartIsOpen) {<br>      cartWrapper.removeClass("cart-open");<br>      bitcoinback.removeClass("visible");<br>      cartList.find(".deleted").remove();<br>      bitcoinback.removeClass("visible");<br>      $("#bitcoin-address-template").hide();<br>      $("#cartlistitems").show();</span><span id="ef26" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">setTimeout(function() {<br>        cartBody.scrollTop(0);<br>        //check if cart empty to hide it<br>        if (<br>          Number(<br>            cartCount<br>              .find("li")<br>              .eq(0)<br>              .text()<br>          ) == 0<br>        )<br>          cartWrapper.addClass("empty");<br>      }, 500);<br>    } else {<br>      cartWrapper.addClass("cart-open");<br>    }<br>  }</span><span id="07b8" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">function addToCart(trigger) {<br>    var cartIsEmpty = cartWrapper.hasClass("empty");<br>    //update cart product list<br>    addProduct(trigger.data("price"), trigger.data("name"), trigger.data("id"));<br>    //update number of items<br>    updateCartCount(cartIsEmpty);<br>    //update total price<br>    updateCartTotal(trigger.data("price"), true);<br>    //show cart<br>    cartWrapper.removeClass("empty");<br>  }</span><span id="bbfd" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">function addProduct(price, name, productId) {<br>    //get the product quantity<br>    prodcutquantity = $("#productquantity").val();<br>    //check if its set or not if not then set it<br>    if (prodcutquantity == undefined) prodcutquantity = 0;<br>    //increment it by 1<br>    prodcutquantity++;<br>    //empty  the car contents<br>    cartList.empty();<br>    //build the row html<br>    //main product div<br>    var prodcuthtml = "";<br>    var prodcuthtml = prodcuthtml + '&lt;li class="product"&gt;';<br>    //product image<br>    var prodcuthtml =<br>      prodcuthtml +<br>      '&lt;div class="product-image"&gt;&lt;a href="#0"&gt;&lt;img src="img/product-preview.png" alt="placeholder"&gt;&lt;/a&gt;&lt;/div&gt;';<br>    //product details div<br>    var prodcuthtml = prodcuthtml + '&lt;div class="product-details"&gt;';<br>    //product name<br>    var prodcuthtml = prodcuthtml + '&lt;h3&gt;&lt;a href="#0"&gt;' + name + "&lt;/a&gt;&lt;/h3&gt;";<br>    //product price<br>    var prodcuthtml =<br>      prodcuthtml + '&lt;span class="productprice"&gt;$' + price + "&lt;/span&gt;";<br>    //delete option<br>    var prodcuthtml =<br>      prodcuthtml + '&lt;a href="#0" class="delete-item"&gt;Delete&lt;/a&gt;';<br>    //actions div<br>    var prodcuthtml = prodcuthtml + '&lt;div class="actions"&gt;';<br>    //quantity label<br>    var prodcuthtml =<br>      prodcuthtml + '&lt;label for="cd-product-' + productId + '"&gt;Qty&lt;/label&gt;';<br>    //quantity select<br>    var prodcuthtml =<br>      prodcuthtml +<br>      '&lt;span class="select"&gt;&lt;select id="productquantity" name="productquantity"&gt;';<br>    var i = 0;<br>    for (i = 1; i &lt; 11; i++) {<br>      if (i == prodcutquantity)<br>        var prodcuthtml =<br>          prodcuthtml + '&lt;option value="' + i + '" selected&gt;' + i + "&lt;/option&gt;";<br>      else<br>        var prodcuthtml =<br>          prodcuthtml + '&lt;option value="' + i + '"&gt;' + i + "&lt;/option&gt;";<br>    }<br>    //end of actions div<br>    var prodcuthtml = prodcuthtml + "&lt;/div&gt;";<br>    //end of products details div<br>    var prodcuthtml = prodcuthtml + "&lt;/div&gt;";<br>    //end of product div<br>    var prodcuthtml = prodcuthtml + "&lt;/div&gt;";<br>    //end of li<br>    var prodcuthtml = prodcuthtml + "&lt;/li&gt;";<br>    //add it<br>    //console.log(prodcuthtml);<br>    cartList.prepend(prodcuthtml);<br>    //updateCart()<br>  }</span><span id="5620" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">//remove the product<br>  function removeProduct(product) {<br>    var topPosition =<br>        product.offset().top - cartBody.children("ul").offset().top,<br>      productTotPrice = productPrice;<br>    product.css("top", topPosition + "px").addClass("deleted");<br>    cartTotal.text(0);<br>    productQuantity = 0;<br>    updateCartCount(true, 0);<br>  }</span><span id="d142" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">//update the counter<br>  function updateCartCount(emptyCart, quantity) {<br>    //check if cart is empty<br>    if (emptyCart == true &amp;&amp; quantity == 0) {<br>      var actual = 0;<br>      var next = 1;<br>      cartCount<br>        .find("li")<br>        .eq(0)<br>        .text(actual);<br>      cartCount<br>        .find("li")<br>        .eq(1)<br>        .text(next);<br>    } else {<br>      //check if it is the first time the cart is launched<br>      if (typeof quantity === "undefined") {<br>        var actual =<br>          Number(<br>            cartCount<br>              .find("li")<br>              .eq(0)<br>              .text()<br>          ) + 1;<br>        var next = actual + 1;</span><span id="8db6" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">if (emptyCart) {<br>          cartCount<br>            .find("li")<br>            .eq(0)<br>            .text(actual);<br>          cartCount<br>            .find("li")<br>            .eq(1)<br>            .text(next);<br>        } else {<br>          cartCount.addClass("update-count");</span><span id="1b74" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">setTimeout(function() {<br>            cartCount<br>              .find("li")<br>              .eq(0)<br>              .text(actual);<br>          }, 150);</span><span id="ea88" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">setTimeout(function() {<br>            cartCount.removeClass("update-count");<br>          }, 200);</span><span id="96db" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">setTimeout(function() {<br>            cartCount<br>              .find("li")<br>              .eq(1)<br>              .text(next);<br>          }, 230);<br>        }<br>      } else {<br>        var actual =<br>          Number(<br>            cartCount<br>              .find("li")<br>              .eq(0)<br>              .text()<br>          ) + quantity;<br>        var next = actual + 1;</span><span id="553c" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">cartCount<br>          .find("li")<br>          .eq(0)<br>          .text(actual);<br>        cartCount<br>          .find("li")<br>          .eq(1)<br>          .text(next);<br>      }<br>    }<br>  }</span><span id="c8f0" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">function updateCartTotal(price, bool) {<br>    //console.log(cartTotal);<br>    bool<br>      ? cartTotal.text((Number(cartTotal.text()) + Number(price)).toFixed(2))<br>      : cartTotal.text((Number(cartTotal.text()) - Number(price)).toFixed(2));<br>    //cartTotal.text( (Number(cartTotal.text()) + Number(price)).toFixed(2);<br>    //cartTotal.text( (Number(cartTotal.text()) - Number(price)).toFixed(2) );<br>  }</span><span id="9ac0" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">function updateSlider(actual, index) {<br>    var slider = actual<br>        .parent(".cd-customization")<br>        .prev("a")<br>        .children(".cd-slider-wrapper"),<br>      slides = slider.children("li");<br>    slides<br>      .eq(index)<br>      .removeClass("move-left")<br>      .addClass("selected")<br>      .prevAll()<br>      .removeClass("selected")<br>      .addClass("move-left")<br>      .end()<br>      .nextAll()<br>      .removeClass("selected move-left");<br>  }</span><span id="01f8" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">function resetCustomization(selectOptions) {<br>    //close ul.clor/ul.size if they were left open and user is not interacting with them anymore<br>    //remove the .hover class from items if user is interacting with a different one<br>    selectOptions<br>      .siblings('[data-type="select"]')<br>      .removeClass("is-open")<br>      .end()<br>      .parents(".cd-single-item")<br>      .addClass("hover")<br>      .parent("li")<br>      .siblings("li")<br>      .find(".cd-single-item")<br>      .removeClass("hover")<br>      .end()<br>      .find('[data-type="select"]')<br>      .removeClass("is-open");<br>  }<br>});</span></pre><h2 id="8680" class="mf kv bf av au el mg mh mi mj mk ml mm mn mo mp mq" data-selectable-paragraph=""><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/tree/www/www" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">WWW</a></h2><p id="cbe6" class="lh li bf av lj b lk ll lm ln lo lp lq lr ls lt lu" data-selectable-paragraph="">The "<strong class="lj lz"><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/tree/www/www" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">WWW</a>"</strong> directory contains an example website that renders one product and the includes the js file ("<strong class="lj lz"><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/blob/www/cdn/js/sr.js" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">sr.js</a>"</strong>) to render the cart and accept payment. Let’s look at the key parts of it.</p><p id="78cf" class="lh li bf av lj b lk ma lm mb lo mc lq md ls me lu" data-selectable-paragraph="">You can see a demo of this running "<strong><a href="https://cryptoskillz.com/srcrypto" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">here</a></strong>".</p><p id="a57c" class="lh li bf av lj b lk ma lm mb lo mc lq md ls me lu" data-selectable-paragraph="">The code below creates a gallery of products. Though I am only listing one it has the ability to list many. This will be covered in a future refactor to "<strong class="lj lz"><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/blob/www/cdn/js/sr.js" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">sr.js</a>"</strong></p><pre class="mr ms mt mu mv dv ge df"><span id="833b" class="mf kv bf av mw b dz mx my l mz" data-selectable-paragraph="">&lt;ul class="cd-gallery"&gt;<br>  &lt;li&gt;<br>   &lt;div class="cd-single-item"&gt;<br>    &lt;a href="#0"&gt;<br>     &lt;ul class="cd-slider-wrapper"&gt;<br>      &lt;li&gt;&lt;img src="img/thumb-1.jpg" alt="Preview image"&gt;&lt;/li&gt;<br>      &lt;li class="selected"&gt;&lt;img src="img/thumb-2.jpg" alt="Preview image"&gt;&lt;/li&gt;<br>      &lt;li&gt;&lt;img src="img/thumb-3.jpg" alt="Preview image"&gt;&lt;/li&gt;<br>     &lt;/ul&gt;<br>    &lt;/a&gt;</span><span id="bb2f" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">&lt;div class="cd-customization"&gt;<br>     &lt;div class="sr-color selected-2" data-type="select"&gt;<br>      &lt;ul&gt;<br>       &lt;li class="sr-color-1"&gt;color-1&lt;/li&gt;<br>       &lt;li class="sr-color-2 active"&gt;color-2&lt;/li&gt;<br>       &lt;li class="sr-color-3"&gt;color-3&lt;/li&gt;<br>      &lt;/ul&gt;<br>     &lt;/div&gt;<br>     <br>     &lt;div class="sr-size" data-type="select"&gt;<br>      &lt;ul&gt;<br>       &lt;li class="small active"&gt;Small&lt;/li&gt;<br>       &lt;li class="medium"&gt;Medium&lt;/li&gt;<br>       &lt;li class="large"&gt;Large&lt;/li&gt;<br>      &lt;/ul&gt;<br>     &lt;/div&gt;</span><span id="aab9" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">&lt;button class="sr-add-to-cart" data-price="9.99" data-name='T Shirt' data-id='1'&gt;<br>      &lt;em&gt;Add to Cart&lt;/em&gt;<br>      &lt;svg x="0px" y="0px" width="32px" height="32px" viewBox="0 0 32 32"&gt;<br>       &lt;path stroke-dasharray="19.79 19.79" stroke-dashoffset="19.79" fill="none" stroke="#FFFFFF" stroke-width="2" stroke-linecap="square" stroke-miterlimit="10" d="M9,17l3.9,3.9c0.1,0.1,0.2,0.1,0.3,0L23,11"/&gt;<br>      &lt;/svg&gt;<br>     &lt;/button&gt;<br>    &lt;/div&gt; &lt;!-- .cd-customization --&gt;</span><span id="bbb0" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">&lt;button class="cd-customization-trigger"&gt;Customize&lt;/button&gt;<br>   &lt;/div&gt; &lt;!-- .cd-single-item --&gt;</span><span id="472d" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">&lt;div class="cd-item-info"&gt;<br>    &lt;b&gt;&lt;a href="#0"&gt;T Shirt&lt;/a&gt;&lt;/b&gt;<br>    &lt;em&gt;$9.99&lt;/em&gt;<br>   &lt;/div&gt; &lt;!-- cd-item-info --&gt;<br>  &lt;/li&gt;<br> &lt;/ul&gt; &lt;!-- cd-gallery --&gt;</span></pre><p id="f4d3" class="lh li bf av lj b lk ma lm mb lo mc lq md ls me lu" data-selectable-paragraph="">The code below renders the cart.</p><pre class="mr ms mt mu mv dv ge df"><span id="efe7" class="mf kv bf av mw b dz mx my l mz" data-selectable-paragraph="">&lt;div class="cd-cart-container empty"&gt;<br> &lt;a href="#0" class="cd-cart-trigger"&gt;<br>  Cart<br>  &lt;ul class="count"&gt; &lt;!-- cart items count --&gt;<br>   &lt;li&gt;0&lt;/li&gt;<br>   &lt;li&gt;0&lt;/li&gt;<br>  &lt;/ul&gt; &lt;!-- .count --&gt;<br> &lt;/a&gt;</span><span id="cae4" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">&lt;div class="cd-cart"&gt;<br>  &lt;div class="wrapper"&gt;<br>   &lt;header&gt;<br>    &lt;h2&gt;Cart&lt;/h2&gt;<br>    &lt;span class="bitcoinback" &gt;&lt;a id="checkoutbitocoin" href="#0"&gt;Back&lt;/a&gt;&lt;/span&gt;</span><span id="af20" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">&lt;/header&gt;<br>   <br>   &lt;div class="body"&gt;<br>    &lt;ul id='cartlistitems'&gt;<br>     &lt;!-- products added to the cart will be inserted here using JavaScript --&gt;<br>    &lt;/ul&gt;</span><span id="9a23" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">&lt;div id="bitcoinaddresswrapper"&gt;<br>     &lt;div &gt;<br>            &lt;a id="bitcoinaddress" class="bitcoinaddress" href="bitcoin:2N3Xtg7pBjUG4RPaiwfc2t3wftvLGWv6i2K" &gt;19356KxTs9Bw5AAdxens5hoxDSp5bsUKse&lt;/a&gt;<br>        &lt;/div&gt;<br>        &lt;div class="bitcoinoptions" &gt;<br>         &lt;a href="#" class="bitcoinaddresscopy"&gt;<br>            &lt;i class="fa fa-copy"&gt;&lt;/i&gt;<br>            Copy<br>        &lt;/a&gt;<br>        <br>        &lt;a href="bitcoin:2N3Xtg7pBjUG4RPaiwfc2t3wftvLGWv6i2K" class=""&gt;<br>            &lt;i class="fa fa-btc"&gt;&lt;/i&gt;<br>            Pay from wallet<br>        &lt;/a&gt;<br>        &lt;/div&gt;</span><span id="7177" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">&lt;img id="bitcoinqrcode" src="" /&gt;<br>    &lt;/div&gt;</span><span id="5170" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">&lt;/div&gt;</span><span id="792f" class="mf kv bf av mw b dz na nb nc nd ne my l mz" data-selectable-paragraph="">&lt;footer&gt;<br>    &lt;a href="#0" class="checkout btn"&gt;&lt;em&gt;Checkout - $&lt;span&gt;0&lt;/span&gt;&lt;/em&gt;&lt;/a&gt;<br>   &lt;/footer&gt;<br>  &lt;/div&gt;<br> &lt;/div&gt; &lt;!-- .cd-cart --&gt;<br>&lt;/div&gt; &lt;!-- cd-cart-container --&gt;</span></pre><h1 id="c235" class="ku kv bf av au el kw kx ky kz la lb lc ld le lf lg" data-selectable-paragraph="">The SQL</h1><p id="fa99" class="lh li bf av lj b lk ll lm ln lo lp lq lr ls lt lu" data-selectable-paragraph="">No changes to the SQL this time.</p><pre class="mr ms mt mu mv dv ge df"><span id="56d4" class="mf kv bf av mw b dz mx my l mz" data-selectable-paragraph="">CREATE TABLE "keys" ( <br>`id` INTEGER PRIMARY KEY AUTOINCREMENT,<br> `privatekey` TEXT,<br> `publickey` TEXT,<br> `address` TEXT,<br> `processed` INTEGER DEFAULT 0,<br> `swept` INTEGER DEFAULT 0 <br>)</span></pre><h1 id="0cfa" class="ku kv bf av au el kw kx ky kz la lb lc ld le lf lg" data-selectable-paragraph="">Conclusion</h1><p id="8dde" class="lh li bf av lj b lk ll lm ln lo lp lq lr ls lt lu" data-selectable-paragraph="">That is it we now have a system that allows us to build a simple website and take and process payments in Bitcoin. The following parts of this tutorial are not required reading but will get very granular in a certain section of this project including.</p><p id="ece2" class="lh li bf av lj b lk ma lm mb lo mc lq md ls me lu" data-selectable-paragraph="">Adding a SAAS admin area<br>Removing all dependencies <br>Adding our own full node</p><p id="53c6" class="lh li bf av lj b lk ma lm mb lo mc lq md ls me lu" data-selectable-paragraph="">Anything else that crops up with the eventual aim of having a Bitcoin-based e-commerce system.</p></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on September 20, 2019</p><ul class="post__tag"><li><a href="https://cryptoskillz.com/blog/ecs/">ecs</a></li></ul><div class="post__share"><a href="https://twitter.com/share?url=https%3A%2F%2Fcryptoskillz.com%2Fblog%2Fwww-and-modularisation.html&amp;via=crypto_skillz&amp;text=WWW%20and%20modularisation" class="js-share twitter" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://cryptoskillz.com/blog/assets/svg/svg-map.svg#twitter"/></svg> <span>Twitter</span></a></div></footer></article><nav class="post__nav"><div class="post__nav-inner"><div class="post__nav-prev"><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://cryptoskillz.com/blog/assets/svg/svg-map.svg#arrow-prev"/></svg> <a href="https://cryptoskillz.com/blog/move-payment-to-cold-storage.html" class="invert post__nav-link" rel="prev"><span>Previous</span> Move payment to cold storage</a></div><div class="post__nav-next"><a href="https://cryptoskillz.com/blog/create-an-admin-and-hosting.html" class="invert post__nav-link" rel="next"><span>Next</span> Create an Admin and hosting </a><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://cryptoskillz.com/blog/assets/svg/svg-map.svg#arrow-next"/></svg></div></div></nav><div class="post__comments"><div class="wrapper"><h2 class="h5">Comments</h2><div id="disqus_thread"></div><script>var disqus_config = function () {
                       this.page.url = 'https://cryptoskillz.com/blog/www-and-modularisation.html';
               		this.page.identifier = '7';
                       this.page.title = ' WWW and modularisation';
                   };
               
                   var disqus_loaded = false;
               
                   function publiiLoadDisqus() {
                       if(disqus_loaded) {
                           return false;
                       }
               
                       var top = document.getElementById('disqus_thread').offsetTop;
               
                       if (!disqus_loaded && (window.scrollY || window.pageYOffset) + window.innerHeight > top) {
                           disqus_loaded = true;
               
                           (function () {
                               var d = document, s = d.createElement('script');
                               s.src = 'https://cryptoskillz-1.disqus.com/embed.js';
                               s.setAttribute('data-timestamp', +new Date());
                               (d.head || d.body).appendChild(s);
                           })();
                       }
                   }
               
                   publiiLoadDisqus();
               
                   window.onscroll = function() {
                       publiiLoadDisqus();
                   };</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></div></div></main><footer class="footer"><div class="footer__social"><a href="crypto_skillz" aria-label="Twitter"><svg><use xlink:href="https://cryptoskillz.com/blog/assets/svg/svg-map.svg#twitter"/></svg></a></div><div class="footer__copyright">Powered by <a href="https://getpublii.com" target="_blank" rel="nofollow noopener noreferrer">Publii Static CMS</a></div><button class="footer__bttop js-footer__bttop" aria-label="Back to top"><svg><title>Back to top</title><use xlink:href="https://cryptoskillz.com/blog/assets/svg/svg-map.svg#toparrow"/></svg></button></footer></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'overlay',
        animationSpeed: 300,
        submenuWidth: 240,
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.top',
   };</script><script defer="defer" src="https://cryptoskillz.com/blog/assets/js/scripts.min.js?v=f56b13ba141d95ea2a0b7aab75ca9528"></script><script>var lazyFeaturedImage=function lazyFeaturedImage(){var b=document.querySelectorAll(".hero__image-img");for(var a=0;a<b.length;a++){var c=b[a];c.addEventListener("lazyloaded",function(f){var d=f.target.parentNode;d.classList.add("hero__image--overlay")})}};lazyFeaturedImage();</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-111636971-1"></script><script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-111636971-1');</script></body></html>