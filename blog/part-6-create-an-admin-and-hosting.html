<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Part 6: Create an Admin and hosting - cryptoskillz</title><meta name="description" content="blockchain,bitcoin,node js, fullnode"><meta name="robots" content="index, follow"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://cryptoskillz.com/blog/part-6-create-an-admin-and-hosting.html"><link rel="amphtml" href="https://cryptoskillz.com/blog/amp/part-6-create-an-admin-and-hosting.html"><link rel="alternate" type="application/atom+xml" href="https://cryptoskillz.com/blog/feed.xml"><link rel="alternate" type="application/json" href="https://cryptoskillz.com/blog/feed.json"><meta property="og:title" content="Part 6: Create an Admin and hosting"><meta property="og:image" content="https://cryptoskillz.com/blog/media/website/logo.png"><meta property="og:site_name" content="cryptoskillz"><meta property="og:description" content="blockchain,bitcoin,node js, fullnode"><meta property="og:url" content="https://cryptoskillz.com/blog/part-6-create-an-admin-and-hosting.html"><meta property="og:type" content="article"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><style>h1,h2,h3,h4,h5,h6,.btn,[type=button],[type=submit],button,.navbar .navbar__menu li,.navbar_mobile_sidebar .navbar__menu li,.feed__author,.post__tag,.post__share>a span,.post__nav-link>span,.footer{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}body,h1,.h1,blockquote,.search__input,.author__name,.author__info>p,.feed__item h2,.post__nav-link{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}</style><link rel="stylesheet" href="https://cryptoskillz.com/blog/assets/css/style.css?v=9dbea7342a98d006264fd6742c2fe261"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://cryptoskillz.com/blog/part-6-create-an-admin-and-hosting.html"},"headline":"Part 6: Create an Admin and hosting","datePublished":"2019-09-08T18:03","dateModified":"2019-09-09T00:35","image":{"@type":"ImageObject","url":"https://cryptoskillz.com/blog/media/website/logo.png","height":178,"width":685},"description":"<figure class=\"post__image\"><img  src=\"https://cryptoskillz.com/blog/media/posts/8/1_IRIyXKuOZEJK1K2cq2dB4w.jpeg\" sizes=\"(max-width: 48em) 100vw, 768px\" srcset=\"https://cryptoskillz.com/blog/media/posts/8/responsive/1_IRIyXKuOZEJK1K2cq2dB4w-xs.jpeg 300w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_IRIyXKuOZEJK1K2cq2dB4w-sm.jpeg 480w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_IRIyXKuOZEJK1K2cq2dB4w-md.jpeg 768w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_IRIyXKuOZEJK1K2cq2dB4w-lg.jpeg 1024w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_IRIyXKuOZEJK1K2cq2dB4w-xl.jpeg 1360w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_IRIyXKuOZEJK1K2cq2dB4w-2xl.jpeg 1600w\"  alt=\"\" width=\"639\" height=\"470\"></figure>\n<p> </p>\n","author":{"@type":"Person","name":"cryptoskillz"},"publisher":{"@type":"Organization","name":"cryptoskillz","logo":{"@type":"ImageObject","url":"https://cryptoskillz.com/blog/media/website/logo.png","height":178,"width":685}}}</script><script src="https://cryptoskillz.com/blog/assets/js/ls.parent-fit.min.js?v=1c78585e2a70398fe95085061942fd37"></script><script async src="https://cryptoskillz.com/blog/assets/js/lazysizes.min.js?v=149ff45fc6c2f13e892e438a58abb77f"></script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
    google_ad_client: "ca-pub-4710117865976591",
    enable_page_level_ads: true
  });</script></head><body><div class="site-container"><header class="top" id="js-header"><a class="logo" href="https://cryptoskillz.com/blog/"><img src="https://cryptoskillz.com/blog/media/website/logo.png" alt="cryptoskillz"></a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://cryptoskillz.com/index.html" target="_self">ECS</a></li><li><a href="https://cryptoskillz.com/blox.html" target="_self">BLOX</a></li><li><a href="https://cryptoskillz.com/about.html" target="_self">ABOUT</a></li></ul></nav><div class="search"><div class="search__overlay js-search-overlay"><div class="search__overlay-inner"><form action="https://cryptoskillz.com/blog/search.html" class="search__form"><input class="search__input js-search-input" type="search" name="q" placeholder="search..." autofocus="autofocus"></form><button class="search__close js-search-close" aria-label="Close">Close</button></div></div><button class="search__btn js-search-btn" aria-label="Search"><svg role="presentation" focusable="false"><use xlink:href="https://cryptoskillz.com/blog/assets/svg/svg-map.svg#search"/></svg></button></div></header><main><article class="post"><div class="hero"><header class="hero__content"><div class="wrapper"><div class="post__meta"><time datetime="2019-09-08T18:03">September 8, 2019</time></div><h1>Part 6: Create an Admin and hosting</h1><div class="post__meta post__meta--author"><a href="https://cryptoskillz.com/blog/authors/cryptoskillz/" class="feed__author invert">cryptoskillz</a></div></div></header></div><div class="wrapper post__entry"><figure class="post__image"><img class="lazyload" data-src="https://cryptoskillz.com/blog/media/posts/8/1_IRIyXKuOZEJK1K2cq2dB4w.jpeg" data-sizes="auto" data-srcset="https://cryptoskillz.com/blog/media/posts/8/responsive/1_IRIyXKuOZEJK1K2cq2dB4w-xs.jpeg 300w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_IRIyXKuOZEJK1K2cq2dB4w-sm.jpeg 480w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_IRIyXKuOZEJK1K2cq2dB4w-md.jpeg 768w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_IRIyXKuOZEJK1K2cq2dB4w-lg.jpeg 1024w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_IRIyXKuOZEJK1K2cq2dB4w-xl.jpeg 1360w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_IRIyXKuOZEJK1K2cq2dB4w-2xl.jpeg 1600w" alt="" data-aspectratio="1.359574" width="639" height="470"></figure><p> </p><h1 id="16ac" class="ku kv bf av au el kw kx ky kz la lb lc ld le lf lg" data-selectable-paragraph="">Introduction</h1><p id="dfde" class="lh li bf av lj b lk ll lm ln lo lp lq lr ls lt lu" data-selectable-paragraph="">In this part, we have created an admin as well as cleaned up the code and hosted it on <a href="http://aws.amazon.com/" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">Amazon Web Services</a>.</p><h1 id="2214" class="ku kv bf av au el kw kx ky kz la lb lc ld le lf lg" data-selectable-paragraph="">The SQL</h1><p id="feea" class="lh li bf av lj b lk ll lm ln lo lp lq lr ls lt lu" data-selectable-paragraph="">The keys table has had several fields added to it.</p><p id="0dc3" class="lh li bf av lj b lk lz lm ma lo mb lq mc ls md lu" data-selectable-paragraph="">“u<strong class="lj me">serid</strong>” is the user that this payment belongs to, “<strong class="lj me">net</strong>” is the network used (test or live) and the “amount” is the total amount of Bitcoin received.</p><p id="bf00" class="lh li bf av lj b lk lz lm ma lo mb lq mc ls md lu" data-selectable-paragraph="">Really we should (and will) rename this table in the future.</p><pre class="mf mg mh mi mj dv ge df"><span id="80cb" class="mk kv bf av ml b dz mm mn l mo" data-selectable-paragraph="">CREATE TABLE "keys" ( <br>`id` INTEGER PRIMARY KEY AUTOINCREMENT,<br>`privatekey` TEXT,<br>`publickey` TEXT,<br>`address` TEXT,<br>`processed` INTEGER DEFAULT 0,<br>`swept` INTEGER DEFAULT 0,<br>`userid` INTEGER,<br>`net` INTEGER DEFAULT 1,<br>`amount` TEXT DEFAULT 0 <br>)</span></pre><p id="f06a" class="lh li bf av lj b lk lz lm ma lo mb lq mc ls md lu" data-selectable-paragraph="">We have also added a user table which stores the user settings.</p><pre class="mf mg mh mi mj dv ge df"><span id="aff3" class="mk kv bf av ml b dz mm mn l mo" data-selectable-paragraph="">CREATE TABLE "user" ( <br>`id` INTEGER PRIMARY KEY AUTOINCREMENT,<br>`username` TEXT,<br>`password` TEXT,<br>`isadmin` INTEGER,<br>`sessiontoken` TEXT )</span></pre><p id="24bc" class="lh li bf av lj b lk lz lm ma lo mb lq mc ls md lu" data-selectable-paragraph="">and a user settings table to store, well the settings.</p><pre class="mf mg mh mi mj dv ge df"><span id="f9de" class="mk kv bf av ml b dz mm mn l mo" data-selectable-paragraph="">CREATE TABLE `usersettings` (<br> `id` INTEGER PRIMARY KEY AUTOINCREMENT,<br> `userid` INTEGER,<br> `coldstorageaddress` TEXT <br>)</span></pre><h1 id="47bb" class="ku kv bf av au el kw kx ky kz la lb lc ld le lf lg" data-selectable-paragraph="">Code sections</h1><p id="a8a5" class="lh li bf av lj b lk ll lm ln lo lp lq lr ls lt lu" data-selectable-paragraph="">As discussed in the previous <a class="cb bx lv lw lx ly" target="_blank" href="https://medium.com/@cryptoskillz_58791/using-bitcoin-to-accept-payments-part-5-b9f5df2499f4" rel="noopener noreferrer">tutorial</a> we have modularised the code to make it work in a microservice(ish) architecture. Although for learning purposes, we keep it all in one GIT repo we should really have a separate one for each service.</p><p id="9981" class="lh li bf av lj b lk lz lm ma lo mb lq mc ls md lu" data-selectable-paragraph="">You can find the code for this part of the tutorial <a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/tree/admin" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">here</a>.</p><h2 id="561e" class="mk kv bf av au el mp mq mr ms mt mu mv mw mx my mz" data-selectable-paragraph="">Admin</h2><p id="2089" class="lh li bf av lj b lk ll lm ln lo lp lq lr ls lt lu" data-selectable-paragraph="">The admin part of the service is static HTML site which gets interacts with the API to fetch and store information. We have hosted on amazon s3 (bucket) set up to host static websites. You can see a demo admin by clicking the link below:</p><p id="8e19" class="lh li bf av lj b lk lz lm ma lo mb lq mc ls md lu" data-selectable-paragraph=""><a href="https://cryptoskillz.com/srcrypto/prod/admin/" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">https://cryptoskillz.com/srcrypto/prod/admin/</a></p><p id="d373" class="lh li bf av lj b lk lz lm ma lo mb lq mc ls md lu" data-selectable-paragraph="">Please note this is a very simple admin and should not be considered for a production app, it is purely to show and allow us to easier run test transactions. Ideally, we would rebuild it in <a href="https://reactjs.org/" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">react</a> with <a href="https://jwt.io/" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">JWT</a> in the future.</p><p id="1a5c" class="lh li bf av lj b lk lz lm ma lo mb lq mc ls md lu" data-selectable-paragraph="">It is made up of 4 pages and all of the interactions is done via REST API with the server. The 4 pages are listed below:</p><h2 id="6c54" class="mk kv bf av au el mp mq mr ms mt mu mv mw mx my mz" data-selectable-paragraph=""><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/blob/admin/admin/login.html" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">login.html</a></h2><p id="1351" class="lh li bf av lj b lk ll lm ln lo lp lq lr ls lt lu" data-selectable-paragraph="">This page is the simple login page and it will verify that you have logged in by returning a session token that you then use to access the other parts of the admin</p><figure class="post__image"><img class="lazyload" data-src="https://cryptoskillz.com/blog/media/posts/8/1_x4W7U4k_2MIfK5vaJyrqOQ.png" data-sizes="auto" data-srcset="https://cryptoskillz.com/blog/media/posts/8/responsive/1_x4W7U4k_2MIfK5vaJyrqOQ-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_x4W7U4k_2MIfK5vaJyrqOQ-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_x4W7U4k_2MIfK5vaJyrqOQ-md.png 768w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_x4W7U4k_2MIfK5vaJyrqOQ-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_x4W7U4k_2MIfK5vaJyrqOQ-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_x4W7U4k_2MIfK5vaJyrqOQ-2xl.png 1600w" alt="" data-aspectratio="4.269068" width="2015" height="472"></figure><h2 id="b9fc" class="mk kv bf av au el mp mq mr ms mt mu mv mw mx my mz" data-selectable-paragraph=""><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/blob/admin/admin/index.html" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">Index.html</a>:</h2><p id="450b" class="lh li bf av lj b lk ll lm ln lo lp lq lr ls lt lu" data-selectable-paragraph="">The first page you see when you are logged in</p><figure class="post__image"><img class="lazyload" data-src="https://cryptoskillz.com/blog/media/posts/8/1_D16UkqMOHPXDrUq_Q2_VAw.png" data-sizes="auto" data-srcset="https://cryptoskillz.com/blog/media/posts/8/responsive/1_D16UkqMOHPXDrUq_Q2_VAw-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_D16UkqMOHPXDrUq_Q2_VAw-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_D16UkqMOHPXDrUq_Q2_VAw-md.png 768w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_D16UkqMOHPXDrUq_Q2_VAw-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_D16UkqMOHPXDrUq_Q2_VAw-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_D16UkqMOHPXDrUq_Q2_VAw-2xl.png 1600w" alt="" data-aspectratio="4.284038" width="1825" height="426"></figure><h2 id="f4a4" class="mk kv bf av au el mp mq mr ms mt mu mv mw mx my mz" data-selectable-paragraph=""><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/blob/admin/admin/payments.html" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">payments.html</a></h2><p id="e236" class="lh li bf av lj b lk ll lm ln lo lp lq lr ls lt lu" data-selectable-paragraph="">the payments table page allowing you to check payments/sweep to cold wallet etc.</p><figure class="post__image"><img class="lazyload" data-src="https://cryptoskillz.com/blog/media/posts/8/1_zvsAj4x93kGlB178CBA6cw.png" data-sizes="auto" data-srcset="https://cryptoskillz.com/blog/media/posts/8/responsive/1_zvsAj4x93kGlB178CBA6cw-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_zvsAj4x93kGlB178CBA6cw-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_zvsAj4x93kGlB178CBA6cw-md.png 768w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_zvsAj4x93kGlB178CBA6cw-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_zvsAj4x93kGlB178CBA6cw-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_zvsAj4x93kGlB178CBA6cw-2xl.png 1600w" alt="" data-aspectratio="4.206501" width="2200" height="523"></figure><h2 id="9168" class="mk kv bf av au el mp mq mr ms mt mu mv mw mx my mz" data-selectable-paragraph=""><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/blob/admin/admin/settings.html" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">settings.html</a></h2><p id="6a96" class="lh li bf av lj b lk ll lm ln lo lp lq lr ls lt lu" data-selectable-paragraph="">the settings page</p><figure class="post__image"><img class="lazyload" data-src="https://cryptoskillz.com/blog/media/posts/8/1_SN_mvUI6uohqrIse8YLY5w.png" data-sizes="auto" data-srcset="https://cryptoskillz.com/blog/media/posts/8/responsive/1_SN_mvUI6uohqrIse8YLY5w-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_SN_mvUI6uohqrIse8YLY5w-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_SN_mvUI6uohqrIse8YLY5w-md.png 768w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_SN_mvUI6uohqrIse8YLY5w-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_SN_mvUI6uohqrIse8YLY5w-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/8/responsive/1_SN_mvUI6uohqrIse8YLY5w-2xl.png 1600w" alt="" data-aspectratio="5.037559" width="2146" height="426"></figure><p id="f94a" class="lh li bf av lj b lk lz lm ma lo mb lq mc ls md lu" data-selectable-paragraph="">All of the REST API interaction with the server is done inside main.js which is shown below.</p><pre class="mf mg mh mi mj dv ge df"><span id="69ca" class="mk kv bf av ml b dz mm mn l mo" data-selectable-paragraph="">//server call to make the AJAX calls to<br>//set url to production<br>var serverurl = "<a href="http://srcryptoapi.eu-west-1.elasticbeanstalk.com/" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">http://srcryptoapi.eu-west-1.elasticbeanstalk.com/</a>";<br>//check if we are local<br>//note : set this whatever your local instance is 127.0.0.1 for example<br>if (window.location.href.indexOf("srcrypto") &gt; -1) {<br>  serverurl = "<a href="http://127.0.0.1:3000/" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">http://127.0.0.1:3000/</a>";<br>}</span><span id="4934" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">//hold the return from the server<br>var ajaxdata = "";<br>//hold the session token<br>var token = "";</span><span id="2cb7" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">//set a cookie<br>function setCookie(cname, cvalue) {<br>  document.cookie = cname + "=" + cvalue + "; path=/";<br>}</span><span id="bbc6" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">//get a cookie<br>function getCookie(cname) {<br>  var i,<br>    c,<br>    ca,<br>    nameEQ = cname + "=";<br>  ca = document.cookie.split(";");<br>  for (i = 0; i &lt; ca.length; i++) {<br>    c = ca[i];<br>    while (c.charAt(0) == " ") {<br>      c = c.substring(1, c.length);<br>    }<br>    if (c.indexOf(nameEQ) == 0) {<br>      return c.substring(nameEQ.length, c.length);<br>    }<br>  }<br>  return "";<br>}</span><span id="5618" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">//process the return from the server settings calls<br>function settingsDone() {<br>  var result = $.parseJSON(ajaxdata);<br>  //debug<br>  //console.log(result.results[0]);<br>  if (result.results[0] != "0") {<br>    //alert(result.results[0].coldstorageaddress);<br>    $("#address").val(result.results[0].coldstorageaddress);<br>  } else {<br>    alert("settings not updated");<br>  }<br>}</span><span id="03f2" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">//process he return form the update settings call<br>//note: I know this should be on the post for the settings endpoint but I have been lazy.  Will refactor it later.<br>function updatesettigsDone() {<br>  //get the result<br>  var result = $.parseJSON(ajaxdata);<br>  //debug<br>  //console.log(result.results);<br>  //check update status<br>  if (result.results == "ok") {<br>    alert("settings updated");<br>  } else {<br>    alert("eror updating settings");<br>  }<br>}</span><span id="7919" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">//check the result from the processed server call<br>function checkProcessedDone() {<br>  //process the result<br>  var result = $.parseJSON(ajaxdata);<br>  //check the status<br>  if (result.status == "confirmed") {<br>    //refresh the payment table<br>    var geturl = serverurl + "admin/payments?token=" + token;<br>    ajaxGET(geturl, "paymentsDone()");<br>  } else {<br>    //alert the user to an error<br>    alert("Payment not confirmed");<br>  }<br>}</span><span id="3159" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">//call the server to see if the payment has been processed<br>function checkProcessed(address) {<br>  var geturl = serverurl + "api/monitor?address=" + address + "&amp;token=" + token;<br>  //alert(geturl);<br>  ajaxGET(geturl, "checkProcessedDone()");<br>}</span><span id="e074" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">//call the server and move the payment to cold storage.<br>function checkSwept(address) {<br>  var geturl = serverurl + "api/sweep?address=" + address + "&amp;token=" + token;<br>  //alert(geturl);<br>  ajaxGET(geturl, "checkSweptDone()");<br>}</span><span id="4b37" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">//check the results of the sever<br>function checkSweptDone() {<br>  //process results<br>  var result = $.parseJSON(ajaxdata);<br>  //check if it ws swept<br>  if (result.status == "swept") {<br>    //reload the payments page<br>    var geturl = serverurl + "admin/payments?token=" + token;<br>    ajaxGET(geturl, "paymentsDone()");<br>  } else {<br>    //check the error<br>    if (result.status == "already swept") {<br>      //already moved to cold storage<br>      alert("Payment already swept");<br>      var geturl = serverurl + "admin/payments?token=" + token;<br>      ajaxGET(geturl, "paymentsDone()");<br>    }<br>    if (result.status == "not swept") {<br>      //unknown error<br>      alert("Payment not swept");<br>    }<br>  }<br>}</span><span id="92fa" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">//process the payments done<br>function paymentsDone() {<br>  //parse the result<br>  var result = $.parseJSON(ajaxdata);<br>  //console.log(result.results);<br>  //console.log(ajaxdata);</span><span id="7c2d" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">//grab the table<br>  var t = $("#example").DataTable();<br>  //empty the table<br>  t.clear().draw();<br>  //loop through the results returned from the server<br>  jQuery.each(result.results, function(index, res) {<br>    //console.log(res);<br>    //net 1 = live 2 = test</span><span id="2b63" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">//vars<br>    var processed = "Yes";<br>    var swept = "Yes";<br>    //set the block explorer url<br>    var blockexplorerurl = "<a href="https://live.blockcypher.com/btc-testnet/address/" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">https://live.blockcypher.com/btc-testnet/address/</a>";<br>    blockexplorerurl = blockexplorerurl + res.address + "/";<br>    //actions column<br>    var actions =<br>      '&lt;a href="' +<br>      blockexplorerurl +<br>      '" target="_blank"&gt;&lt;i class="fas fa-external-link-square-alt"&gt;&lt;/i&gt;View&lt;/a&gt;';<br>    //check if the payment was processed<br>    if (res.processed == 0) {<br>      //set processed to no<br>      processed = "No";<br>      //add to the action<br>      actions =<br>        actions +<br>        "&lt;a href=\"javascript:checkProcessed('" +<br>        res.address +<br>        '\')"&gt;&lt;i class="fas fa-external-link-square-alt"&gt;&lt;/i&gt;Process&lt;/a&gt;';<br>    } else {<br>      //check if it was swept<br>      //note: you should never have an unprocessed payment that was swept but it does not harm to have this additional check.<br>      if (res.swept == 0) {<br>        //add to the acction<br>        swept = "No";<br>        actions =<br>          actions +<br>          "&lt;a href=\"javascript:checkSwept('" +<br>          res.address +<br>          '\')"&gt;&lt;i class="fas fa-external-link-square-alt"&gt;&lt;/i&gt;Sweep&lt;/a&gt;';<br>      }<br>    }</span><span id="1c4d" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">//add the row to the table<br>    t.row<br>      .add([<br>        res.id,<br>        '&lt;a href="' +<br>          blockexplorerurl +<br>          '" target="_blank"&gt;' +<br>          res.address +<br>          "&lt;/a&gt;",<br>        processed,<br>        swept,<br>        res.amount,<br>        actions<br>      ])<br>      .draw(false);<br>  });<br>}</span><span id="ec66" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">//process the server return call from login<br>function loginDone() {<br>  //parse the results<br>  var result = $.parseJSON(ajaxdata);<br>  //debug<br>  //console.log(result.token)</span><span id="559c" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">//check for token<br>  if (result.token != 0) {<br>    //get the cookie<br>    setCookie("srcookie", result.token);<br>    //redirect to index page<br>    window.location.href = "index.html";<br>  } else {<br>    //issue with login<br>    alert("invalid login details");<br>  }<br>}</span><span id="812d" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">//generic ajax call function<br>function ajaxGET(url, parentcallback) {<br>  //debug<br>  //console.log('url'+url);<br>  //console.log(parentcallback);</span><span id="e3f8" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">//setup<br>  $.ajaxSetup({<br>    cache: false<br>  });<br>  //make the call<br>  var jqxhr = $.get(url, function(data) {})<br>    .success(function(result) {<br>      //logIt(result);</span><span id="27bb" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">//store the result<br>      ajaxdata = result;<br>      //set the done funtion<br>      var tmpFunc = new Function(parentcallback);<br>      //call the done funtion<br>      tmpFunc();<br>    })<br>    .error(function(result) {})<br>    .complete(function() {});<br>}</span><span id="1572" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">//update settings click<br>$("#updatesettings").click(function() {<br>  //get the address<br>  address = $("#address").val();<br>  //debug<br>  //alert(address);</span><span id="93e6" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">//call the server updatesettings url<br>  var geturl =<br>    serverurl + "admin/updatesettigs?address=" + address + "&amp;token=" + token;<br>  ajaxGET(geturl, "updatesettigsDone()");<br>});</span><span id="f150" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">//login click<br>$("#login").click(function() {<br>  //get detals<br>  uname = $("#username").val();<br>  pass = $("#password").val();<br>  //call the login server url<br>  var geturl = serverurl + "admin/login?uname=" + uname + "&amp;pass=" + pass;<br>  ajaxGET(geturl, "loginDone()");<br>});</span><span id="4294" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">$(document).ready(function() {<br>  //get the cookie<br>  token = getCookie("srcookie");<br>  //debug<br>  //console.log(token);<br>  //setCookie('srcookie','12345');<br>  //force login<br>  //setCookie('srcookie','');<br>  //get the url<br>  var url = window.location.href;</span><span id="2d4e" class="mk kv bf av ml b dz nl nm nn no np mn l mo" data-selectable-paragraph="">//check if it is blank<br>  if (token == "") {<br>    //check if it is not login and redirect<br>    if (url.substr(url.lastIndexOf("/") + 1) != "login.html") {<br>      window.location.href = "login.html";<br>    }<br>  } else {<br>    //check what page we are on<br>    //check if it is the payment page<br>    if (url.substr(url.lastIndexOf("/") + 1) == "payments.html") {<br>      //alert(token);<br>      //make a server call<br>      var geturl = serverurl + "admin/payments?token=" + token;<br>      ajaxGET(geturl, "paymentsDone()");<br>    }<br>    if (url.substr(url.lastIndexOf("/") + 1) == "settings.html") {<br>      //make a server call<br>      var geturl = serverurl + "admin/settings?token=" + token;<br>      ajaxGET(geturl, "settingsDone()");<br>    }<br>    $("#wrapper").removeClass("d-none");<br>    //load the table<br>  }<br>});</span></pre><h2 id="55f4" class="mk kv bf av au el mp mq mr ms mt mu mv mw mx my mz" data-selectable-paragraph="">Hosting the admin</h2><p id="d1b4" class="lh li bf av lj b lk ll lm ln lo lp lq lr ls lt lu" data-selectable-paragraph="">You are free to host on any platform you wish I use Amazon as I find it the best and easiest to use. If you want to a good article on how to set up S3 hosting please click <a href="https://medium.freecodecamp.org/how-to-host-a-website-on-s3-without-getting-lost-in-the-sea-e2b82aa6cd38" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">here</a> and a good video on how to do it is shown below:</p><figure class="mf mg mh mi mj fr"><div class="jt l ds"><div class="nq l"><div class="post__iframe"><iframe class="lazyload" width="640" height="480" data-src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2Fg9NbuTcos18%3Ffeature%3Doembed&amp;url=http%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3Dg9NbuTcos18&amp;image=https%3A%2F%2Fi.ytimg.com%2Fvi%2Fg9NbuTcos18%2Fhqdefault.jpg&amp;key=a19fcc184b9711e1b4764040d3dc5c07&amp;type=text%2Fhtml&amp;schema=youtube" frameborder="0" title="Hosting a static website on Amazon S3 (AWS howto)" class="du n o jq ab" scrolling="auto" data-mce-fragment="1"></iframe></div></div></div></figure><h2 id="8a0b" class="mk kv bf av au el mp mq mr ms mt mu mv mw mx my mz" data-selectable-paragraph=""><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/tree/admin/www" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">WWW</a> and <a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/tree/admin/cdn" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">CDN</a></h2><p id="73c3" class="lh li bf av lj b lk ll lm ln lo lp lq lr ls lt lu" data-selectable-paragraph="">To host <a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/tree/admin/www" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">WWW</a> and <a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/tree/admin/cdn" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">CDN</a> just create two more buckets and move the files above it as shown above. I have hosted both sections on the URLs below.</p><p id="6c7b" class="lh li bf av lj b lk lz lm ma lo mb lq mc ls md lu" data-selectable-paragraph=""><a href="https://cryptoskillz.com/srcrypto/prod/cdn/js/sr.js" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">https://cryptoskillz.com/srcrypto/prod/cdn/js/sr.js</a></p><p id="13f4" class="lh li bf av lj b lk lz lm ma lo mb lq mc ls md lu" data-selectable-paragraph=""><a href="https://cryptoskillz.com/srcrypto/prod/www/" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">https://cryptoskillz.com/srcrypto/prod/www/</a></p><h2 id="4236" class="mk kv bf av au el mp mq mr ms mt mu mv mw mx my mz" data-selectable-paragraph=""><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/tree/admin/server" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">Server</a></h2><p id="8aa9" class="lh li bf av lj b lk ll lm ln lo lp lq lr ls lt lu" data-selectable-paragraph="">We have hosted the server on “<a href="https://www.digitalocean.com/" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer"><strong class="lj me">Digital Ocean</strong></a><strong class="lj me">”</strong> but you can use any provider as it is just a simple node js application.</p><p id="4787" class="lh li bf av lj b lk lz lm ma lo mb lq mc ls md lu" data-selectable-paragraph="">The demo server is can be accessed from the link below</p><p id="2f9c" class="lh li bf av lj b lk lz lm ma lo mb lq mc ls md lu" data-selectable-paragraph=""><a href="http://ecs.cryptoskillz.com/" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">http://ecs.cryptoskillz.com/</a></p><p id="011d" class="lh li bf av lj b lk lz lm ma lo mb lq mc ls md lu" data-selectable-paragraph="">Once you have hosted your own server you have to update the server URL in the following files so that they are all pointing to the correct server. If you are running locally you may also have to update the local URL.</p><blockquote class="nr ns nt"><p id="8ff9" class="lh li bf nu lj b lk lz lm ma lo mb lq mc ls md lu" data-selectable-paragraph=""><strong class="lj me">Note* cryptoskillz from the future here. Laters code uses an SR.init to pass in all these parameters making it easier to configure. Also the URL's changed.</strong></p></blockquote><p id="9869" class="lh li bf av lj b lk lz lm ma lo mb lq mc ls md lu" data-selectable-paragraph=""><strong>admin <a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/blob/admin/admin/assets/js/main.js" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">main.js</a></strong></p><pre class="mf mg mh mi mj dv ge df"><span id="40b8" class="mk kv bf av ml b dz mm mn l mo" data-selectable-paragraph="">//server call to make the AJAX calls to//set url to productionvar serverurl = "<a href="http://ecs.cryptoskillz.com/" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">http://ecs.cryptoskillz.com/</a>";</span></pre><p id="ec97" class="lh li bf av lj b lk lz lm ma lo mb lq mc ls md lu" data-selectable-paragraph=""><strong><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/blob/admin/cdn/js/sr.js" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">cdn sr.js</a></strong></p><pre class="mf mg mh mi mj dv ge df"><span id="416d" class="mk kv bf av ml b dz mm mn l mo" data-selectable-paragraph="">jQuery(document).ready(function($){ //set url to production var serverurl = "<a href="http://ecs.cryptoskillz.com/" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">http://ecs.cryptoskillz.com/</a>";</span></pre><p id="fa80" class="lh li bf av lj b lk lz lm ma lo mb lq mc ls md lu" data-selectable-paragraph=""><strong><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/blob/admin/www/js/main.js" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">www main.js</a></strong></p><pre class="mf mg mh mi mj dv ge df"><span id="4076" class="mk kv bf av ml b dz mm mn l mo" data-selectable-paragraph="">jQuery(document).ready(function($){  //set the server url. var serverurl = "<a href="http://ecs.cryptoskillz.com/" class="cb bx lv lw lx ly" target="_blank" rel="noopener noreferrer">http://ecs.cryptoskillz.com/</a>";</span></pre><h1 id="2a9f" class="ku kv bf av au el kw kx ky kz la lb lc ld le lf lg" data-selectable-paragraph="">Conclusion</h1><p id="3282" class="lh li bf av lj b lk ll lm ln lo lp lq lr ls lt lu" data-selectable-paragraph="">Now we have a simple admin we have done all of the WWW elements and can get back to the Bitcoin coding and we will be doing that in the next part. We aim to remove all the dependencies from the system and interact with our own full node.</p></div><footer class="wrapper post__footer"><p class="post__last-updated">This article was updated on September 9, 2019</p><ul class="post__tag"><li><a href="https://cryptoskillz.com/blog/ecs/">ecs</a></li></ul><div class="post__share"><a href="https://twitter.com/share?url=https%3A%2F%2Fcryptoskillz.com%2Fblog%2Fpart-6-create-an-admin-and-hosting.html&amp;via=crypto_skillz&amp;text=Part%206%3A%20Create%20an%20Admin%20and%20hosting" class="js-share twitter" rel="nofollow noopener noreferrer"><svg class="icon" aria-hidden="true" focusable="false"><use xlink:href="https://cryptoskillz.com/blog/assets/svg/svg-map.svg#twitter"/></svg> <span>Twitter</span></a></div></footer></article><nav class="post__nav"><div class="post__nav-inner"><div class="post__nav-prev"><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://cryptoskillz.com/blog/assets/svg/svg-map.svg#arrow-prev"/></svg> <a href="https://cryptoskillz.com/blog/part-5-www-and-modularisation.html" class="invert post__nav-link" rel="prev"><span>Previous</span> Part 5: WWW and modularisation</a></div><div class="post__nav-next"><a href="https://cryptoskillz.com/blog/part-7-recode-cdn-to-use-plain-js.html" class="invert post__nav-link" rel="next"><span>Next</span> Part 7: Recode CDN to use plain js </a><svg width="1.041em" height="0.416em" aria-hidden="true"><use xlink:href="https://cryptoskillz.com/blog/assets/svg/svg-map.svg#arrow-next"/></svg></div></div></nav><div class="post__related related"><div class="wrapper"><h2 class="h5 related__title">You should also read:</h2><article class="related__item"><div class="feed__meta"><time datetime="2019-09-08T04:58" class="feed__date">September 8, 2019</time></div><h3 class="h1"><a href="https://cryptoskillz.com/blog/part-5-www-and-modularisation.html" class="invert">Part 5: WWW and modularisation</a></h3></article><article class="related__item"><div class="feed__meta"><time datetime="2019-09-08T04:57" class="feed__date">September 8, 2019</time></div><h3 class="h1"><a href="https://cryptoskillz.com/blog/part-4-move-payment-to-cold-storage.html" class="invert">Part 4: Move payment to cold storage</a></h3></article><article class="related__item"><div class="feed__meta"><time datetime="2019-09-08T00:12" class="feed__date">September 8, 2019</time></div><h3 class="h1"><a href="https://cryptoskillz.com/blog/part-3-monitor-blockchain-for-payment.html" class="invert">Part 3: Monitor blockchain for payment</a></h3></article></div></div><div class="post__comments"><div class="wrapper"><h2 class="h5">Comments</h2><div id="disqus_thread"></div><script>var disqus_config = function () {
                       this.page.url = 'https://cryptoskillz.com/blog/part-6-create-an-admin-and-hosting.html';
               		this.page.identifier = '8';
                       this.page.title = ' Part 6: Create an Admin and hosting';
                   };
               
                   var disqus_loaded = false;
               
                   function publiiLoadDisqus() {
                       if(disqus_loaded) {
                           return false;
                       }
               
                       var top = document.getElementById('disqus_thread').offsetTop;
               
                       if (!disqus_loaded && (window.scrollY || window.pageYOffset) + window.innerHeight > top) {
                           disqus_loaded = true;
               
                           (function () {
                               var d = document, s = d.createElement('script');
                               s.src = 'https://cryptoskillz-1.disqus.com/embed.js';
                               s.setAttribute('data-timestamp', +new Date());
                               (d.head || d.body).appendChild(s);
                           })();
                       }
                   }
               
                   publiiLoadDisqus();
               
                   window.onscroll = function() {
                       publiiLoadDisqus();
                   };</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></div></div></main><footer class="footer"><div class="footer__social"><a href="crypto_skillz" aria-label="Twitter"><svg><use xlink:href="https://cryptoskillz.com/blog/assets/svg/svg-map.svg#twitter"/></svg></a></div><div class="footer__copyright">Powered by <a href="https://getpublii.com" target="_blank" rel="nofollow noopener noreferrer">Publii Static CMS</a></div><button class="footer__bttop js-footer__bttop" aria-label="Back to top"><svg><title>Back to top</title><use xlink:href="https://cryptoskillz.com/blog/assets/svg/svg-map.svg#toparrow"/></svg></button></footer></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'sidebar',
        animationSpeed: 300,
        submenuWidth: 'auto',
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.top',
   };</script><script defer="defer" src="https://cryptoskillz.com/blog/assets/js/scripts.min.js?v=f56b13ba141d95ea2a0b7aab75ca9528"></script><script>var lazyFeaturedImage=function lazyFeaturedImage(){var b=document.querySelectorAll(".hero__image-img");for(var a=0;a<b.length;a++){var c=b[a];c.addEventListener("lazyloaded",function(f){var d=f.target.parentNode;d.classList.add("hero__image--overlay")})}};lazyFeaturedImage();</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-111636971-1"></script><script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-111636971-1');</script></body></html>