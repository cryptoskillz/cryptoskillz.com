<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Working with Fullnodes part 1 - cryptoskillz</title><meta name="description" content="ECS (e-commerce software) is an open source Bitcoin e-commerce server. It comes with a Javascript e-commerce injector a REST server and an admin control panel. "><meta name="robots" content="index, follow"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://cryptoskillz.com/blog/working-with-fullnodes-part-1.html"><link rel="amphtml" href="https://cryptoskillz.com/blog/amp/working-with-fullnodes-part-1.html"><link rel="alternate" type="application/atom+xml" href="https://cryptoskillz.com/blog/feed.xml"><link rel="alternate" type="application/json" href="https://cryptoskillz.com/blog/feed.json"><meta property="og:title" content="Working with Fullnodes part 1"><meta property="og:image" content="https://cryptoskillz.com/blog/media/posts/10/1_rMm82XhYrGNRVwNsWs2uIw.jpeg"><meta property="og:site_name" content="cryptoskillz"><meta property="og:description" content="ECS (e-commerce software) is an open source Bitcoin e-commerce server. It comes with a Javascript e-commerce injector a REST server and an admin control panel. "><meta property="og:url" content="https://cryptoskillz.com/blog/working-with-fullnodes-part-1.html"><meta property="og:type" content="article"><link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link href="https://fonts.googleapis.com/css?family=Roboto:400,500&amp;subset=latin-ext&amp;display=swap" rel="stylesheet"><link rel="stylesheet" href="https://cryptoskillz.com/blog/assets/css/style.css?v=1083d802e3f46e75f95035fd641fe7af"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://cryptoskillz.com/blog/working-with-fullnodes-part-1.html"},"headline":"Working with Fullnodes part 1","datePublished":"2018-10-16T11:58","dateModified":"2019-10-10T23:39","image":{"@type":"ImageObject","url":"https://cryptoskillz.com/blog/media/posts/10/1_rMm82XhYrGNRVwNsWs2uIw.jpeg","height":391,"width":639},"description":" This guide aims to program a website to accept Bitcoin. In the last section, we refactored a bunch of code and this time we are going to look at full nodes. There is not much code change in this part, instead, we are going&hellip;","author":{"@type":"Person","name":"cryptoskillz"},"publisher":{"@type":"Organization","name":"cryptoskillz"}}</script><script async src="https://cryptoskillz.com/blog/assets/js/lazysizes.min.js?v=300b16f1c14e1537e6b064f464ab33b1"></script></head><body><header class="topbar js-top is-sticky"><div class="topbar__inner"><a class="logo" href="https://cryptoskillz.com/blog/">cryptoskillz</a><nav class="navbar js-navbar"><button class="navbar__toggle js-navbar__toggle">Menu</button><ul class="navbar__menu"><li><a href="https://cryptoskillz.com/index.html" target="_self">ECS</a></li><li><a href="https://cryptoskillz.com/blox.html" target="_self">BLOX</a></li><li><a href="https://cryptoskillz.com/about.html" target="_self">ABOUT</a></li></ul></nav></div></header><div class="content"><div class="infobar"><div class="infobar__update">Last Updated: <time datetime="2019-10-11T12:31">October 11, 2019</time></div><div class="infobar__search"><form action="https://cryptoskillz.com/blog/search.html"><input type="search" name="q" placeholder=" search..."></form></div></div><main class="main"><article class="post"><figure class="post__featured-image" style="padding-bottom: calc(391/639 * 100%)"><img class="lazyload" src="https://cryptoskillz.com/blog/media/posts/10/responsive/1_rMm82XhYrGNRVwNsWs2uIw-xs.jpeg" data-srcset="https://cryptoskillz.com/blog/media/posts/10/responsive/1_rMm82XhYrGNRVwNsWs2uIw-xs.jpeg 300w ,https://cryptoskillz.com/blog/media/posts/10/responsive/1_rMm82XhYrGNRVwNsWs2uIw-sm.jpeg 480w ,https://cryptoskillz.com/blog/media/posts/10/responsive/1_rMm82XhYrGNRVwNsWs2uIw-md.jpeg 768w ,https://cryptoskillz.com/blog/media/posts/10/responsive/1_rMm82XhYrGNRVwNsWs2uIw-lg.jpeg 1024w ,https://cryptoskillz.com/blog/media/posts/10/responsive/1_rMm82XhYrGNRVwNsWs2uIw-xl.jpeg 1360w ,https://cryptoskillz.com/blog/media/posts/10/responsive/1_rMm82XhYrGNRVwNsWs2uIw-2xl.jpeg 1600w" data-sizes="auto" alt=""></figure><header class="u-header post__header"><h1>Working with Fullnodes part 1</h1><div class="u-header__meta u-small"><div><a href="https://cryptoskillz.com/blog/authors/cryptoskillz/" title="cryptoskillz">cryptoskillz</a> <time datetime="2018-10-16T11:58">October 16, 2018 </time><a href="https://cryptoskillz.com/blog/ecs/" class="u-tag u-tag--1">ecs</a></div></div></header><div class="post__entry u-inner"><p> </p><h1 id="f6a6" class="kz la bf av au el lb lc ld le lf lg lh li lj lk ll" data-selectable-paragraph="">Introduction</h1><p id="c7e7" class="lm ln bf av lo b lp lq lr ls lt lu lv lw lx ly lz" data-selectable-paragraph="">This guide aims to program a website to accept Bitcoin. In the last section, we refactored a bunch of code and this time we are going to look at full nodes. There is not much code change in this part, instead, we are going to discuss the theory of how to use a full node. The reason being when we first jumped into full nodes (about a month ago) as a simple replacement for "<strong><a href="https://block.io/" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">block.io’s</a>"</strong> estimatefee function and found Full nodes are hella cool and can do a whole more than what our original plan was. Never be scared to change your mind kids, it’s a core tenet of programming.</p><h1 id="4db9" class="kz la bf av au el lb lc ld le lf lg lh li lj lk ll" data-selectable-paragraph="">What is a fullnode?</h1><p id="7602" class="lm ln bf av lo b lp lq lr ls lt lu lv lw lx ly lz" data-selectable-paragraph="">Lifted directly from "<strong><a href="https://bitcoin.org/en/full-node" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">bitcoin.org</a>"</strong>. A full node is a program that fully validates transactions and blocks. Almost all full nodes also help the network by accepting transactions and blocks from other full nodes, validating those transactions and blocks, and then relaying them to further full nodes.</p><p id="d196" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph="">Most full nodes also serve lightweight clients by allowing them to transmit their transactions to the network and by notifying them when a transaction affects their wallet. If not enough nodes perform this function, clients won’t be able to connect through the peer-to-peer network — they’ll have to use centralized services instead.</p><p id="1a2f" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph="">Many people and organizations volunteer to run full nodes using spare computing and bandwidth resources — but more volunteers are needed to allow Bitcoin to continue to grow.</p><h1 id="181c" class="kz la bf av au el lb lc ld le lf lg lh li lj lk ll" data-selectable-paragraph="">fullnode 101</h1><h2 id="cd3e" class="mj la bf av au el mk ml mm mn mo mp mq mr ms mt mu" data-selectable-paragraph="">Disclaimer</h2><p id="1ba9" class="lm ln bf av lo b lp lq lr ls lt lu lv lw lx ly lz" data-selectable-paragraph="">There a number of full nodes out there I am going to focus on "<strong><a href="https://bitcoin.org/en/bitcoin-core/" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">Bitcoin Core</a>"</strong>. Also, I use a Mac so all instructions will show how to interact with it on a mac. Please adjust the information accordingly.</p><h2 id="a2b3" class="mj la bf av au el mk ml mm mn mo mp mq mr ms mt mu" data-selectable-paragraph="">Good things to know</h2><p id="473e" class="lm ln bf av lo b lp lq lr ls lt lu lv lw lx ly lz" data-selectable-paragraph="">Most of the tutorials on setting up / running a full node are pretty old (read out of date) and as a result, you have to do a lot of wrong things to get one up and running and start interacting with it. I have listed factoids below that I found whilst doing my research.</p><p id="5a37" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph=""><strong class="lo mv">what is </strong><a href="https://en.bitcoin.it/wiki/Bitcoind" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer"><strong class="lo mv">Bitcoind</strong></a><strong class="lo mv">?<br></strong>Bitcoind is a headless daemon. It provides a JSON-RPC and a REST (in beta restricted to local access for now) interface, allowing it to be controlled locally or remotely which makes it useful for integration with other software or in larger payment systems. Various commands are made available by the API.</p><p id="4161" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph=""><strong class="lo mv">What is </strong><a href="https://en.bitcoin.it/wiki/Bitcoin_Core" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer"><strong class="lo mv">Bitcoin Core</strong></a><strong class="lo mv">?<br></strong>"<strong><a href="https://en.bitcoin.it/wiki/Bitcoin_Core" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">Bitcoin Core</a>"</strong> (formerly Bitcoin-Qt) is the third Bitcoin client by "<strong><a href="https://en.bitcoin.it/wiki/Wladimir_van_der_Laan" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">Wladimir van der Laan</a>"</strong> based on the original reference code by "<strong><a href="https://en.bitcoin.it/wiki/Satoshi_Nakamoto" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">Satoshi Nakamoto</a>"</strong>.</p><p id="def7" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph="">"<strong><a href="https://en.bitcoin.it/wiki/Bitcoin_Core" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">Bitcoin Core</a>"</strong> can be used as a desktop client for regular payments or as a server utility for merchants and other payment services.</p><p id="5660" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph="">Note, even though BitcoinQT was renamed to "<strong><a href="https://en.bitcoin.it/wiki/Bitcoin_Core" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">Bitcoin Core</a>"</strong> when you reference it from the terminal it is still called BitcoinQT, nice work devs.</p><p id="d22d" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph=""><a href="https://en.bitcoin.it/wiki/Bitcoind" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer"><strong class="lo mv">bitcoind</strong></a><strong class="lo mv"> is included in Bitcoin Core<br></strong>You will read lots of tutorials that tell you "<strong><a href="https://en.bitcoin.it/wiki/Bitcoind" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">bitcoind</a>"</strong> is not in BitcoinQT or it is not the mac version and you will have to download it separately. Although you can download bitcoind separately (recommended for servers) for testing you can use "<strong><a href="https://en.bitcoin.it/wiki/Bitcoin_Core" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">Bitcoin Core</a>"</strong>.</p><p id="a2b1" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph=""><a href="https://en.bitcoin.it/wiki/Bitcoin_Core" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer"><strong class="lo mv">Bitcoin core</strong></a><strong class="lo mv"> comes with an excellent javascript library<br></strong>As part of the rebranding to "<strong><a href="https://en.bitcoin.it/wiki/Bitcoin_Core" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">Bitcoin Core</a>"</strong>, I assume the package called bitcoin was retired and replaced with the "<strong><a href="https://www.npmjs.com/package/bitcoin-core" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">Bitcoin Core package</a>"</strong> so if you come across any tutorials referencing the NPM Bitcoin package you can replace it with the Bitcoin Core package (with the appropriate code changes)</p><h2 id="ae32" class="mj la bf av au el mk ml mm mn mo mp mq mr ms mt mu" data-selectable-paragraph="">What are the accounts?</h2><p id="f7c1" class="lm ln bf av lo b lp lq lr ls lt lu lv lw lx ly lz" data-selectable-paragraph="">Think of them as a way to track transactions for “users” just the way banks do. I have used these in this tutorial even though the whole account concept is being deprecated. However, the new functions are only in a "<a href="https://yangsu.github.io/pull-request-tutorial/" target="_blank" rel="noopener noreferrer">pull request</a><strong>"</strong> so I will continue to use them until the new functions are ready. You can find more about accounts "<strong><a href="https://en.bitcoin.it/wiki/Help:Accounts_explained" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">here</a>"</strong> and the proposed changes "<strong><a href="https://github.com/bitcoin/bitcoin/pull/7729/files?diff=unified#diff-df7d84ff2f53fcb2a0dc15a3a51e55ceR3216" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">here</a>"</strong>.</p><p id="9ed2" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph=""><strong class="lo mv">Default RPC ports<br></strong>Bitcoin RPC mainnet runs on port 8332 and testnet runs on 18332</p><h2 id="8f55" class="mj la bf av au el mk ml mm mn mo mp mq mr ms mt mu" data-selectable-paragraph="">CamelCase</h2><p id="7559" class="lm ln bf av lo b lp lq lr ls lt lu lv lw lx ly lz" data-selectable-paragraph="">You will see that all of the "<strong><a href="https://en.bitcoin.it/wiki/Original_Bitcoin_client/API_calls_list" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">RPC calls</a>"</strong> are in lower case but when we use them in the code "<strong><a href="https://en.wikipedia.org/wiki/Camel_case" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">camel case</a>"</strong> is excepted. This is more annoying in anything else they should agree on one methodology and use it holistically throughout all aspects of Bitcoin.<br>Note the docs also show them a third format (shown below) all the mean the same thing.</p><p id="6e80" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph="">estimatesmartfee<br>estimateSmartFee<br>EstimateSmartFee</p><h1 id="e903" class="kz la bf av au el lb lc ld le lf lg lh li lj lk ll" data-selectable-paragraph="">Setting up a fullnode</h1><p id="02e8" class="lm ln bf av lo b lp lq lr ls lt lu lv lw lx ly lz" data-selectable-paragraph="">great, now we got the above out the way lets go ahead and set up the "<strong><a href="https://bitcoin.org/en/bitcoin-core/" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">Bitcoin Core full node</a>"</strong>, shall we.</p><h2 id="5602" class="mj la bf av au el mk ml mm mn mo mp mq mr ms mt mu" data-selectable-paragraph="">Download Bitcoin Core</h2><p id="56ae" class="lm ln bf av lo b lp lq lr ls lt lu lv lw lx ly lz" data-selectable-paragraph="">You should have already had Bitcoin Core if you have followed any of the tutorials if not you can get it "<strong><a href="https://bitcoin.org/en/bitcoin-core/" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">here</a>"</strong>.</p><p id="e976" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph="">Once you have downloaded it open a terminal type the following command.</p><pre class="kg kh ki kj kk dv gg df"><span id="bd1d" class="mj la bf av mw b dz mx my l mz" data-selectable-paragraph="">cd /Applications/Bitcoin-Qt.app/Contents/MacOS/</span></pre><p id="6225" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph="">Once you in this directory run the command below. This command will launch the Bitcoin Core client in server mode. Let’s take a look at what the arguments are doing.</p><p id="070b" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph=""><strong class="lo mv">server</strong>: Start in server mode<br><strong class="lo mv">rpcuser</strong>: The username for the RPC server<br><strong class="lo mv">rpcpassword</strong>: The password for the RPC server<br><strong class="lo mv">rest</strong>: The rest server<br><strong class="lo mv">testnet</strong>: Launch in the test network</p><pre class="kg kh ki kj kk dv gg df"><span id="81bc" class="mj la bf av mw b dz mx my l mz" data-selectable-paragraph="">./Bitcoin-Qt -server -rpcuser=test  -rpcpassword=test -rest -testnet</span></pre><p id="14ba" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph="">Once you have run that command you will see Bitcoin Core boot up as shown below.</p><figure class="post__image"><img class="lazyload" src="https://cryptoskillz.com/blog/media/posts/10/responsive/1_MguOpMbOHjnTklkrbKhgmg-xs.png" data-sizes="auto" data-srcset="https://cryptoskillz.com/blog/media/posts/10/responsive/1_MguOpMbOHjnTklkrbKhgmg-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/10/responsive/1_MguOpMbOHjnTklkrbKhgmg-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/10/responsive/1_MguOpMbOHjnTklkrbKhgmg-md.png 768w ,https://cryptoskillz.com/blog/media/posts/10/responsive/1_MguOpMbOHjnTklkrbKhgmg-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/10/responsive/1_MguOpMbOHjnTklkrbKhgmg-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/10/responsive/1_MguOpMbOHjnTklkrbKhgmg-2xl.png 1600w" alt="" width="3335" height="1290"></figure><h2 id="8a4c" class="mj la bf av au el mk ml mm mn mo mp mq mr ms mt mu" data-selectable-paragraph="">Connect to rest</h2><p id="c8da" class="lm ln bf av lo b lp lq lr ls lt lu lv lw lx ly lz" data-selectable-paragraph="">Now we can connect via REST by opening a browser and going to this <a href="http://127.0.0.1:18332/rest/chaininfo.json" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">URL</a>and you will see a JSON output (as shown below). Of course, this is a simple GET request with POST etc it is slightly trickier.</p><figure class="post__image"><img class="lazyload" src="https://cryptoskillz.com/blog/media/posts/10/responsive/1_rXzf1_ECGd_UtcCMlznYMg-xs.png" data-sizes="auto" data-srcset="https://cryptoskillz.com/blog/media/posts/10/responsive/1_rXzf1_ECGd_UtcCMlznYMg-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/10/responsive/1_rXzf1_ECGd_UtcCMlznYMg-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/10/responsive/1_rXzf1_ECGd_UtcCMlznYMg-md.png 768w ,https://cryptoskillz.com/blog/media/posts/10/responsive/1_rXzf1_ECGd_UtcCMlznYMg-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/10/responsive/1_rXzf1_ECGd_UtcCMlznYMg-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/10/responsive/1_rXzf1_ECGd_UtcCMlznYMg-2xl.png 1600w" alt="" width="3159" height="365"></figure><p id="9bb8" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph="">You can find a full list of REST commands "<strong><a href="https://bitcoin.org/en/developer-reference#http-rest" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">here</a>"</strong> you can either interact with this with a Chrome extension called "<strong><a href="https://chrome.google.com/webstore/detail/postman/fhbjgbiflinjbdggehcddcbncdddomop?hl=en" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">POSTMAN</a>"</strong> or by opening a new terminal window and running a CURL request as shown below.</p><pre class="kg kh ki kj kk dv gg df"><span id="247f" class="mj la bf av mw b dz mx my l mz" data-selectable-paragraph="">curl <a href="http://127.0.0.1:18332/rest/chaininfo.json" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">http://127.0.0.1:18332/rest/chaininfo.json</a></span></pre><p id="4375" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph="">Some useful CURL examples can be found "<strong><a href="https://www.rosehosting.com/blog/curl-command-examples/" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">here</a>"</strong>.</p><h2 id="52c6" class="mj la bf av au el mk ml mm mn mo mp mq mr ms mt mu" data-selectable-paragraph="">Connect to RPC</h2><p id="6d07" class="lm ln bf av lo b lp lq lr ls lt lu lv lw lx ly lz" data-selectable-paragraph="">Connecting to RPC using is similar to the REST and is shown below. This is the main we are going to interact with the fullnode as good as REST is it is not nearly as feature rich as the RPC API.</p><p id="40ff" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph=""><strong class="lo mv"><em class="ne">*note: cryptoskillz from the future here the “getinfo” function has been removed from the most recent version of RPC so this command will now produce an error.</em></strong></p><pre class="kg kh ki kj kk dv gg df"><span id="a44b" class="mj la bf av mw b dz mx my l mz" data-selectable-paragraph="">curl --user test  --data-binary '{"jsonrpc": "1.0", "id":"curltest", "method": "getinfo", "params": [] }'     -H 'content-type: text/plain;' <a href="http://127.0.0.1:18332/" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">http://127.0.0.1:18332/</a></span></pre><p id="a887" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph="">You will be asked to enter the password which you set above (rpcpassword) enter this and you will get a result something like the one below.</p><pre class="kg kh ki kj kk dv gg df"><span id="c103" class="mj la bf av mw b dz mx my l mz" data-selectable-paragraph="">{<br>  "result": {<br>    "chain": "test",<br>    "blocks": 1438199,<br>    "headers": 1438199,<br>    "bestblockhash": "00000000000003e2ecbb6d376016a84aa5ab89d299e455c5823d8a90d300d6f5",<br>    "difficulty": 4166899.806567,<br>    "mediantime": 1539596338,<br>    "verificationprogress": 0.99999561714928,<br>    "initialblockdownload": false,<br>    "chainwork": "0000000000000000000000000000000000000000000000c8507d634426736c14",<br>    "size_on_disk": 22923325413,<br>    "pruned": false,<br>    "softforks": [<br>      {<br>        "id": "bip34",<br>        "version": 2,<br>        "reject": {<br>          "status": true<br>        }<br>      },<br>      {<br>        "id": "bip66",<br>        "version": 3,<br>        "reject": {<br>          "status": true<br>        }<br>      },<br>      {<br>        "id": "bip65",<br>        "version": 4,<br>        "reject": {<br>          "status": true<br>        }<br>      }<br>    ],<br>    "bip9_softforks": {<br>      "csv": {<br>        "status": "active",<br>        "startTime": 1456790400,<br>        "timeout": 1493596800,<br>        "since": 770112<br>      },<br>      "segwit": {<br>        "status": "active",<br>        "startTime": 1462060800,<br>        "timeout": 1493596800,<br>        "since": 834624<br>      }<br>    },<br>    "warnings": "Warning: unknown new rules activated (versionbit 28)"<br>  },<br>  "error": null,<br>  "id": "curltest"<br>}</span></pre><p id="78f1" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph="">You can find a full list or RPC commands <a href="https://bitcoin.org/en/developer-reference#addmultisigaddress" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">here</a>.</p><p data-selectable-paragraph=""> </p><h1 id="d065" class="kz la bf av au el lb lc ld le lf lg lh li lj lk ll" data-selectable-paragraph="">The Code</h1><p id="f646" class="lm ln bf av lo b lp lq lr ls lt lu lv lw lx ly lz" data-selectable-paragraph="">As I said earlier we are not really going to modify any of the server code as we this is a deep dive of how full nodes work. The branch that has this code is "<strong><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/tree/8-fullnode" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">here</a>"</strong> and the file called "<strong><a href="https://github.com/cryptoskillz/Bitcoin-Tutorial/blob/8-fullnode/server/rpc.js" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">rpc.js</a>" </strong>so let’s take a look at what is happening.</p><p id="ea3a" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph="">As you can see I am using the "<strong><a href="https://www.npmjs.com/package/bitcoin-core" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">Bitcoin core"</a> </strong>package but we could just as easily use a CURL class or even filgetcontents if we want to get really basic (we do not).</p><p id="1c9a" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph="">The reason I have used the bitcoin core package as it is coded by the same community who code Bitcoin Core wallet and bitcoind. When I started playing with it quickly became clear that it could do everything that "<strong><a href="https://github.com/bitcoinjs/bitcoinjs-lib" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">Bitcoinjs</a>"</strong> (the current package I am using) which to me is very interesting. As I was using Bitcoinjs it frustrated me that it would sign and create transactions but did not have native support for RPC commands. I get they want abstraction from node/wallets but it just feels like a compromise to the library purely for comprise sake.</p><p id="6364" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph="">Also on top of that, we do not have to store the private keys anywhere as we have RPC access to the node that created the address we can simply use the dump private key function for singing etc. This makes perfect sense and as Bitcoin is one of the most secure pieces of software the world has ever seen why to try to replicate this security off chain?</p><p id="9f36" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph="">Note, cryptoskillz adding this from the future. It became very clear that "<strong><a href="https://github.com/bitcoinjs/bitcoinjs-lib" class="cb bx ma mb mc md" target="_blank" rel="noopener noreferrer">BitcoinJs</a>"</strong> is required when we researched "<strong><a class="cb bx ma mb mc md" target="_blank" href="https://medium.com/bitcoin-e-commerce-development/part-10-address-101-51868eb6bc9b" rel="noopener noreferrer">addresses in part 10</a>"</strong>. It will be back in part 11 to generate the address to improve cold storage functionality.</p><h2 id="7bfe" class="mj la bf av au el mk ml mm mn mo mp mq mr ms mt mu" data-selectable-paragraph="">On to the code.</h2><p id="eb84" class="lm ln bf av lo b lp lq lr ls lt lu lv lw lx ly lz" data-selectable-paragraph="">You will see from the code below we are doing a really simple thing. unlocking the wallet, generating an address and getting the private key. The address I have used in one in the Bitcoin Core that I send funds to in an earlier tutorial.</p><figure class="post__image"><img class="lazyload" src="https://cryptoskillz.com/blog/media/posts/10/responsive/1_uzyguXzlF92DlEsMu1YuHQ-xs.png" data-sizes="auto" data-srcset="https://cryptoskillz.com/blog/media/posts/10/responsive/1_uzyguXzlF92DlEsMu1YuHQ-xs.png 300w ,https://cryptoskillz.com/blog/media/posts/10/responsive/1_uzyguXzlF92DlEsMu1YuHQ-sm.png 480w ,https://cryptoskillz.com/blog/media/posts/10/responsive/1_uzyguXzlF92DlEsMu1YuHQ-md.png 768w ,https://cryptoskillz.com/blog/media/posts/10/responsive/1_uzyguXzlF92DlEsMu1YuHQ-lg.png 1024w ,https://cryptoskillz.com/blog/media/posts/10/responsive/1_uzyguXzlF92DlEsMu1YuHQ-xl.png 1360w ,https://cryptoskillz.com/blog/media/posts/10/responsive/1_uzyguXzlF92DlEsMu1YuHQ-2xl.png 1600w" alt="" width="2154" height="1255"></figure><pre class="kg kh ki kj kk dv gg df"><span id="231c" class="mj la bf av mw b dz mx my l mz" data-selectable-paragraph="">//load bitcoin core<br>const Client = require("bitcoin-core");<br>//open a connection to the RPC client<br>const client = new Client({<br>  host: "127.0.0.1",<br>  port: 18332,<br>  username: "test",<br>  password: "test"<br>});<br>/*<br>//run this once to encrypt your wallet id you have not already done so.<br>client.encryptWallet('test').then((res) =&gt; {<br>  console.log(res)<br>});<br>*/<br>//unlock the waller for 10 seconds<br>client.walletPassphrase("test", 10).then(() =&gt; {<br>  //create a new address in theaccount account :]<br>  client.getNewAddress("theaccount").then(address =&gt; {<br>    //debug<br>    console.log(address);<br>    //get the private key<br>    client.dumpPrivKey(address).then(privkey =&gt; {<br>      //debug<br>      console.log("privkey:" + privkey);</span><span id="fb49" class="mj la bf av mw b dz nl nm nn no np my l mz" data-selectable-paragraph="">//now have the prviate key we can sign transactions etc, basically do whatever we did with BitcooinJS<br>      //do stuff</span><span id="c947" class="mj la bf av mw b dz nl nm nn no np my l mz" data-selectable-paragraph="">//lock the wallet<br>      client.walletLock();<br>    });<br>  });<br>});</span></pre><p id="4af1" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph="">You can run the code above by going to the server directory in a terminal window and typing the following command (as usual)</p><pre class="kg kh ki kj kk dv gg df"><span id="651c" class="mj la bf av mw b dz mx my l mz" data-selectable-paragraph="">node rpc.js</span></pre><h2 id="b7d7" class="mj la bf av au el mk ml mm mn mo mp mq mr ms mt mu" data-selectable-paragraph="">Conclusion</h2><p id="714c" class="lm ln bf av lo b lp lq lr ls lt lu lv lw lx ly lz" data-selectable-paragraph="">As you can see we can use the Bitcoin Core (with bitcoind) and the NPM package we have 100% sovereignty over our code and by extension our Bitcoin. See this as a segway to the main tutorial parts and as such, I can see myself coming back and updating this part a lot in the coming weeks and months (cryptoskillz adding this from the future “told ya”)</p><p id="d22b" class="lm ln bf av lo b lp me lr mf lt mg lv mh lx mi lz" data-selectable-paragraph="">In the next tutorial, we will either replace all the BitcoinJs code and/or replace the block.io 3rd party calls.</p></div><aside class="post__aside"><div class="post__last-updated u-small">This article was updated on October 10, 2019</div><div class="post__share"></div></aside><footer class="post__footer"><div class="post__bio u-author box"><div><h4 class="u-author__name"><a href="https://cryptoskillz.com/blog/authors/cryptoskillz/" title="cryptoskillz">cryptoskillz</a></h4></div></div><nav class="post__nav box"><div class="post__nav__prev"><a href="https://cryptoskillz.com/blog/recode-cdn-to-use-plain-js.html" class="post__nav__link" rel="prev"><img class="lazyload" src="https://cryptoskillz.com/blog/media/posts/9/responsive/1_SbYlu5R2xvkYwvQ5m6iDaw-xs.jpeg" data-srcset="https://cryptoskillz.com/blog/media/posts/9/responsive/1_SbYlu5R2xvkYwvQ5m6iDaw-xs.jpeg" data-expand="300" alt=""><div class="u-small">Previous Post<h5>Recode CDN to use plain js</h5></div></a></div><div class="post__nav__next"><a href="https://cryptoskillz.com/blog/working-with-fullnodes-part-2.html" class="post__nav__link" rel="next"><div class="u-small">Next Post<h5>Working with Fullnodes part 2</h5></div><img class="lazyload" src="https://cryptoskillz.com/blog/media/posts/11/responsive/1_63p4B8NFmprNKx3-VZHkeA-xs.jpeg" data-srcset="https://cryptoskillz.com/blog/media/posts/11/responsive/1_63p4B8NFmprNKx3-VZHkeA-xs.jpeg" data-expand="300" alt=""></a></div></nav><div class="post__related box"><h3 class="box__title">Related posts</h3><div class="post__related__wrap"><figure><a href="https://cryptoskillz.com/blog/integrating-3rd-party-lightning.html"><img class="lazyload" src="https://cryptoskillz.com/blog/media/posts/18/responsive/1_a22cZdqrqt3k_KXL4CcfDg-xs-xs.jpeg" data-srcset="https://cryptoskillz.com/blog/media/posts/18/responsive/1_a22cZdqrqt3k_KXL4CcfDg-xs-xs.jpeg" data-expand="300" alt=""></a><figcaption><h4><a href="https://cryptoskillz.com/blog/integrating-3rd-party-lightning.html" class="inverse">Integrating 3rd party Lightning</a></h4><time datetime="2019-01-23T12:29" class="u-small">January 23, 2019</time></figcaption></figure><figure><a href="https://cryptoskillz.com/blog/adding-3rd-party-lightning.html"><img class="lazyload" src="https://cryptoskillz.com/blog/media/posts/17/responsive/1_o-phpGJ9Fmh13YqxCs8y3A-xs-xs.jpeg" data-srcset="https://cryptoskillz.com/blog/media/posts/17/responsive/1_o-phpGJ9Fmh13YqxCs8y3A-xs-xs.jpeg" data-expand="300" alt=""></a><figcaption><h4><a href="https://cryptoskillz.com/blog/adding-3rd-party-lightning.html" class="inverse">Adding 3rd party Lightning</a></h4><time datetime="2018-12-27T12:27" class="u-small">December 27, 2018</time></figcaption></figure><figure><a href="https://cryptoskillz.com/blog/working-with-fullnodes-part-3.html"><img class="lazyload" src="https://cryptoskillz.com/blog/media/posts/15/responsive/1_nY1L26Pnm4pyiBRaVkcy3A-xs.jpeg" data-srcset="https://cryptoskillz.com/blog/media/posts/15/responsive/1_nY1L26Pnm4pyiBRaVkcy3A-xs.jpeg" data-expand="300" alt=""></a><figcaption><h4><a href="https://cryptoskillz.com/blog/working-with-fullnodes-part-3.html" class="inverse">Working with Fullnodes part 3</a></h4><time datetime="2018-11-30T12:24" class="u-small">November 30, 2018</time></figcaption></figure></div></div></footer></article></main><div class="sidebar"><section class="box"><h3 class="box__title">Tags</h3><ul class="tags"><li><a href="https://cryptoskillz.com/blog/cyphernode/">cyphernode</a> <span class="u-small">(3)</span></li><li><a href="https://cryptoskillz.com/blog/ecs/">ecs</a> <span class="u-small">(24)</span></li><li><a href="https://cryptoskillz.com/blog/fullnode/">fullnode</a> <span class="u-small">(8)</span></li><li><a href="https://cryptoskillz.com/blog/trx/">trx</a> <span class="u-small">(2)</span></li><li><a href="https://cryptoskillz.com/blog/wink/">wink</a> <span class="u-small">(2)</span></li></ul></section></div><footer class="footer"><a class="footer__logo" href="https://cryptoskillz.com/blog/">cryptoskillz</a><nav><ul class="footer__nav"></ul></nav><div class="footer__copyright">Powered by Publii</div></footer></div><script defer="defer" src="https://cryptoskillz.com/blog/assets/js/jquery-3.2.1.slim.min.js?v=5f48fc77cac90c4778fa24ec9c57f37d"></script><script defer="defer" src="https://cryptoskillz.com/blog/assets/js/scripts.min.js?v=07b53ae91f8045eab042a695e4a26034"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-111636971-1"></script><script>window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-111636971-1');</script></body></html>